<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paweł Wiczling, Agnieszka Kamedulska">
<meta name="dcterms.date" content="2023-08-24">

<title>Comparison of chromatographic stationary phases using Bayesian-based multilevel modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#experimental-design" id="toc-experimental-design" class="nav-link" data-scroll-target="#experimental-design">Experimental design</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">Data</a>
  <ul class="collapse">
  <li><a href="#prepare-the-data" id="toc-prepare-the-data" class="nav-link" data-scroll-target="#prepare-the-data">Prepare the data</a></li>
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis">Exploratory data analysis</a>
  <ul class="collapse">
  <li><a href="#plots" id="toc-plots" class="nav-link" data-scroll-target="#plots">Plots</a></li>
  <li><a href="#summary-of-the-data" id="toc-summary-of-the-data" class="nav-link" data-scroll-target="#summary-of-the-data">Summary of the data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a>
  <ul class="collapse">
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#stan" id="toc-stan" class="nav-link" data-scroll-target="#stan">Stan</a>
  <ul class="collapse">
  <li><a href="#initialize-variables-and-parameters" id="toc-initialize-variables-and-parameters" class="nav-link" data-scroll-target="#initialize-variables-and-parameters">Initialize variables and parameters</a></li>
  <li><a href="#the-stan-model" id="toc-the-stan-model" class="nav-link" data-scroll-target="#the-stan-model">The Stan model:</a></li>
  <li><a href="#fitting-the-model" id="toc-fitting-the-model" class="nav-link" data-scroll-target="#fitting-the-model">Fitting the model</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul class="collapse">
  <li><a href="#summary-of-model-parameters-table" id="toc-summary-of-model-parameters-table" class="nav-link" data-scroll-target="#summary-of-model-parameters-table">Summary of model parameters (table):</a></li>
  <li><a href="#trace-plots" id="toc-trace-plots" class="nav-link" data-scroll-target="#trace-plots">Trace plots</a></li>
  <li><a href="#summary-of-model-parameters-figures" id="toc-summary-of-model-parameters-figures" class="nav-link" data-scroll-target="#summary-of-model-parameters-figures">Summary of model parameters (figures)</a></li>
  <li><a href="#isocratic-predictions" id="toc-isocratic-predictions" class="nav-link" data-scroll-target="#isocratic-predictions">Isocratic predictions</a></li>
  <li><a href="#individual-parameters" id="toc-individual-parameters" class="nav-link" data-scroll-target="#individual-parameters">Individual Parameters</a>
  <ul class="collapse">
  <li><a href="#neutral-form" id="toc-neutral-form" class="nav-link" data-scroll-target="#neutral-form">Neutral Form</a></li>
  <li><a href="#effects-of-dissociation" id="toc-effects-of-dissociation" class="nav-link" data-scroll-target="#effects-of-dissociation">Effects of dissociation</a></li>
  <li><a href="#pka-related-paraemters" id="toc-pka-related-paraemters" class="nav-link" data-scroll-target="#pka-related-paraemters">pKa-related paraemters</a></li>
  </ul></li>
  <li><a href="#eta-plots" id="toc-eta-plots" class="nav-link" data-scroll-target="#eta-plots">Eta plots</a>
  <ul class="collapse">
  <li><a href="#neutral-forms" id="toc-neutral-forms" class="nav-link" data-scroll-target="#neutral-forms">Neutral Forms</a></li>
  <li><a href="#effect-of-dissociation" id="toc-effect-of-dissociation" class="nav-link" data-scroll-target="#effect-of-dissociation">Effect of dissociation</a></li>
  <li><a href="#effect-of-functional-groups-exploratory" id="toc-effect-of-functional-groups-exploratory" class="nav-link" data-scroll-target="#effect-of-functional-groups-exploratory">Effect of functional groups (exploratory)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#comparison-of-observed-and-model-predicted-retention-times" id="toc-comparison-of-observed-and-model-predicted-retention-times" class="nav-link" data-scroll-target="#comparison-of-observed-and-model-predicted-retention-times">Comparison of observed and model predicted retention times</a>
  <ul class="collapse">
  <li><a href="#individual-predictions" id="toc-individual-predictions" class="nav-link" data-scroll-target="#individual-predictions">Individual predictions:</a></li>
  <li><a href="#population-predictions" id="toc-population-predictions" class="nav-link" data-scroll-target="#population-predictions">Population predictions:</a></li>
  </ul></li>
  <li><a href="#uncertainity-chromatogram" id="toc-uncertainity-chromatogram" class="nav-link" data-scroll-target="#uncertainity-chromatogram">Uncertainity chromatogram</a>
  <ul class="collapse">
  <li><a href="#isocratic-predictions-population-predictions" id="toc-isocratic-predictions-population-predictions" class="nav-link" data-scroll-target="#isocratic-predictions-population-predictions">Isocratic predictions (population predictions)</a></li>
  </ul></li>
  <li><a href="#effect-of-logp" id="toc-effect-of-logp" class="nav-link" data-scroll-target="#effect-of-logp">Effect of logP</a></li>
  <li><a href="#goodness-of-fit-plots" id="toc-goodness-of-fit-plots" class="nav-link" data-scroll-target="#goodness-of-fit-plots">Goodness of fit plots</a></li>
  <li><a href="#predictions-and-decision-making.-case-study-1" id="toc-predictions-and-decision-making.-case-study-1" class="nav-link" data-scroll-target="#predictions-and-decision-making.-case-study-1">Predictions and decision making. Case Study 1</a>
  <ul class="collapse">
  <li><a href="#utility-maps" id="toc-utility-maps" class="nav-link" data-scroll-target="#utility-maps">Utility maps</a>
  <ul class="collapse">
  <li><a href="#uncertainity-chromatogram-1" id="toc-uncertainity-chromatogram-1" class="nav-link" data-scroll-target="#uncertainity-chromatogram-1">Uncertainity chromatogram</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#predictions-and-decision-making.-case-2" id="toc-predictions-and-decision-making.-case-2" class="nav-link" data-scroll-target="#predictions-and-decision-making.-case-2">Predictions and decision making. Case 2</a>
  <ul class="collapse">
  <li><a href="#summary-of-individual-parameters" id="toc-summary-of-individual-parameters" class="nav-link" data-scroll-target="#summary-of-individual-parameters">Summary of individual parameters</a></li>
  <li><a href="#predicted-retention-times" id="toc-predicted-retention-times" class="nav-link" data-scroll-target="#predicted-retention-times">Predicted retention times</a>
  <ul class="collapse">
  <li><a href="#plot-the-predicted-vs.-observed" id="toc-plot-the-predicted-vs.-observed" class="nav-link" data-scroll-target="#plot-the-predicted-vs.-observed">Plot the predicted vs.&nbsp;observed:</a></li>
  </ul></li>
  <li><a href="#decision-making" id="toc-decision-making" class="nav-link" data-scroll-target="#decision-making">Decision making</a>
  <ul class="collapse">
  <li><a href="#uncertainity-chromatogram-2" id="toc-uncertainity-chromatogram-2" class="nav-link" data-scroll-target="#uncertainity-chromatogram-2">Uncertainity chromatogram</a></li>
  </ul></li>
  <li><a href="#utility-maps-1" id="toc-utility-maps-1" class="nav-link" data-scroll-target="#utility-maps-1">Utility maps</a>
  <ul class="collapse">
  <li><a href="#uncertainity-chromatogram-3" id="toc-uncertainity-chromatogram-3" class="nav-link" data-scroll-target="#uncertainity-chromatogram-3">Uncertainity chromatogram</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#licenses" id="toc-licenses" class="nav-link" data-scroll-target="#licenses">Licenses</a></li>
  <li><a href="#original-computing-environment" id="toc-original-computing-environment" class="nav-link" data-scroll-target="#original-computing-environment">Original Computing Environment</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Comparison of chromatographic stationary phases using Bayesian-based multilevel modeling</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Paweł Wiczling, Agnieszka Kamedulska </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 24, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>In this work we applied the previously developed Bayesian multilevel framework <span class="citation" data-cites="kamedulska_toward_2022">Kubik, Kaliszan, and Wiczling (<a href="#ref-kubik_analysis_2018" role="doc-biblioref">2018</a>)</span> to characterize chromatographic gradient retention time datasets collected using a multicomponent mixtures of analytes, five stationary phases, and a wide range of chromatographic conditions (pH, organic modifier, temperature, gradient program). Such datasets carry much information about chromatographic retention that, if extracted, can provide useful predictive information, i.e.&nbsp;a detailed multidimensional characterization of chromatographic stationary phases and ability to predict retention (along with uncertainty) based on various number of preliminary experiments (e.g.&nbsp;to predict retention time for a set of analytes given no, or several measurements collected using a different stationary phase).</p>
<p>In this case study, we compared five RP-HPLC stationary phases (XBridge Shield RP18, XTerra MS C18, XBridge Phenyl, XBridge C8, Xterra MS C8) based on LC-MS/TOF data.</p>
</section>
<section id="experimental-design" class="level1">
<h1>Experimental design</h1>
<p>The data was collected using a mixture of 300 analytes and 84 gradient liquid chromatography experiments for each column. The experiments differed in gradient duration (30, 90, and 270 min) and pH of the mobile phase (from 2.5 to 10.5). Experiments were conducted in MeOH or ACN as organic modifiers and at two temperatures (<span class="math inline">\(\small 25^0C\)</span> and <span class="math inline">\(\small 35^0C\)</span>).</p>
<p>The molecular structure of the analytes was converted from SMILE format to MDL mol format using OpenBabel. The input molecules were then analyzed for the presence of approximately 204 functional groups and structural elements using Checkmol (version 0.5b N. Haider, University of Vienna, 2003-2018). Functional groups that were not present on any analyte and functional groups merging other simpler functional groups were excluded from the analysis. The lipophilicity (log P), dissociation constant (pKalit) were added to the dataset. They were calculated using ACD/Labs program based on the structures of analytes generated from smiles strings.</p>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<p>The packages we will use are listed below.</p>
</section>
<section id="data" class="level1">
<h1>Data</h1>
<p>Data can be accessed via github (data folder) or osf.io repositories <span class="citation" data-cites="kubik_XBridgeC18_2022">Kubik et al. (<a href="#ref-kubik_XBridgeC8_2022" role="doc-biblioref">2022b</a>)</span>.</p>
<section id="prepare-the-data" class="level2">
<h2 class="anchored" data-anchor-id="prepare-the-data">Prepare the data</h2>
<p>We will begin with loading and merging all the required datasets:</p>
<p>The data requires some cleaning:</p>
<ol type="1">
<li>we remove measurements with low score, analytes with less than 42 measurements per column, analytes with less than 210 measurements out of total 420, and use only measurements with the highest score (if several are present)</li>
</ol>
<ol start="2" type="1">
<li>we remove some outlying measurements (mismatch between literature pKa and observed data)</li>
</ol>
<ol start="3" type="1">
<li>we also prepare available predictors: pKa, logP and functional_groups</li>
</ol>
<ol start="4" type="1">
<li>finally, we select analytes with &lt;=2 dissociation steps fot the analysis</li>
</ol>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory data analysis</h2>
<p>During the exploratory data analysis phase, we create a series of plots to better understand our data.</p>
<section id="plots" class="level3">
<h3 class="anchored" data-anchor-id="plots">Plots</h3>
<p>The following graphs present retention time profiles for 6 analytes:</p>
<ol type="1">
<li>acridine (monoprotic acid)</li>
<li>baclofen (zwitterion: acidic and basic group)</li>
<li>hydrocortison (neutral)</li>
<li>pioglitazone (zwitterion: basic and acidic group)</li>
<li>quinine (diprotic: 2 basic groups),</li>
<li>tolbutamide (monoprotic base).</li>
</ol>
<p>The vertical lines show ACD-based pKa values (solid line: acidic group; dotted line: basic group)</p>
<div class="cell" data-hash="index_cache/html/rawdata_8aacc8d6766ca14eae46240f78d27a5b">
<div class="cell-output-display">
<p><img src="index_files/figure-html/rawdata-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/rawdata-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/rawdata-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/rawdata-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/rawdata-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/rawdata-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="summary-of-the-data" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-the-data">Summary of the data</h3>
<ol type="1">
<li>Number of identified analytes: 141</li>
<li>Number of observations: 51530</li>
<li><span class="math inline">\(\small logP\)</span>: 2.5 <span class="math inline">\(\pm\)</span> 1.82</li>
<li>Number of analytes with 0, 1 and 2 dissociation steps: 14, 88, 39</li>
<li>Number of acidic and basic groups: 46 and 120</li>
<li>Number of functional groups across all analytes included in the analysis:</li>
</ol>
<div class="cell" data-hash="index_cache/html/functionalgroups_c23cf4d2f687868212e3840acd37ce09">
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroups-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="model" class="level2">
<h2 class="anchored" data-anchor-id="model">Model</h2>
<p>In this work <span class="math inline">\(\small z\)</span> = 1..51530 denotes observation, <span class="math inline">\(\small i\)</span>=1..141 denotes analyte, <span class="math inline">\(\small col\)</span>=1..5 denotes column, <span class="math inline">\(\small m\)</span>=1..2 denotes organic modifier and <span class="math inline">\(\small r\)</span>=1..<span class="math inline">\(\small R[i]\)</span> denotes dissociation step for <span class="math inline">\(\small i\)</span>-th analyte. The observed retention times (<span class="math inline">\(\small t_{Robs,z}\)</span>) were described using the following model:</p>
<p><span class="math display">\[
t_{Robs,z} \sim student_t(\nu, t_{R,z} ,\sigma_{col[z],i[z]})
\]</span></p>
<p>where z denotes z-th observation and student_t denotes the Student’s t-distribution with the mean given by the predicted retention time <span class="math inline">\(\small t_{R,z}\)</span>, scale <span class="math inline">\(\small \sigma_{i,col}\)</span> (analyte and column-specific), and normality parameter <span class="math inline">\(\small \nu\)</span> (set to 3).</p>
<p>Gradient retention time <span class="math inline">\(\small t_{R,z}\)</span> was calculated utilizing the well-known integral equation:</p>
<p><span class="math display">\[
\int_0^{t_{R,z}-t_{0,z}-t_e}\frac{dt}{t_{0,z}\cdot ki_z(t) }=1,
\]</span></p>
<p>where <span class="math inline">\(\small ki_z(t)\)</span> denotes instantaneous isocratic retention factor corresponding to the mobile phase composition at time t at column inlet for analyte and conditions corresponding to the z-th observation, <span class="math inline">\(\small t_{0,z}\)</span> denotes column hold-up (dead) time and <span class="math inline">\(\small t_e\)</span> denotes extra column-time. The numerical solution of this integral equation was carried out using method of steps with 4 and 10 steps for methanol and acetonitrile gradients using method proposed by Nikitas et al. <span class="citation" data-cites="nikitas_new_2002">(<a href="#ref-nikitas_new_2002" role="doc-biblioref">Nikitas and Pappa-Louisi 2002</a>)</span> The following function described the relationship between the isocratic retention factor and pH for an ith-analyte with <span class="math inline">\(\small R[i]\)</span> dissociation steps and <span class="math inline">\(\small R[i]+1\)</span> forms.</p>
<p><span class="math display">\[
ki_z(t)=\frac{k_{z,i[z],1}(t)+\sum_{r=1}^{R[i[z]]} k_{z,i[z],r+1}(t) \cdot 10^{r\cdot pH_z(t)-\sum_{r=1}^{R[i]} pKa_{z,i[z],r}(t)} }{1+\sum_{r=1}^R 10^{r\cdot pH_z(t)-\sum_{r=1}^{R[i[z]]} pKa_{z,i[z],r}(t) } }
\]</span></p>
<p><span class="math inline">\(\small log(k_{z,i,r})\)</span> was assumed to depend on the organic modifier content based on the Neue equation, on temperature assuming linear equation, and on the pH of the mobiles phase (for ionized forms of analytes).</p>
<p><span class="math display">\[
\begin{aligned}
&amp; log(k_{z,i,r}(t)) = logkw_{col[z],i,r} - \frac{S1_{m[z],col[z],i,r} \cdot (1+S2_{m[z]}) \cdot \varphi_z(t)}{1+S2_{m[z]} \cdot \varphi_z(t)} + ... \\
&amp; apH_{col[z],m[z],i,r} \cdot (pH_z(t)-7) + dlogkT_{col[z],i} \cdot (T_z-25)/10
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\small logkw_{col,i,r}\)</span> represents logarithm of retention factors extrapolated to 0% of organic modifier content for column <span class="math inline">\(\small col\)</span>, <span class="math inline">\(\small i\)</span>-th analyte and <span class="math inline">\(\small r\)</span>-th analyte form; <span class="math inline">\(\small S1_{i,m,col,r}\)</span> and <span class="math inline">\(\small S2_m\)</span> are the slopes in the Neue equation for column <span class="math inline">\(\small c\)</span>, modifier <span class="math inline">\(\small m\)</span>, <span class="math inline">\(\small i\)</span>-th analyte and <span class="math inline">\(\small r\)</span>-th analyte form. In this parametrization of the Neue equation, <span class="math inline">\(\small S1\)</span> reflects the difference between logarithm of retention factors corresponding to water (0% of organic modifier content) and MeOH or ACN (100% of organic modifier content) as eluents. <span class="math inline">\(\small dlogkT_{col,i}\)</span> denotes the change in <span class="math inline">\(\small logkw\)</span> due to the increase in temperature by <span class="math inline">\(\small 10^oC\)</span>. <span class="math inline">\(\small apH_{col,m,i,r}\)</span> denotes the pH effects on <span class="math inline">\(\small logkw\)</span>;</p>
<p>Further a linear relationship between <span class="math inline">\(\small pKa\)</span> values and the organic modifier content was assumed:</p>
<p><span class="math display">\[
pKa_{z,i,r}(t)=pKaw_{i,r}+\alpha_{m[z],i,r}\cdot\varphi_z(t)
\]</span></p>
<p>where <span class="math inline">\(\small pKa_{z,i,r}(t)\)</span> denotes dissociation constant of an <span class="math inline">\(\small i\)</span>-th analyte and <span class="math inline">\(\small r\)</span>-th dissociation step form and chromatographic conditions corresponding the z-th observation, <span class="math inline">\(\small pKaw_{i,r}\)</span> denotes aqueous <span class="math inline">\(\small pKa\)</span>, and <span class="math inline">\(\alpha_{m,i,r}\)</span> denotes the slope for <span class="math inline">\(\small m\)</span>-th modifier, <span class="math inline">\(\small i\)</span>-th analyte and <span class="math inline">\(\small r\)</span>-th form. The linear relationships is generally valid for <span class="math inline">\(\small \varphi\)</span> &lt; 0.8.</p>
<p>The relationship between pH and the organic modifier content for various combinations of organic modifier and buffer was experimentally determined prior to the chromatographic analysis. The obtained relationships was then described using quadratic equations for each nominal pH, temperature and organic modifier:</p>
<p><span class="math display">\[
pH_z(t)=pHo_z+\alpha 1_z\cdot \varphi_z(t)+\alpha2_z\cdot {\varphi_z(t)}^2
\]</span></p>
<p>First, individual values of <span class="math inline">\(\small logkw\)</span>, <span class="math inline">\(\small S1\)</span> are defined for the neutral form of an analyte in MeOH for the Xbridge Sheld RP18 column (denoted as <span class="math inline">\(\small logkwN_i\)</span> and <span class="math inline">\(\small S1mN_i\)</span>). The effect of ACN was described as (<span class="math inline">\(\small dS1N_i\)</span>), the effect of column (<span class="math inline">\(\small c=1..4\)</span>) was described by <span class="math inline">\(\small clogkwN_{c,i}\)</span>, <span class="math inline">\(\small cS1mN_{c,i}\)</span>, and <span class="math inline">\(\small cdS1N_{c,i}\)</span>). The individual parameters for the neutral forms were described using the following equations:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \begin{bmatrix}
logkwN_i \\
S1mN_i\\
\end{bmatrix} \sim
MVN(\begin{bmatrix}
\hat{logkw}+\beta_1 \cdot (logP_i-2.2) \\
\hat{S1m}+\beta_2 \cdot (logP_i-2.2) \\
\end{bmatrix},  \Omega) \\
&amp; dS1N_i \sim N(\hat{dS1}, \omega_3)\\
&amp; \Omega =
diag(\omega_{1:2}) \cdot \begin{bmatrix}
1 &amp; \rho \\
\rho &amp; 1  \\
\end{bmatrix} \cdot diag(\omega_{1:2}) \\
&amp; \begin{bmatrix}
clogkwN_{1,i} \\
clogkwN_{2,i} \\
clogkwN_{3,i} \\
clogkwN_{4,i} \\
\end{bmatrix} \sim
MVN(\begin{bmatrix}
\hat{clogkw_1}+c\beta_{1,1} \cdot (logP_i-2.2) \\
\hat{clogkw_2}+c\beta_{2,1} \cdot (logP_i-2.2) \\
\hat{clogkw_3}+c\beta_{3,1} \cdot (logP_i-2.2) \\
\hat{clogkw_4}+c\beta_{4,1} \cdot (logP_i-2.2) \\
\end{bmatrix},  c\Omega) \\
&amp; c\Omega =
diag(c\omega) \cdot \begin{bmatrix}
1 &amp; c\rho_{12} &amp; c\rho_{13} &amp; c\rho_{14} \\
  c\rho_{21} &amp; 1 &amp; c\rho_{23} &amp; c\rho_{24} \\
   c\rho_{31} &amp; c\rho_{32} &amp; 1 &amp; c\rho_{34} \\
   c \rho_{41} &amp; c\rho_{42} &amp; c\rho_{43} &amp; 1 \\
\end{bmatrix} \cdot diag(c\omega) \\
&amp; cS1mN_{c,i} \sim N(\hat{cS1m}+c\beta_{c,2}\cdot (logP_i-2.2), c\omega_{c,2}) \text{ for c=1...4} \\
&amp; cdS1N_{c,i} \sim N(\hat{cdS1_c}, c\omega_{c,3}) \text{ for c=1...4} \\
&amp; dlogkT_{c,i} \sim N(\hat{dlogkT_c},\omega_{T,c}) \text{ for c=1...4} \\
\end{aligned}
\]</span></p>
<p>were MVN denotes the multivariate normal distribution; <span class="math inline">\(\small \hat{logkw}\)</span>, <span class="math inline">\(\small \hat{S1m}\)</span>, <span class="math inline">\(\small \hat{dS1}\)</span> are the mean values of individual chromatographic parameters that correspond to a typical neutral analyte with <span class="math inline">\(\small logP\)</span> =2.2 at <span class="math inline">\(\small 25^oC\)</span> on Xbridge Shield RP18 stationary phase. <span class="math inline">\(\small \beta s\)</span> are regression coefficients between the individual chromatographic parameters and the <span class="math inline">\(\small logP_i\)</span>. <span class="math inline">\(\small \omega\)</span> denotes the standard deviation for between analyte variability (BAV). <span class="math inline">\(\small \hat{dlogkT}\)</span> denotes the effect of temperature for a typical analyte and <span class="math inline">\(\small \omega_T\)</span> the standard deviation for between analyte variability for temperature effects. Similar set of equations was used for column effects. Here c denoted the column effect (4 differences with respect to he reference column).</p>
<p>The difference in retention between the ionized form of an analyte and the neutral form of an analyte was separately estimated for acids and bases for <span class="math inline">\(\small logkw\)</span>, <span class="math inline">\(\small S1m\)</span>, <span class="math inline">\(\small dS1\)</span> parameters. Similar set of equations was used for column effects.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; dlogkwA_a \sim N(\hat{dlogkw_1}, \kappa_1), \\
&amp; dlogkwB_b \sim N(\hat{dlogkw_2}, \kappa_1), \\
&amp; dS1mA_a \sim N(\hat{dS1m_1}, \kappa_2), \\
&amp; dS1mB_b \sim N(\hat{dS1m_2}, \kappa_2), \\
&amp; ddS1A_a \sim N(\hat{ddS1_1}, \kappa_3), \\
&amp; ddS1B_b \sim N(\hat{ddS1_2}, \kappa_3), \\
&amp; cdlogkwA_{c,a} \sim N(\hat{cdlogkw_{c,1}}, c\kappa_{c,1}) \text{ for c=1...4}, \\
&amp; cdlogkwB_{c,b} \sim N(\hat{cdlogkw_{c,2}}, c\kappa_{c,1}) \text{ for c=1...4}, \\
&amp; cdS1mA_{c,a} \sim N(\hat{cdS1m_{c,1}}, c\kappa_{c,2}) \text{ for c=1...4}, \\
&amp; cdS1mB_{c,b} \sim N(\hat{cdS1m_{c,2}}, c\kappa_{c,2}) \text{ for c=1...4}, \\
&amp; cddS1A_{c,a} \sim N(\hat{cddS1_{c,1}}, c\kappa_{c,3}) \text{ for c=1...4}, \\
&amp; cddS1B_{c,b} \sim N(\hat{cddS1_{c,2}}, c\kappa_{c,3}) \text{ for c=1...4}. \\
\end{aligned}
\]</span> where a=1..46 and b=1..120 denote the indexes of acidic and basic groups.</p>
<p>Similarly <span class="math inline">\(\small pKa\)</span> an <span class="math inline">\(\small \alpha\)</span> parameters were described separately for acids and based:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; pKawA_{a} \sim N(pKaAlit_{a}, \tau_1), \\
&amp; pKawB_{b} \sim N(pKaBlit_{b}, \tau_1), \\
&amp; \alpha mA_{a} \sim N(\hat{\alpha m_1},\tau_2), \\
&amp; \alpha mB_{b} \sim N(\hat{\alpha m_2},\tau_2), \\
&amp; d\alpha A_{a} \sim N(\hat{d\alpha_1},\tau_3), \\
&amp; d\alpha B_{b} \sim N(\hat{d\alpha_2},\tau_3).
\end{aligned}
\]</span></p>
<p>Further, we created the matrices containing the value of parameters for i-th analyte, col-th column, m-th modifier an r-th dissociation step based on the value of neutral form and effects of column, organic modifier, and dissociation. This transformation was denoted as f(.). The exact procedure can be found in the model code displayed later.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; logkw_{col,i,r}= f(logkwN_i,clogkwN_{c,i},dlogkwA_{a},cdlogkwA_{c,a}, dlogkwB_{b}, cdlogkwB_{c.b},...) \\
&amp; S1_{m,col,i,r}  = f(S1mN_i,cS1mN_{c,i}, dS1mA_a, cdS1mA_{c,a}, S1mB_b, cdS1mB_{c,b}, ...\\
&amp; dS1N_i, cdS1N_{c,i}, ddS1A_a, cddS1A_{c,a}, ddS1B_b, cddS1B_{c,b},...) \\
&amp; apH_{m,col,i,r} = f(\hat{apH_1},\hat{capH_{c,1}},\hat{apH_2},\hat{capH_{c,2}},...) \\
&amp; S2_{m} = 10^{f(\hat{logS2m},\hat{dlogS2},...)} \\
&amp; pKaw_{i,r} = f(pKawA_{a},pKawB_{b},...) \\
&amp; \alpha_{m,i,r} = f(\alpha mA_{a}, d\alpha A_{a}, \alpha mB_{b}, d\alpha B_{b},...)
\end{aligned}
\]</span></p>
<p>Residual error model assumes different parameters for each column and analyte:</p>
<p><span class="math display">\[
\begin{aligned}
&amp; log(\sigma_{col,i}) = f(log\sigma_i, clog\sigma_{c,i}) \\
&amp; log\sigma_i  \sim N(log(m\sigma),s\sigma) \\
&amp; clog\sigma_{c,i} \sim N(clogm\sigma_c,cs\sigma_c) \text{ for c=1...4},
\end{aligned}
\]</span></p>
<p>The detailed description of parameters and used priors is provided in the following table (BAV denotes between analyte variability):</p>
<div class="cell" data-hash="index_cache/html/table_6640701fada8a22246f557d07eb54d8b">

<table class=" lightable-classic table" style="font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto; margin-left: auto; margin-right: auto;">
<caption>
Desciption of model paramters
</caption>
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:left;">
Namecode
</th>
<th style="text-align:left;">
Description
</th>
<th style="text-align:left;">
Priors
</th>
</tr>
</thead>
<tbody>
<tr grouplength="22">
<td colspan="4" style="border-bottom: 0;">
<strong>XBridge Shield RP18 parameters</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{logkw}\)</span>
</td>
<td style="text-align:left;">
logkwHat
</td>
<td style="text-align:left;">
typical logkw [Neutral]
</td>
<td style="text-align:left;">
N(2.2,2)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{S1m}\)</span>
</td>
<td style="text-align:left;">
S1mHat
</td>
<td style="text-align:left;">
effect of MeOH on logkw [Neutral]
</td>
<td style="text-align:left;">
N(4, 1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{dS1}\)</span>
</td>
<td style="text-align:left;">
dS1Hat
</td>
<td style="text-align:left;">
effect of ACN on S1m [Neutral]
</td>
<td style="text-align:left;">
N(1, 1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\beta_1\)</span>
</td>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:left;">
effect of logP on logkw [Neutral]
</td>
<td style="text-align:left;">
N(1, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\beta_2\)</span>
</td>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:left;">
effect of logP on S1m [Neutral]
</td>
<td style="text-align:left;">
N(0.5, 0.5)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{dlogkw_1}\)</span>
</td>
<td style="text-align:left;">
dlogkwHat[1]
</td>
<td style="text-align:left;">
effect of dissociation on logkw [Acids]
</td>
<td style="text-align:left;">
N(-1, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{dlogkw_2}\)</span>
</td>
<td style="text-align:left;">
dlogkwHat[2]
</td>
<td style="text-align:left;">
effect of dissociation on logkw [Bases]
</td>
<td style="text-align:left;">
N(-1, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{dS1m_1}\)</span>
</td>
<td style="text-align:left;">
dS1mHat[1]
</td>
<td style="text-align:left;">
effect of dissociation on S1m [Acids]
</td>
<td style="text-align:left;">
N(0, 0.5)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{dS1m_2}\)</span>
</td>
<td style="text-align:left;">
dS1mHat[2]
</td>
<td style="text-align:left;">
effect of dissociation on S1m [Bases]
</td>
<td style="text-align:left;">
N(0, 0.5)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{ddS1_1}\)</span>
</td>
<td style="text-align:left;">
ddS1Hat[1]
</td>
<td style="text-align:left;">
effect of dissociation on dS1 [Acids]
</td>
<td style="text-align:left;">
N(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{ddS1_2}\)</span>
</td>
<td style="text-align:left;">
ddS1Hat[2]
</td>
<td style="text-align:left;">
effect of dissociation on dS1 [Bases]
</td>
<td style="text-align:left;">
N(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{apH_1}\)</span>
</td>
<td style="text-align:left;">
apH[1]
</td>
<td style="text-align:left;">
effect of pH on logkw [Acids]
</td>
<td style="text-align:left;">
N(0, 0.1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{apH_2}\)</span>
</td>
<td style="text-align:left;">
apH[2]
</td>
<td style="text-align:left;">
effect of pH on logkw [Bases]
</td>
<td style="text-align:left;">
N(0, 0.1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{dlogkT}\)</span>
</td>
<td style="text-align:left;">
dlogkTHat
</td>
<td style="text-align:left;">
effect of temperature on logkw
</td>
<td style="text-align:left;">
N(-0.087, 0.022)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\omega_1\)</span>
</td>
<td style="text-align:left;">
omega[1]
</td>
<td style="text-align:left;">
sd of BAV for logkw [Neutral]
</td>
<td style="text-align:left;">
N+(0, 2)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\omega_2\)</span>
</td>
<td style="text-align:left;">
omega[2]
</td>
<td style="text-align:left;">
sd of BAV for S1 [Neutral]
</td>
<td style="text-align:left;">
N+(0, 2)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\omega_3\)</span>
</td>
<td style="text-align:left;">
omega[3]
</td>
<td style="text-align:left;">
sd of BAV for dS1 [Neutral]
</td>
<td style="text-align:left;">
N+(0, 2)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\rho\)</span>
</td>
<td style="text-align:left;">
rho[2,1]
</td>
<td style="text-align:left;">
correlation logkw vs S1 [Neutral]
</td>
<td style="text-align:left;">
LKJCORRN(0.75, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\omega_T\)</span>
</td>
<td style="text-align:left;">
omegaT
</td>
<td style="text-align:left;">
sd of BAV for dlogkT [Neutral]
</td>
<td style="text-align:left;">
N+(0, 0.022)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\kappa_1\)</span>
</td>
<td style="text-align:left;">
kappa[1]
</td>
<td style="text-align:left;">
sd of BAV for dlogkw [Acids and Bases]
</td>
<td style="text-align:left;">
N+(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\kappa_2\)</span>
</td>
<td style="text-align:left;">
kappa[2]
</td>
<td style="text-align:left;">
sd of BAV for dS1m [Acids and Bases]
</td>
<td style="text-align:left;">
N+(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\kappa_3\)</span>
</td>
<td style="text-align:left;">
kappa[3]
</td>
<td style="text-align:left;">
sd of BAV for ddS1 [Acids and Bases]
</td>
<td style="text-align:left;">
N+(0, 0.25)
</td>
</tr>
<tr grouplength="21">
<td colspan="4" style="border-bottom: 0;">
<strong>between column differences</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{clogkw_c}\)</span>
</td>
<td style="text-align:left;">
clogkwHat[c]
</td>
<td style="text-align:left;">
effect of column c on logkw [Neutral]
</td>
<td style="text-align:left;">
N(0, 1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cS1m_c}\)</span>
</td>
<td style="text-align:left;">
cS1mHat[c]
</td>
<td style="text-align:left;">
effect of column c on S1m [Neutral]
</td>
<td style="text-align:left;">
N(0, 0.5)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cdS1_c}\)</span>
</td>
<td style="text-align:left;">
cdS1Hat[c]
</td>
<td style="text-align:left;">
effect of column c on dS1 [Neutral]
</td>
<td style="text-align:left;">
N(0, 0.5)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\beta_{c,1}\)</span>
</td>
<td style="text-align:left;">
cbeta[c,1]
</td>
<td style="text-align:left;">
effect of column c on beta[1] [Neutral]
</td>
<td style="text-align:left;">
N(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\beta_{c,2}\)</span>
</td>
<td style="text-align:left;">
cbeta[c,2]
</td>
<td style="text-align:left;">
effect of column c on beta[2] [Neutral]
</td>
<td style="text-align:left;">
N(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cdlogkw_{c,1}}\)</span>
</td>
<td style="text-align:left;">
cdlogkwHat[c,1]
</td>
<td style="text-align:left;">
effect of column c on dlogkw [Acids]
</td>
<td style="text-align:left;">
N(0, 0.0625)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cdlogkw_{c,2}}\)</span>
</td>
<td style="text-align:left;">
cdlogkwHat[c,2]
</td>
<td style="text-align:left;">
effect of column c on dlogkw [Bases]
</td>
<td style="text-align:left;">
N(0, 0.0625)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cdS1m_{c,1}}\)</span>
</td>
<td style="text-align:left;">
cdS1mHat[c,1]
</td>
<td style="text-align:left;">
effect of column c on dS1m [Acids]
</td>
<td style="text-align:left;">
N(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cdS1m_{c,2}}\)</span>
</td>
<td style="text-align:left;">
cdS1mHat[c,2]
</td>
<td style="text-align:left;">
effect of column c on dS1m [Bases]
</td>
<td style="text-align:left;">
N(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cddS1_{c,1}}\)</span>
</td>
<td style="text-align:left;">
cddS1Hat[c,1]
</td>
<td style="text-align:left;">
effect of column c on ddS1 [Acids]
</td>
<td style="text-align:left;">
N(0, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cddS1_{c,2}}\)</span>
</td>
<td style="text-align:left;">
cddS1Hat[c,2]
</td>
<td style="text-align:left;">
effect of column c on ddS1 [Bases]
</td>
<td style="text-align:left;">
N(0, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{cdlogkT_c}\)</span>
</td>
<td style="text-align:left;">
cdlogkTHat[c]
</td>
<td style="text-align:left;">
effect of column c on dlogkwT
</td>
<td style="text-align:left;">
N(0, 0.011)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(capH_{c,1}\)</span>
</td>
<td style="text-align:left;">
capH[c,1]
</td>
<td style="text-align:left;">
effect of column c on apH [Acids]
</td>
<td style="text-align:left;">
N(0, 0.05)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(capH_{c,2}\)</span>
</td>
<td style="text-align:left;">
capH[c,2]
</td>
<td style="text-align:left;">
effect of column c on apH [Bases]
</td>
<td style="text-align:left;">
N(0, 0.05)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\omega_{c,1}\)</span>
</td>
<td style="text-align:left;">
comega[c,1]
</td>
<td style="text-align:left;">
sd of BAV for clogkw [Neutral]
</td>
<td style="text-align:left;">
N+(0, 1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\omega_{c,2}\)</span>
</td>
<td style="text-align:left;">
comega[c,2]
</td>
<td style="text-align:left;">
sd of BAV for cS1 [Neutral]
</td>
<td style="text-align:left;">
N+(0, 1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\omega_{c,3}\)</span>
</td>
<td style="text-align:left;">
comega[c,3]
</td>
<td style="text-align:left;">
sd of BAV for cdS1 [Neutral]
</td>
<td style="text-align:left;">
N+(0, 1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\kappa_{c,1}\)</span>
</td>
<td style="text-align:left;">
ckappa[c,1]
</td>
<td style="text-align:left;">
sd of BAV for cdlogkw [Acids and Bases]
</td>
<td style="text-align:left;">
N+(0, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\kappa_{c,2}\)</span>
</td>
<td style="text-align:left;">
ckappa[c,2]
</td>
<td style="text-align:left;">
sd of BAV for cdS1m [Acids and Bases]
</td>
<td style="text-align:left;">
N+(0, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\kappa_{c,3}\)</span>
</td>
<td style="text-align:left;">
ckappa[c,3]
</td>
<td style="text-align:left;">
sd of BAV for cddS1 [Acids and Bases]
</td>
<td style="text-align:left;">
N+(0, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\omega_{T,c}\)</span>
</td>
<td style="text-align:left;">
comegaT[c]
</td>
<td style="text-align:left;">
sd of BAV for dlogkT
</td>
<td style="text-align:left;">
N+(0, 0.011)
</td>
</tr>
<tr grouplength="2">
<td colspan="4" style="border-bottom: 0;">
<strong>S2</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{logS2m}\)</span>
</td>
<td style="text-align:left;">
logS2mHat
</td>
<td style="text-align:left;">
typical value of S2m (log10 scale)
</td>
<td style="text-align:left;">
N(-0.7, 0.125);
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{dlogS2}\)</span>
</td>
<td style="text-align:left;">
dlogS2Hat
</td>
<td style="text-align:left;">
effect of ACN on logS2m
</td>
<td style="text-align:left;">
N(1, 0.125);
</td>
</tr>
<tr grouplength="7">
<td colspan="4" style="border-bottom: 0;">
<strong>pKa</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{\alpha m_1}\)</span>
</td>
<td style="text-align:left;">
alphamHat[1]
</td>
<td style="text-align:left;">
effect of MeOH on pKa [Acids]
</td>
<td style="text-align:left;">
N(2, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{\alpha m_2}\)</span>
</td>
<td style="text-align:left;">
alphamHat[2]
</td>
<td style="text-align:left;">
effect of MeOH on pKa [Bases]
</td>
<td style="text-align:left;">
N(-1, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{d\alpha_1}\)</span>
</td>
<td style="text-align:left;">
dalphaHat[1]
</td>
<td style="text-align:left;">
effect of ACN on alpham [Acids]
</td>
<td style="text-align:left;">
N(0, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\hat{d\alpha_2}\)</span>
</td>
<td style="text-align:left;">
dalphaHat[2]
</td>
<td style="text-align:left;">
effect of ACN on alpham [Bases]
</td>
<td style="text-align:left;">
N(0, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\tau_1\)</span>
</td>
<td style="text-align:left;">
tau[1]
</td>
<td style="text-align:left;">
sd of BAV for pKalit
</td>
<td style="text-align:left;">
N+(0, 0.25)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\tau_2\)</span>
</td>
<td style="text-align:left;">
tau[2]
</td>
<td style="text-align:left;">
sd of BAV for alpham
</td>
<td style="text-align:left;">
N+(0, 0.125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(\tau_3\)</span>
</td>
<td style="text-align:left;">
tau[3]
</td>
<td style="text-align:left;">
sd of BAV for dalpha
</td>
<td style="text-align:left;">
N+(0, 0.125)
</td>
</tr>
<tr grouplength="4">
<td colspan="4" style="border-bottom: 0;">
<strong>Residuals</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(m\sigma\)</span>
</td>
<td style="text-align:left;">
msigma
</td>
<td style="text-align:left;">
typical sd of residuals for XBridge
</td>
<td style="text-align:left;">
N+(0,1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(s\sigma\)</span>
</td>
<td style="text-align:left;">
ssigma
</td>
<td style="text-align:left;">
sd of BAV of residuals for XBridge
</td>
<td style="text-align:left;">
N(0,1)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(clogmsigma_c\)</span>
</td>
<td style="text-align:left;">
clogmsigma[c]
</td>
<td style="text-align:left;">
effect of column c on msigma (log scale)
</td>
<td style="text-align:left;">
N+(0,125)
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
<span class="math inline">\(c\sigma_c\)</span>
</td>
<td style="text-align:left;">
cssigma[c]
</td>
<td style="text-align:left;">
sd of BAV of residuals for column c
</td>
<td style="text-align:left;">
N+(0,125)
</td>
</tr>
</tbody>

</table>
</div>
</section>
<section id="stan" class="level2">
<h2 class="anchored" data-anchor-id="stan">Stan</h2>
<p>Multilevel modeling was performed in <a href="https://mc-stan.org/">Stan software</a> linked with R/ <a href="https://mc-stan.org/cmdstanr/">cmdstanr</a>. For the inference we used the follwoing settings: number of iterations = 500, warmup = 1000, and number of Markov chains = 8. The reduce_sum function, which was selected to accelerate the calculations, works by parallelizing the execution of a single Stan chain across multiple cores. Convergence diagnostics were checked using Gelman−Rubin statistics and trace plots.</p>
<section id="initialize-variables-and-parameters" class="level3">
<h3 class="anchored" data-anchor-id="initialize-variables-and-parameters">Initialize variables and parameters</h3>
</section>
<section id="the-stan-model" class="level3">
<h3 class="anchored" data-anchor-id="the-stan-model">The Stan model:</h3>
<div class="cell" data-hash="index_cache/html/stancode_3daf3c2ec586c5d7af902ef9faee8165">
<div class="cell-output cell-output-stdout">
<pre><code>functions {
  // credit http://srmart.in/informative-priors-for-correlation-matrices-an-easy-approach/
  real lkj_corr_point_lower_tri_lpdf(matrix rho, real point_mu_lower,
                                     real point_scale_lower) {
    // works only for [2x2 matrix]
    real lpdf = lkj_corr_lpdf(rho | 1)
                + normal_lpdf(rho[2, 1] | point_mu_lower, point_scale_lower);
    return lpdf;
  }
  

  // pH and fi at a given time at column inlet
  vector gra_state(real t, vector hplcparam) {
    vector[2] sol;
    real tg = hplcparam[1];
    real td = hplcparam[2];
    real fio = hplcparam[5];
    real fik = hplcparam[6];
    real pHo = hplcparam[8];
    real alpha1 = hplcparam[9];
    real alpha2 = hplcparam[10];
    real fi;
    
    fi = fio + (fik - fio) / tg * (t - td);
    
    if (t &lt; td) {
      fi = fio;
    } else if (t &gt; tg + td) {
      fi = fik;
    }
    
    sol[1] = fi;
    sol[2] = pHo + alpha1 * fi + alpha2 * fi ^ 2;
    
    return sol;
  }
  
 real funlnki(vector logkw, vector apH, vector S1, real S2, vector pKaw, vector alpha,
                  int nDiss, real fi, real pH) {
    real lnki;
    vector[3] logkix;
    vector[2] pHmpKa;
    
    logkix = log(10) *(logkw - S1*(1+S2) * fi / (1 + S2 * fi) + apH * (pH - 7));
    pHmpKa = log(10) *(pH - (pKaw + alpha * fi));
    
    if (nDiss == 0) {
      lnki = logkix[1];
    } else if (nDiss == 1) {
      lnki = logkix[1] +
             log1p_exp(pHmpKa[1] + logkix[2] - logkix[1]) -
             log1p_exp(pHmpKa[1]);
    } else if (nDiss == 2) {
      lnki = logkix[1] +
             log1p_exp(pHmpKa[1]+logkix[2]-logkix[1] + log1p_exp(pHmpKa[2]+logkix[3]-logkix[2])) -
             log1p_exp(pHmpKa[1] + log1p_exp(pHmpKa[2]));
    }
    
    return lnki;
  }  
 
  vector areaandslope(real dt, real lnki1, real lnki2, real invki1, real invki2) {
    vector[2] cki_b;
    real bo;
    real cki;
    
    if (invki2 &gt; 1.001 * invki1) {
      bo = (lnki1 - lnki2) / dt;
      cki = (invki2 - invki1) / bo;
    }
    
    else if (invki1 &gt; 1.001 * invki2) {
      bo = (lnki2 - lnki1) / dt;
      cki = (invki1 - invki2) / bo;
    }
    else {
      bo = 0.001 / dt;
      cki = dt * (invki2 + invki1) / 2;
    }
    
    cki_b[1] = cki;
    cki_b[2] = bo;
    
    return cki_b;
  }
  
  real chromgratrapz(int steps, vector logkw, vector apH, vector S1,  real S2, vector pKaw,
                     vector alpha, int nDiss, vector hplcparam) {
                       
    real tg = hplcparam[1];
    real td = hplcparam[2];
    real to = hplcparam[3];
    real te = hplcparam[4];
    
    vector[1] sol;
    real time1;
    real time2;
    vector[2] fipH1;
    vector[2] fipH2;
    real lnki1;
    real lnki2;
    real invki1;
    real invki2;
    vector[2] cki_b;
    real cumki1;
    real cumki2;
    real bo;
    real tr;
    real dt;
    
    dt = tg / steps;
    
    time1 = 0;
    time2 = td;
    
    fipH1 = gra_state(time1, hplcparam);
    lnki1 = funlnki(logkw, apH, S1, S2, pKaw, alpha, nDiss, fipH1[1], fipH1[2]);
    lnki2=lnki1;
    
    invki1 = exp(-lnki1)/to;
    invki2 = invki1;
    
    cumki1 = 0;
    cumki2 = td*invki1; 
    
    bo = 0.001 / td;
    
    for (x in 1 : steps) {
      if (cumki2 &gt;= 1) {
        continue;
      }
      time1 = time2;
      time2 += dt;
      fipH2 = gra_state(time2, hplcparam);
      lnki1 = lnki2;
      lnki2 = funlnki(logkw, apH, S1, S2, pKaw, alpha, nDiss, fipH2[1], fipH2[2]);
      invki1 = invki2;
      invki2 = exp(-lnki2)/to;
      cki_b = areaandslope(dt, lnki1, lnki2, invki1, invki2);
      cumki1 = cumki2;
      cumki2 += cki_b[1];
      bo = cki_b[2];
    }
    
    if (cumki2 &gt;= 1 &amp;&amp; cumki1==0) {
      tr = te+to+1/invki2;
    } else if (cumki2 &gt;= 1) {
      tr = te+to+time1+log1p_exp(log((1-cumki1)*bo*to) + lnki1)/bo;
    } else if (cumki2 &lt; 1) {
      tr = te+to+time2+(1-cumki2)/invki2;
    }
            
    return tr;
            
  }
  
  real partial_sum(array[] int ind, int start, int end, 
                   vector trobs,
                   array[] int steps,
                   array[] vector hplcparam,
                   array[] int analyte,
                   array[] int column,
                   array[] int modifier,
                   array[] int R,
                   array[,] vector logkw,
                   array[,] vector apH,
                   array[, ,] vector S1,
                   array[,] real S2,
                   array[] vector pKaw,
                   array[,] vector alpha,
                   array[,] real dlogkT,
                   array[] vector sigma) {
                     
    real lp = 0;

    for (z in start : end) {
      
    real y_hat = chromgratrapz(steps[z], 
                                logkw[analyte[z], column[z],  : ] + dlogkT[analyte[z],column[z]]  * hplcparam[z, 11],
                                apH[analyte[z], column[z], : ],
                                S1[analyte[z], modifier[z], column[z],  : ],
                                S2[modifier[z], column[z]],
                                pKaw[analyte[z],  : ],
                                alpha[analyte[z],modifier[z],  : ],
                                R[analyte[z]],
                                hplcparam[z]);

     lp = lp + student_t_lpdf(trobs[z] | 3, y_hat,  sigma[analyte[z],column[z]]);
      
    }
    return lp;
  }
}

data {
  int nAnalytes;            // number of analytes
  int nColumns;             // number of columns
  int nModifiers;           // number of org. modifiers
  int nObs;                 // number of observations
  array[nObs] int analyte;   // analyte indexes
  array[nObs] int column;   // column indexes
  array[nObs] int modifier;  // modifier indexes
  array[nObs] int&lt;lower=1&gt; steps;  // steps for gradient retention time aproximation
  array[nObs] vector[12] hplcparam; // [tg, td, to, te, fio, fik, org modifier, pHo, alpha1, alpha2, (temp-25)/10, column]
  vector[nAnalytes] logPobs;
  int&lt;lower=0, upper=2&gt; maxR; //
  array[nAnalytes] int&lt;lower=0, upper=2&gt; R;
  int&lt;lower=1&gt; nGroupsA;
  int&lt;lower=1&gt; nGroupsB;
  vector[nGroupsA] pKaslitA;
  vector[nGroupsB] pKaslitB;
  array[nGroupsA,2] int idxGroupsA;
  array[nGroupsB,2] int idxGroupsB;
  
  vector[nObs] trobs;                   // observed retention factors 
  int&lt;lower=0, upper=1&gt; run_estimation; // 0 for prior predictive, 1 for estimation
}
transformed data {
  int grainsize = 1;
  array[nObs] int ind = rep_array(1, nObs);
}

parameters {
  
  real logkwHat; // typical logkw [Neutral]
  real S1mHat;   // effect of MeOH on logkw [Neutral]
  real dS1Hat;   // effect of ACN on S1m [Neutral]
  array[2] real dlogkwHat; // effect of dissociation on logkw [Acids, Bases]
  array[2] real dS1mHat;   // effect of dissociation on S1m [Acids, Bases]
  array[2] real ddS1Hat;   // effect of dissociation on dS1 [Acids, Bases] 
  real logS2mHat; // typical value of S2m (log10 scale)
  real dlogS2Hat; // effect of ACN on logS2m
  vector[2] beta; // effect of logP on logkw and S1m
  real dlogkTHat; // effect of temperature on logkw
  vector[2] apH;  // effect of pH on logkw [Acids, Bases]
  array[2] real alphamHat;   // effect of MeOH on pKa [Acids, Bases]
  array[2] real dalphaHat;   // effect of ACN on alpham [Acids, Bases]
  vector&lt;lower=0&gt;[3] tau;   // sd for between analyte variability of pKa's
  vector&lt;lower=0&gt;[3] omega; // sd of BAV [logkw,S1m, dS1]
  corr_matrix[2] rho;      // correlation matrix [logkw vs. S1m] 
  real&lt;lower=0&gt; omegaT;     // sd of BAV [dlogkT]
  vector&lt;lower=0&gt;[3] kappa; // sd of BAV [dlogkw,dS1m,ddS1]
  
  // 2nd column
  vector[nColumns-1] clogkwHat;          // effect of column on logkw [Neutral]
  vector[nColumns-1] cS1mHat;            // effect of column on S1m [Neutral]
  vector[nColumns-1] cdS1Hat;            // effect of column on dS1 [Neutral]
  matrix[nColumns-1,2] cdlogkwHat;      // effect of column on logkw [Acids, Bases]
  matrix[nColumns-1,2] cdS1mHat;        // effect of column on dS1m [Acids, Bases]
  matrix[nColumns-1,2] cddS1Hat;        // effect of column on ddS1 [Acids, Bases] 
  matrix[nColumns-1,2]  cbeta;
  vector[nColumns-1]   cdlogkTHat;       // effect of column on dlogkTHat
  matrix[nColumns-1,2] capH;             // effect of column on apH  [Acids, Bases]
  matrix&lt;lower=0&gt;[nColumns-1,3] comega;  // sd of BAV [clogkw,cS1m,cdS1]
  vector&lt;lower=0&gt;[nColumns-1]  comegaT;  // sd of BAV [cdlogkT]
  matrix&lt;lower=0&gt;[nColumns-1,3] ckappa;  // sd of BAV [cdlogkw,cdS1m,cddS1]
  cholesky_factor_corr[nColumns-1] corr_L;   // cholesky factor correlation matrix 
  
  // 1st column
  array[nAnalytes] vector[2] paramN;
  vector[nAnalytes] dS1N;
  vector[nAnalytes] dlogkT;
  vector[nGroupsA] dlogkwA;
  vector[nGroupsB] dlogkwB;
  vector[nGroupsA] dS1mA;
  vector[nGroupsB] dS1mB;
  vector[nGroupsA] dS1A;
  vector[nGroupsB] dS1B;

  // 2nd column
  matrix[nColumns-1, nAnalytes] etaclogkwNStd;
  array[nColumns-1] vector[nAnalytes] etacS1mN;
  array[nColumns-1] vector[nAnalytes] etacdS1N;
  array[nColumns-1] vector[nAnalytes] etacdlogkT;
  array[nColumns-1] vector[nGroupsA] etacdlogkwA;
  array[nColumns-1] vector[nGroupsB] etacdlogkwB;
  array[nColumns-1] vector[nGroupsA] etacdS1mA;
  array[nColumns-1] vector[nGroupsB] etacdS1mB;
  array[nColumns-1] vector[nGroupsA] etacdS1A;
  array[nColumns-1] vector[nGroupsB] etacdS1B;
   
  // Dissociation
  vector[nGroupsA] pKawA;
  vector[nGroupsB] pKawB;
  vector[nGroupsA] etaalphamA;
  vector[nGroupsB] etaalphamB;
  vector[nGroupsA] etadalphaA;
  vector[nGroupsB] etadalphaB;
  
  // residual variability for the 1st and 2nd column
  real&lt;lower=0&gt; msigma;   // typical sigma for the 1st column]
  real&lt;lower=0&gt; ssigma;
  vector[nAnalytes] logsigma; 
    
  vector[nColumns-1] clogmsigma; // effect of column on log(msigma)]
  vector&lt;lower=0&gt;[nColumns-1] cssigma; ; //sd of residual [1st,2nd column]
  array[nColumns-1] vector[nAnalytes] etaclogsigma;
}
transformed parameters {
  
  cov_matrix[2] Omega;
  
  array[nAnalytes] vector[3] miu;
  array[nAnalytes,3] vector[nColumns-1] cmiu;
  array[nAnalytes,nColumns]   vector[maxR + 1] logkwx;
  array[nAnalytes,nModifiers, nColumns] vector[maxR + 1] S1x;
  array[nModifiers,nColumns]  real S2x;
  array[nAnalytes,nColumns]   vector[maxR + 1] apHx;
  array[nAnalytes,nModifiers] vector[maxR] alphax;
  array[nAnalytes, nColumns]  real dlogkTx;
  array[nAnalytes] vector[maxR] pKawx;
  array[nAnalytes] vector[nColumns] sigmax;
  
  array[nColumns-1] vector[nAnalytes] clogkwN;
  matrix[nColumns-1, nAnalytes] etaclogkwN;
  array[nColumns-1] vector[nAnalytes] cS1mN;
  array[nColumns-1] vector[nAnalytes] cdS1N;
  array[nColumns-1] vector[nGroupsA] cdlogkwA;
  array[nColumns-1] vector[nGroupsB] cdlogkwB;
  array[nColumns-1] vector[nGroupsA] cdS1mA;
  array[nColumns-1] vector[nGroupsB] cdS1mB;
  array[nColumns-1] vector[nGroupsA] cdS1A;
  array[nColumns-1] vector[nGroupsB] cdS1B;
   array[nColumns-1] vector[nAnalytes] cdlogkT;
   array[nColumns-1] vector[nAnalytes] clogsigma;
  vector[nGroupsA] alphamA;
  vector[nGroupsB] alphamB;
  vector[nGroupsA] dalphaA;
  vector[nGroupsB] dalphaB;
  
  Omega = quad_form_diag(rho, omega[1 : 2]); // diag_matrix(omega) * rho * diag_matrix(omega)
  
  for (i in 1 : nAnalytes) {
    miu[i, 1] = logkwHat + beta[1] * (logPobs[i] - 2.2);
    miu[i, 2] = S1mHat   + beta[2] * (logPobs[i] - 2.2);
    miu[i, 3] = dS1Hat;
  }
  
   for (i in 1 : nAnalytes) {
    for (c in 1 : (nColumns-1)) {
    cmiu[i, 1, c] = clogkwHat[c] + cbeta[c,1] * (logPobs[i] - 2.2);
    cmiu[i, 2, c] = cS1mHat[c]   + cbeta[c,2] * (logPobs[i] - 2.2);
    cmiu[i, 3, c] = cdS1Hat[c];
  }}
   
  // Matt's trick to use unit scale 
  etaclogkwN = diag_pre_multiply(comega[,1], corr_L * etaclogkwNStd); 
  
  for (i in 1 : nAnalytes) { 
   logkwx[i, 1, : ]  =  paramN[i,1]*[1,1,1]';
  for (c in 1 : (nColumns-1)) {
   clogkwN[c,i] = cmiu[i, 1, c]  + etaclogkwN[c,i];
   logkwx[i, c+1, : ]  =  (paramN[i,1]+clogkwN[c,i])*[1,1,1]'; 
  }}
   
  for (d in 1 : nGroupsA) {
    logkwx[idxGroupsA[d,1], 1, 1+idxGroupsA[d,2]] += dlogkwA[d];
    if (idxGroupsA[d,2]==1) {
   logkwx[idxGroupsA[d,1], 1, 3] += dlogkwA[d];
   }
    for (c in 1 : (nColumns-1)) {
   cdlogkwA[c,d] = cdlogkwHat[c,1] + ckappa[c,1]*etacdlogkwA[c,d];
   logkwx[idxGroupsA[d,1], c+1, 1+idxGroupsA[d,2]] += dlogkwA[d]+cdlogkwA[c,d];
   if (idxGroupsA[d,2]==1) {
   logkwx[idxGroupsA[d,1], c+1, 3] += dlogkwA[d]+cdlogkwA[c,d];
   }}}
  
  for (d in 1 : nGroupsB) {
    logkwx[idxGroupsB[d,1], 1, idxGroupsB[d,2]] += dlogkwB[d];
    if (idxGroupsB[d,2]==2) {
    logkwx[idxGroupsB[d,1], 1, 1] += dlogkwB[d];
    }
    for (c in 1 : (nColumns-1)) {
    cdlogkwB[c,d] = cdlogkwHat[c,2]+ ckappa[c,1]*etacdlogkwB[c,d];
    logkwx[idxGroupsB[d,1], c+1, idxGroupsB[d,2]] += dlogkwB[d]+cdlogkwB[c,d];
    if (idxGroupsB[d,2]==2) {
    logkwx[idxGroupsB[d,1], c+1, 1] += dlogkwB[d]+cdlogkwB[c,d];
    }}}
   
  for (i in 1 : nAnalytes) { 
    apHx[i, 1, : ] = [0,0,0]';
    for (c in 1 : (nColumns-1)) {
    apHx[i, c+1, : ] = [0,0,0]'; 
  }}
   
  for (d in 1 : nGroupsA) {
    apHx[idxGroupsA[d,1], 1, 1+idxGroupsA[d,2]] += apH[1];
  if (idxGroupsA[d,2]==1) {
   apHx[idxGroupsA[d,1], 1, 3] += apH[1];
   }
  for (c in 1 : (nColumns-1)) {
   apHx[idxGroupsA[d,1], c+1, 1+idxGroupsA[d,2]] += apH[1]+capH[c,1];
  if (idxGroupsA[d,2]==1) {
   apHx[idxGroupsA[d,1], c+1, 3] += apH[1]+capH[c,1];
   }}}
  
  for (d in 1 : nGroupsB) {
    apHx[idxGroupsB[d,1], 1, idxGroupsB[d,2]] += apH[2];
         if (idxGroupsB[d,2]==2) {
    apHx[idxGroupsB[d,1], 1, 1] += apH[2];
   }
   for (c in 1 : (nColumns-1)) {
    apHx[idxGroupsB[d,1], c+1, idxGroupsB[d,2]] += apH[2]+capH[c,2];
    if (idxGroupsB[d,2]==2) {
    apHx[idxGroupsB[d,1], c+1, 1] += apH[2]+capH[c,2];
   }}}
   
  
  for (i in 1 : nAnalytes) { 
   S1x[i, 1, 1, : ]  =  paramN[i,2]*[1,1,1]';
   S1x[i, 2, 1, : ]  =  paramN[i,2]*[1,1,1]' + dS1N[i]; 
  for (c in 1 : (nColumns-1)) {
   cS1mN[c,i] = cmiu[i,2,c] + comega[c,2]*etacS1mN[c,i];
   cdS1N[c,i] = cmiu[i,3,c] + comega[c,3]*etacdS1N[c,i];
   S1x[i, 1, c+1, : ]  =  (paramN[i,2]+cS1mN[c,i])*[1,1,1]' ;
   S1x[i, 2, c+1, : ]  =  (paramN[i,2]+cS1mN[c,i])*[1,1,1]' + (dS1N[i]+cdS1N[c,i]); 
  }}
   
  for (d in 1 : nGroupsA) {
   S1x[idxGroupsA[d,1], 1, 1, 1+idxGroupsA[d,2]] += dS1mA[d];
   S1x[idxGroupsA[d,1], 2, 1, 1+idxGroupsA[d,2]] += dS1mA[d]+dS1A[d]; 
    
  if (idxGroupsA[d,2]==1) {
   S1x[idxGroupsA[d,1], 1, 1, 3] += dS1mA[d];
   S1x[idxGroupsA[d,1], 2, 1, 3] += dS1mA[d]+dS1A[d];
   }
   
  for (c in 1 : (nColumns-1)) {  
   cdS1mA[c,d]= cdS1mHat[c,1] + ckappa[c,2]*etacdS1mA[c,d];
   cdS1A[c,d] = cddS1Hat[c,1] + ckappa[c,3]*etacdS1A[c,d];
   S1x[idxGroupsA[d,1], 1, c+1, 1+idxGroupsA[d,2]] += dS1mA[d]        +cdS1mA[c,d];
   S1x[idxGroupsA[d,1], 2, c+1, 1+idxGroupsA[d,2]] += dS1mA[d]+dS1A[d]+cdS1mA[c,d]+cdS1A[c,d];
  if (idxGroupsA[d,2]==1) {
   S1x[idxGroupsA[d,1], 1, c+1, 3] += dS1mA[d]        +cdS1mA[c,d];
   S1x[idxGroupsA[d,1], 2, c+1, 3] += dS1mA[d]+dS1A[d]+cdS1mA[c,d]+cdS1A[c,d];
   }}}
  
  for (d in 1 : nGroupsB) {
    S1x[idxGroupsB[d,1], 1, 1, idxGroupsB[d,2]] += dS1mB[d];
    S1x[idxGroupsB[d,1], 2, 1, idxGroupsB[d,2]] += dS1mB[d]+dS1B[d];
    if (idxGroupsB[d,2]==2) {
    S1x[idxGroupsB[d,1], 1, 1, 1] += dS1mB[d];
    S1x[idxGroupsB[d,1], 2, 1, 1] += dS1mB[d]+dS1B[d];
   }
    for (c in 1 : (nColumns-1)) {
    cdS1mB[c,d]= cdS1mHat[c,2] + ckappa[c,2]*etacdS1mB[c,d];
    cdS1B[c,d] = cddS1Hat[c,2] + ckappa[c,3]*etacdS1B[c,d];

    S1x[idxGroupsB[d,1], 1, c+1, idxGroupsB[d,2]] += dS1mB[d]        +cdS1mB[c,d];
    S1x[idxGroupsB[d,1], 2, c+1, idxGroupsB[d,2]] += dS1mB[d]+dS1B[d]+cdS1mB[c,d]+cdS1B[c,d];
  if (idxGroupsB[d,2]==2) {
    S1x[idxGroupsB[d,1], 1, c+1, 1] += dS1mB[d]        +cdS1mB[c,d];
    S1x[idxGroupsB[d,1], 2, c+1, 1] += dS1mB[d]+dS1B[d]+cdS1mB[c,d]+cdS1B[c,d];
   }}} 
  
   S2x[1,1] = 10^(logS2mHat);
   S2x[2,1] = 10^(logS2mHat + dlogS2Hat);
   
   for (c in 1 : (nColumns-1)) {
   S2x[1,c+1] = S2x[1,1];
   S2x[2,c+1] = S2x[2,1];
   }
   
  for (i in 1 : nAnalytes) { 
   dlogkTx[i, 1]  = dlogkT[i];
  for (c in 1 : (nColumns-1)) {
   cdlogkT[c,i] = cdlogkTHat[c]+comegaT[c]*etacdlogkT[c,i];
   dlogkTx[i, c+1]  =  dlogkT[i] + cdlogkT[c,i];
  }}
  
  for (i in 1 : nAnalytes) { 
   pKawx[i, : ]  = [0,0]';
   alphax[i, 1, : ]  = [0,0]'; 
   alphax[i, 2, : ]  = [0,0]'; 
  }
  
  for (d in 1 : nGroupsA) {
    
  alphamA[d] = alphamHat[1] + tau[2]*etaalphamA[d];
  dalphaA[d] = dalphaHat[1] + tau[3]*etadalphaA[d];
   
  pKawx[idxGroupsA[d,1], idxGroupsA[d,2]] = pKawA[d];
  alphax[idxGroupsA[d,1], 1, idxGroupsA[d,2]]= alphamA[d];
  alphax[idxGroupsA[d,1], 2, idxGroupsA[d,2]]= alphamA[d]+dalphaA[d];
   }
  
  for (d in 1 : nGroupsB) {
    alphamB[d] = alphamHat[2] + tau[2]*etaalphamB[d];
    dalphaB[d] = dalphaHat[2] + tau[3]*etadalphaB[d];
    pKawx[idxGroupsB[d,1], idxGroupsB[d,2]] = pKawB[d];
    alphax[idxGroupsB[d,1], 1, idxGroupsB[d,2]]= alphamB[d];
    alphax[idxGroupsB[d,1], 2, idxGroupsB[d,2]]= alphamB[d]+dalphaB[d];
   }
   
  for (i in 1 : nAnalytes) { 
   sigmax[i, 1] = exp(logsigma[i]);
   for (c in 1 : (nColumns-1)) {
   clogsigma[c,i] = clogmsigma[c] + cssigma[c]*etaclogsigma[c,i];
   sigmax[i, c+1] = exp(logsigma[i]+clogsigma[c,i]); 
  }}
}

model {
  logkwHat ~ normal(2.2, 2);
  S1mHat ~ normal(4, 1);
  dS1Hat ~ normal(1, 0.5);
  dlogkwHat ~ normal(-1, 0.125);
  dS1mHat   ~ normal(0, 0.5);
  ddS1Hat   ~ normal(0, 0.25);
  logS2mHat ~ normal(-0.7, 0.125);
  dlogS2Hat ~ normal(1, 0.125);
  beta[{1}] ~ normal(1, 0.125);
  beta[{2}] ~ normal(0.5, 0.5);
  dlogkTHat ~ normal(-0.087, 0.022);
  apH       ~ normal(0, 0.1);
  
  alphamHat[{1}] ~ normal(2, 0.25);
  alphamHat[{2}] ~ normal(-1, 0.25);
  dalphaHat ~ normal(0, 0.125);
  tau[{1}] ~ normal(0, 0.25);
  tau[{2,3}] ~ normal(0, 0.125);
  omega ~ normal(0, 2);
  rho ~ lkj_corr_point_lower_tri(0.75, 0.125);
  omegaT ~ normal(0, 0.022);
  kappa ~ normal(0, 0.25);
    
  clogkwHat ~ normal(0, 1);
  cS1mHat ~ normal(0, 0.5);
  cdS1Hat ~ normal(0, 0.25);
  to_vector(cdlogkwHat) ~ normal(0, 0.0625);
  to_vector(cdS1mHat) ~ normal(0, 0.25);
  to_vector(cddS1Hat) ~ normal(0, 0.125); 
  to_vector(cbeta) ~ normal(0, 0.25);
  cdlogkTHat ~ normal(0, 0.011);
  to_vector(capH) ~ normal(0, 0.05);
  to_vector(comega) ~ normal(0, 0.5);
  comegaT ~ normal(0, 0.011);
  to_vector(ckappa) ~ normal(0, 0.125);
   
  corr_L~lkj_corr_cholesky(2.0);
  
  for (i in 1 : nAnalytes) {
  paramN[i] ~ multi_normal(miu[i,1:2], Omega);
  }
  
  dS1N ~ normal(miu[,3], omega[3]);
  dlogkT ~ normal(dlogkTHat, omegaT);
  dlogkwA ~ normal(dlogkwHat[1], kappa[1]);
  dlogkwB ~ normal(dlogkwHat[2], kappa[1]);
  dS1mA ~ normal(dS1mHat[1], kappa[2]);
  dS1mB ~ normal(dS1mHat[2], kappa[2]);
  dS1A ~ normal(ddS1Hat[1], kappa[3]);
  dS1B ~ normal(ddS1Hat[2], kappa[3]);
  
  to_vector(etaclogkwNStd) ~ normal(0, 1);
  
 for (c in 1 : (nColumns-1)) { 
  etacS1mN[c] ~ normal(0,1);
  etacdS1N[c] ~ normal(0,1);
  etacdlogkT[c] ~ normal(0,1);
  etacdlogkwA[c] ~ normal(0,1);
  etacdlogkwB[c] ~ normal(0,1);
  etacdS1mA[c] ~ normal(0,1);
  etacdS1mB[c] ~ normal(0,1);
  etacdS1A[c] ~ normal(0,1);
  etacdS1B[c] ~ normal(0,1);
 }
 
  pKawA ~ normal(pKaslitA, tau[1]);
  pKawB ~ normal(pKaslitB, tau[1]);
  etaalphamA ~ normal(0,1);
  etaalphamB ~ normal(0,1);
  etadalphaA ~ normal(0,1);
  etadalphaB ~ normal(0,1);
  
  msigma ~ normal(0,1);
  ssigma ~ normal(0,1);
  logsigma  ~ normal(log(msigma),ssigma); 
  
  clogmsigma ~ normal(0,0.125);
  cssigma ~ normal(0,0.125);
  
  for (c in 1 : (nColumns-1)) { 
  etaclogsigma[c]  ~ normal(0,1); 
  }
  
  if (run_estimation == 1) {

    target += reduce_sum(partial_sum, ind, grainsize, trobs, steps,
                         hplcparam, analyte, column, modifier, R, logkwx, apHx,
                         S1x, S2x, pKawx, alphax, dlogkTx, sigmax);
  }
}

generated quantities {
   corr_matrix[nColumns-1] crho;
   crho = corr_L * corr_L';
}</code></pre>
</div>
</div>
</section>
<section id="fitting-the-model" class="level3">
<h3 class="anchored" data-anchor-id="fitting-the-model">Fitting the model</h3>
<p>Compile the model:</p>
<p>The optimization was used for initial testing:</p>
<p>For local computations one can use cmdstanr:</p>
<p>We performed computations at the Academic Computer Center in Gdańsk, <a href="https://docs.task.gda.pl/kdm/zasoby-sprzetowe/tryton/">Tryton Cluster</a>. In this case:</p>
<ol type="1">
<li>we dumped the necessary data to .json format</li>
</ol>
<ol start="2" type="1">
<li>we run the model using the batch file:</li>
</ol>
<pre> 
#!/bin/bash -l
#SBATCH --job-name=cmdstan_conda
#SBATCH -N 1
#SBATCH -n 24
#SBATCH -p batch
#SBATCH --time=48:00:00
#SBATCH --mem=64gb
#SBATCH --array=1-8%8

module load tryton/cmdstan/2.30.1-conda
export STAN_THREADS=true
export CMDSTAN_MODEL_NAME="hplc-gra-twocolumns"
export MODEL_SRC_DIR=${TASK_USER_WORK}
cd ${MODEL_SRC_DIR}
[ -f ${CMDSTAN_MODEL_NAME} ] &amp;&amp; echo "Model "${CMDSTAN_MODEL_NAME}" exists" || cmdstan_model ${CMDSTAN_MODEL_NAME}
wait
${PWD}/${CMDSTAN_MODEL_NAME} sample num_samples=500 num_warmup=1000 algorithm=hmc engine=nuts max_depth=10 stepsize=0.01 adapt delta=0.9 data file=$PWD/standata.json init=$PWD/init-${SLURM_ARRAY_TASK_ID}.json  num_threads=${SLURM_NTASKS} output file=$PWD/output_${SLURM_ARRAY_TASK_ID}.csv 
</pre>
<ol start="3" type="1">
<li>After calculations, we loaded the output files using cmdstanr. The files are accessible through <a href="https://cloud.gumed.edu.pl/s/MbHmekcg79w4ot4" title="Stan output files">stan output files</a>.</li>
</ol>
<ol start="4" type="1">
<li>finally we checked the diagnostics of Monte Carlo inferences based on the Stan documentation described here <a href="https://mc-stan.org/docs/cmdstan-guide/diagnose.html"></a>.</li>
</ol>
<p>The diagnostics are reasonable given model complexity. Output copied here to save time:</p>
<pre> [1] "Processing csv files: output_1.csv, output_2.csv, output_3.csv, output_4.csv, output_5.csv, output_6.csv, output_7.csv, output_8.csv"
 [2] ""
 [3] "Checking sampler transitions treedepth." 
 [4] "4000 of 4000 (100.00%) transitions hit the maximum treedepth limit of 10, or 2^10 leapfrog steps." 
 [5] "Trajectories that are prematurely terminated due to this limit will result in slow exploration." 
 [6] "For optimal performance, increase this limit." 
 [7] ""
 [8] "Checking sampler transitions for divergences." 
 [9] "No divergent transitions found." 
[10] ""
[11] "Checking E-BFMI - sampler transitions HMC potential energy." 
[12] "E-BFMI satisfactory."
[13] ""
[14] "Effective sample size satisfactory." 
[15] ""
[16] "The following parameters had split R-hat greater than 1.05:" 
[17] "etacdS1N[3,38], etaalphamB[92]"
[18] "Such high values indicate incomplete mixing and biased estimation."
[19] "You should consider regularizating your model with additional prior information or a more effective parameterization." 
[20] ""
[21] "Processing complete."                                                                 
</pre>
</section>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<section id="summary-of-model-parameters-table" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-model-parameters-table">Summary of model parameters (table):</h2>
<div id="tbl-summary" class="cell tbl-parent quarto-layout-panel anchored" data-hash="index_cache/html/tbl-summary_4ea18eb366016dd5228e735f4df078ca">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>     variable  mean median   sd  mad    q5   q95 rhat ess_bulk ess_tail
 logkwHat      3.60   3.60 0.08 0.08  3.47  3.72 1.00     5947     3030
 S1mHat        4.92   4.92 0.08 0.08  4.79  5.05 1.00     5251     3063
 dS1Hat        0.61   0.61 0.05 0.05  0.53  0.69 1.00     3259     2365
 dlogkwHat[1] -0.79  -0.79 0.07 0.07 -0.91 -0.67 1.00     7672     3143
 dlogkwHat[2] -0.97  -0.97 0.05 0.05 -1.05 -0.88 1.00     5300     2998
 dS1mHat[1]    0.17   0.17 0.12 0.12 -0.03  0.36 1.00     4231     3375
 dS1mHat[2]    0.12   0.11 0.07 0.07  0.00  0.24 1.00     2482     2783
 ddS1Hat[1]    0.28   0.28 0.08 0.08  0.15  0.41 1.00     6200     3217
 ddS1Hat[2]   -0.67  -0.67 0.05 0.06 -0.76 -0.58 1.00     6993     3444
 logS2mHat    -0.31  -0.31 0.01 0.01 -0.33 -0.28 1.02      432      986
 dlogS2Hat     0.42   0.42 0.01 0.01  0.41  0.43 1.01      552     1093
 beta[1]       0.84   0.84 0.04 0.04  0.77  0.91 1.00     7278     3170
 beta[2]       0.51   0.51 0.05 0.05  0.43  0.58 1.00     3976     2814
 dlogkTHat    -0.09  -0.09 0.00 0.00 -0.09 -0.08 1.00     4047     2966
 apH[1]       -0.03  -0.03 0.00 0.00 -0.03 -0.03 1.00     4583     3724
 apH[2]        0.08   0.08 0.00 0.00  0.08  0.08 1.00     3114     3288
 omega[1]      0.92   0.92 0.06 0.06  0.83  1.02 1.00     5132     2669
 omega[2]      0.93   0.93 0.06 0.06  0.84  1.03 1.00     4993     3096
 omega[3]      0.55   0.55 0.03 0.03  0.50  0.61 1.00     8536     3214
 omegaT        0.03   0.03 0.00 0.00  0.03  0.04 1.00     7750     3273
 kappa[1]      0.59   0.58 0.03 0.03  0.53  0.65 1.00     4404     3301
 kappa[2]      0.69   0.69 0.05 0.05  0.62  0.77 1.00     3416     3502
 kappa[3]      0.55   0.55 0.04 0.04  0.49  0.61 1.00     3604     3242
 rho[2,1]      0.87   0.87 0.02 0.02  0.83  0.91 1.00     3500     3223
 msigma        0.39   0.39 0.03 0.03  0.35  0.44 1.00     9144     3009
 ssigma        0.81   0.81 0.05 0.05  0.74  0.90 1.00    12125     2859</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>     variable  mean median   sd  mad    q5   q95 rhat ess_bulk ess_tail
 alphamHat[1]  2.22   2.22 0.15 0.15  1.96  2.47 1.00     1721     2559
 alphamHat[2] -1.35  -1.35 0.10 0.10 -1.51 -1.18 1.01     1282     2346
 dalphaHat[1]  0.22   0.22 0.10 0.10  0.06  0.38 1.00     2171     2544
 dalphaHat[2] -0.20  -0.20 0.07 0.07 -0.32 -0.08 1.01     1514     2412
 tau[1]        0.88   0.88 0.05 0.05  0.81  0.97 1.00     6372     3337
 tau[2]        0.96   0.96 0.06 0.06  0.87  1.06 1.00     2193     2683
 tau[3]        0.79   0.79 0.05 0.05  0.71  0.88 1.00     1967     2870</code></pre>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>        variable  mean median   sd  mad    q5   q95 rhat ess_bulk ess_tail
 clogkwHat[1]     0.43   0.43 0.01 0.01  0.41  0.45 1.01      554     1048
 clogkwHat[2]     0.18   0.18 0.01 0.01  0.16  0.21 1.01      734     1437
 clogkwHat[3]     0.11   0.11 0.01 0.01  0.09  0.13 1.01      612     1192
 clogkwHat[4]     0.18   0.18 0.01 0.01  0.16  0.19 1.01      726     1350
 cS1mHat[1]       0.59   0.59 0.02 0.02  0.56  0.62 1.00     2127     2781
 cS1mHat[2]      -0.10  -0.10 0.02 0.02 -0.14 -0.06 1.00     2010     2704
 cS1mHat[3]       0.37   0.37 0.02 0.02  0.34  0.40 1.00     1308     3004
 cS1mHat[4]       0.50   0.50 0.02 0.02  0.47  0.52 1.00     1837     3007
 cdS1Hat[1]       0.15   0.15 0.01 0.01  0.13  0.17 1.01      928     1643
 cdS1Hat[2]       0.81   0.81 0.03 0.02  0.77  0.85 1.01      379      872
 cdS1Hat[3]       0.51   0.51 0.04 0.04  0.44  0.58 1.05      153      462
 cdS1Hat[4]       0.04   0.04 0.02 0.02  0.01  0.06 1.00      607     1094
 cdlogkwHat[1,1]  0.04   0.04 0.02 0.02  0.02  0.07 1.00     2224     2870
 cdlogkwHat[2,1] -0.05  -0.05 0.02 0.02 -0.08 -0.02 1.00     1549     2160
 cdlogkwHat[3,1] -0.03  -0.03 0.02 0.02 -0.06  0.00 1.00     1668     2740
 cdlogkwHat[4,1]  0.04   0.04 0.02 0.02  0.02  0.07 1.00     1319     2124
 cdlogkwHat[1,2]  0.00   0.00 0.01 0.01 -0.02  0.02 1.00     1667     2364
 cdlogkwHat[2,2] -0.04  -0.04 0.02 0.02 -0.07 -0.01 1.01     1538     2256
 cdlogkwHat[3,2] -0.06  -0.06 0.01 0.01 -0.08 -0.04 1.01     1175     1869
 cdlogkwHat[4,2] -0.03  -0.03 0.01 0.01 -0.05 -0.01 1.00     1137     2304
 cdS1mHat[1,1]   -0.01  -0.01 0.04 0.04 -0.09  0.06 1.00     3059     3209
 cdS1mHat[2,1]   -0.19  -0.19 0.06 0.06 -0.29 -0.10 1.00     2963     2774
 cdS1mHat[3,1]   -0.49  -0.49 0.05 0.05 -0.56 -0.41 1.00     2231     2921
 cdS1mHat[4,1]   -0.23  -0.23 0.04 0.04 -0.30 -0.16 1.00     2450     3229
 cdS1mHat[1,2]    0.36   0.36 0.03 0.03  0.31  0.41 1.00     2707     3167
 cdS1mHat[2,2]   -0.41  -0.41 0.04 0.04 -0.47 -0.35 1.00     2232     3005
 cdS1mHat[3,2]   -0.09  -0.09 0.03 0.03 -0.14 -0.04 1.00     1905     2758
 cdS1mHat[4,2]    0.29   0.29 0.03 0.03  0.24  0.34 1.00     2106     2691
 cddS1Hat[1,1]    0.05   0.05 0.03 0.03  0.01  0.09 1.00     4704     3379
 cddS1Hat[2,1]    0.13   0.13 0.05 0.05  0.06  0.21 1.00     2515     2663
 cddS1Hat[3,1]    0.46   0.46 0.09 0.09  0.32  0.61 1.00      847     1433
 cddS1Hat[4,1]    0.00   0.00 0.02 0.02 -0.04  0.04 1.00     4056     3302
 cddS1Hat[1,2]    0.17   0.17 0.02 0.02  0.14  0.19 1.00     2144     3206
 cddS1Hat[2,2]    0.57   0.57 0.03 0.03  0.52  0.62 1.00     1653     2285
 cddS1Hat[3,2]    0.50   0.51 0.06 0.06  0.41  0.60 1.03      359      938
 cddS1Hat[4,2]   -0.04  -0.04 0.02 0.01 -0.06 -0.01 1.00     3877     3310
 cbeta[1,1]       0.00   0.00 0.01 0.01 -0.01  0.01 1.01      886     1478
 cbeta[2,1]      -0.02  -0.02 0.01 0.01 -0.03  0.00 1.01     1160     1953
 cbeta[3,1]      -0.03  -0.03 0.01 0.01 -0.04 -0.02 1.01      945     1688
 cbeta[4,1]      -0.02  -0.02 0.01 0.01 -0.03 -0.01 1.01     1001     1807
 cbeta[1,2]      -0.07  -0.07 0.01 0.01 -0.09 -0.05 1.00     2265     2809
 cbeta[2,2]       0.10   0.10 0.01 0.01  0.08  0.12 1.00     2647     2838
 cbeta[3,2]      -0.03  -0.03 0.01 0.01 -0.04 -0.01 1.00     2162     2837
 cbeta[4,2]      -0.02  -0.02 0.01 0.01 -0.03  0.00 1.00     2452     2849
 cdlogkTHat[1]   -0.01  -0.01 0.00 0.00 -0.01  0.00 1.00     3880     3363
 cdlogkTHat[2]   -0.02  -0.02 0.00 0.00 -0.02 -0.02 1.00     4513     3484
 cdlogkTHat[3]   -0.01  -0.01 0.00 0.00 -0.01  0.00 1.00     3368     3541
 cdlogkTHat[4]    0.00   0.00 0.00 0.00 -0.01  0.00 1.00     4096     3513
 capH[1,1]       -0.01  -0.01 0.00 0.00 -0.02 -0.01 1.00     4697     3790
 capH[2,1]       -0.02  -0.02 0.00 0.00 -0.02 -0.02 1.00     5050     3925
 capH[3,1]        0.00   0.00 0.00 0.00  0.00  0.01 1.00     4877     3408
 capH[4,1]       -0.02  -0.02 0.00 0.00 -0.02 -0.02 1.00     4981     3932
 capH[1,2]       -0.03  -0.03 0.00 0.00 -0.04 -0.03 1.00     3850     3894
 capH[2,2]       -0.04  -0.04 0.00 0.00 -0.05 -0.04 1.00     3629     3707
 capH[3,2]       -0.05  -0.05 0.00 0.00 -0.05 -0.05 1.00     3402     3568
 capH[4,2]       -0.01  -0.01 0.00 0.00 -0.02 -0.01 1.00     3709     3544
 comega[1,1]      0.12   0.12 0.01 0.01  0.10  0.13 1.01      862     1591
 comega[2,1]      0.13   0.13 0.01 0.01  0.12  0.15 1.00     1315     2135
 comega[3,1]      0.12   0.12 0.01 0.01  0.11  0.13 1.00     1157     2056
 comega[4,1]      0.10   0.10 0.01 0.01  0.09  0.11 1.00     1212     1998
 comega[1,2]      0.06   0.06 0.02 0.02  0.02  0.09 1.03      315      289
 comega[2,2]      0.15   0.15 0.02 0.02  0.12  0.18 1.00     2256     2851
 comega[3,2]      0.05   0.05 0.01 0.01  0.03  0.07 1.01      426      343
 comega[4,2]      0.02   0.02 0.01 0.01  0.00  0.04 1.00      760     1516
 comega[1,3]      0.14   0.14 0.01 0.01  0.13  0.16 1.01     1387     2315
 comega[2,3]      0.29   0.29 0.02 0.02  0.26  0.32 1.00      864     1617
 comega[3,3]      0.47   0.47 0.03 0.03  0.42  0.52 1.02      701     1289
 comega[4,3]      0.16   0.16 0.01 0.01  0.15  0.19 1.00     1393     1907
 ckappa[1,1]      0.07   0.07 0.01 0.01  0.06  0.08 1.00     1256     2247
 ckappa[2,1]      0.11   0.11 0.01 0.01  0.10  0.13 1.00     1718     2961
 ckappa[3,1]      0.08   0.08 0.01 0.01  0.07  0.09 1.01     1764     2733
 ckappa[4,1]      0.08   0.08 0.01 0.01  0.07  0.09 1.00     1491     2505
 ckappa[1,2]      0.07   0.07 0.03 0.04  0.02  0.13 1.01      417      852
 ckappa[2,2]      0.20   0.20 0.03 0.03  0.15  0.25 1.00     1664     2343
 ckappa[3,2]      0.11   0.11 0.03 0.03  0.06  0.15 1.01      862      830
 ckappa[4,2]      0.04   0.03 0.02 0.03  0.00  0.08 1.03      479     1426
 ckappa[1,3]      0.07   0.07 0.02 0.02  0.04  0.11 1.00      865     1522
 ckappa[2,3]      0.27   0.27 0.02 0.02  0.24  0.31 1.00     1741     2782
 ckappa[3,3]      0.72   0.72 0.04 0.04  0.65  0.78 1.01     1281     2450
 ckappa[4,3]      0.09   0.09 0.02 0.02  0.06  0.11 1.01      745      676
 comegaT[1]       0.00   0.00 0.00 0.00  0.00  0.00 1.00     1656     2300
 comegaT[2]       0.01   0.01 0.00 0.00  0.01  0.01 1.00     2194     2711
 comegaT[3]       0.00   0.00 0.00 0.00  0.00  0.00 1.01     1408     2289
 comegaT[4]       0.00   0.00 0.00 0.00  0.00  0.00 1.00     2595     2298
 crho[1,1]        1.00   1.00 0.00 0.00  1.00  1.00   NA       NA       NA
 crho[2,1]        0.57   0.57 0.07 0.07  0.44  0.68 1.00     1083     1700
 crho[3,1]        0.78   0.78 0.04 0.04  0.71  0.84 1.01     1015     1731
 crho[4,1]        0.72   0.72 0.05 0.05  0.64  0.79 1.00     1300     2030
 crho[1,2]        0.57   0.57 0.07 0.07  0.44  0.68 1.00     1083     1700
 crho[2,2]        1.00   1.00 0.00 0.00  1.00  1.00   NA       NA       NA
 crho[3,2]        0.55   0.55 0.07 0.07  0.42  0.67 1.00     1242     1933
 crho[4,2]        0.55   0.56 0.07 0.07  0.43  0.66 1.00     1383     2292
 crho[1,3]        0.78   0.78 0.04 0.04  0.71  0.84 1.01     1015     1731
 crho[2,3]        0.55   0.55 0.07 0.07  0.42  0.67 1.00     1242     1933
 crho[3,3]        1.00   1.00 0.00 0.00  1.00  1.00   NA       NA       NA
 crho[4,3]        0.92   0.92 0.02 0.02  0.89  0.94 1.00     1324     2429
 crho[1,4]        0.72   0.72 0.05 0.05  0.64  0.79 1.00     1300     2030
 crho[2,4]        0.55   0.56 0.07 0.07  0.43  0.66 1.00     1383     2292
 crho[3,4]        0.92   0.92 0.02 0.02  0.89  0.94 1.00     1324     2429
 crho[4,4]        1.00   1.00 0.00 0.00  1.00  1.00   NA       NA       NA
 clogmsigma[1]    0.20   0.20 0.02 0.02  0.17  0.22 1.00     2901     3087
 clogmsigma[2]   -0.01  -0.01 0.02 0.02 -0.05  0.02 1.00     3536     3376
 clogmsigma[3]   -0.26  -0.26 0.02 0.02 -0.29 -0.22 1.00     3010     3356
 clogmsigma[4]   -0.10  -0.10 0.02 0.02 -0.13 -0.07 1.00     3325     3444
 cssigma[1]       0.07   0.07 0.03 0.03  0.02  0.11 1.01      574     1063
 cssigma[2]       0.17   0.17 0.02 0.02  0.14  0.20 1.00     1761     2633
 cssigma[3]       0.16   0.16 0.02 0.02  0.13  0.19 1.00     1919     2850
 cssigma[4]       0.08   0.08 0.03 0.02  0.03  0.12 1.01      560      769</code></pre>
</div>
</div>
</div>
<p>The summary can also be extracted for individual parameters. Here presented for analyte 9 (Baclofen)</p>
<div id="tbl-isummary" class="cell tbl-parent quarto-layout-panel anchored" data-hash="index_cache/html/tbl-isummary_598288d9c29403574491f5caa1c6fbf2">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output cell-output-stdout quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">
<pre><code>      variable  mean median   sd  mad    q5   q95 rhat ess_bulk ess_tail
 logkwx[3,1,1]  1.33   1.33 0.03 0.03  1.28  1.38 1.00     6062     3190
 logkwx[3,1,2]  0.68   0.68 0.07 0.07  0.58  0.79 1.00     5550     3342
 logkwx[3,1,3]  0.68   0.68 0.07 0.07  0.58  0.79 1.00     5550     3342
 logkwx[3,2,1]  1.64   1.64 0.04 0.04  1.58  1.70 1.00     6117     3234
 logkwx[3,2,2]  1.04   1.04 0.06 0.06  0.94  1.14 1.00     6694     3794
 logkwx[3,2,3]  1.04   1.04 0.06 0.06  0.94  1.14 1.00     6694     3794
 S1x[3,1,1,1]   3.78   3.79 0.31 0.31  3.28  4.28 1.00     5248     2966
 S1x[3,1,1,2]   4.74   4.72 0.71 0.71  3.59  5.95 1.00     6928     3011
 S1x[3,1,1,3]   4.74   4.72 0.71 0.71  3.59  5.95 1.00     6928     3011
 S1x[3,2,1,1]   3.35   3.35 0.26 0.27  2.92  3.78 1.00     5914     3292
 S1x[3,2,1,2]   5.74   5.74 0.63 0.63  4.73  6.78 1.00     6900     3283
 S1x[3,2,1,3]   5.74   5.74 0.63 0.63  4.73  6.78 1.00     6900     3283
 S1x[3,1,2,1]   4.53   4.53 0.31 0.32  4.02  5.03 1.00     5363     3001
 S1x[3,1,2,2]   5.48   5.46 0.72 0.71  4.30  6.69 1.00     7097     3287
 S1x[3,1,2,3]   5.48   5.46 0.72 0.71  4.30  6.69 1.00     7097     3287
 S1x[3,2,2,1]   4.20   4.20 0.27 0.28  3.76  4.62 1.00     5462     3331
 S1x[3,2,2,2]   6.62   6.62 0.64 0.64  5.58  7.68 1.00     6955     3383
 S1x[3,2,2,3]   6.62   6.62 0.64 0.64  5.58  7.68 1.00     6955     3383
 apHx[3,1,1]    0.00   0.00 0.00 0.00  0.00  0.00   NA       NA       NA
 apHx[3,1,2]   -0.03  -0.03 0.00 0.00 -0.03 -0.03 1.00     4583     3724
 apHx[3,1,3]   -0.03  -0.03 0.00 0.00 -0.03 -0.03 1.00     4583     3724
 pKawx[3,1]     6.74   6.74 0.08 0.08  6.61  6.86 1.00     8439     3301
 pKawx[3,2]     0.00   0.00 0.00 0.00  0.00  0.00   NA       NA       NA
 alphax[3,1,1]  2.14   2.14 0.90 0.90  0.67  3.64 1.00     8395     3357
 alphax[3,1,2]  0.00   0.00 0.00 0.00  0.00  0.00   NA       NA       NA
 alphax[3,2,1]  2.49   2.47 1.14 1.11  0.59  4.39 1.00     7846     3292
 alphax[3,2,2]  0.00   0.00 0.00 0.00  0.00  0.00   NA       NA       NA
 S2x[1,1]       0.49   0.49 0.02 0.02  0.47  0.52 1.02      432      986
 S2x[2,1]       1.30   1.30 0.03 0.03  1.26  1.34 1.02      355      754
 sigmax[3,1]    0.39   0.39 0.03 0.03  0.34  0.45 1.00     4626     3538
 sigmax[3,2]    0.45   0.45 0.04 0.04  0.38  0.52 1.00     2663     3556</code></pre>
</div>
</div>
</div>
</section>
<section id="trace-plots" class="level2">
<h2 class="anchored" data-anchor-id="trace-plots">Trace plots</h2>
<p>Several trace plots are shown.</p>
<div class="cell" data-hash="index_cache/html/traceplots_4779b29ad95cfa1d60bbfa586580e930">
<div class="cell-output-display">
<p><img src="index_files/figure-html/traceplots-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="summary-of-model-parameters-figures" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-model-parameters-figures">Summary of model parameters (figures)</h2>
<p>First plot presents parameter specific for XBridge Shield RP18 column and parameters common for all the columns:</p>
<div class="cell" data-hash="index_cache/html/fig-summary_df2d89d11e418b08998e1beab7e5d219">
<div class="cell-output-display">
<div id="fig-summary-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-summary-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;1: <strong>?(caption)</strong></figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-summary-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-summary-2.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2: <strong>?(caption)</strong></figcaption>
</figure>
</div>
</div>
</div>
<p>Column effects relative to XBridge Shield RP18 column:</p>
<div class="cell" data-hash="index_cache/html/columneffects1_292e66159789b60bbedc9df77a7a6baa">
<div class="cell-output-display">
<p><img src="index_files/figure-html/columneffects1-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<div class="cell" data-hash="index_cache/html/columneffects2_c3d64da8bec7124ef8a9ac069f2bfb72">
<div class="cell-output-display">
<p><img src="index_files/figure-html/columneffects2-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>Parameters characterizing columns:</p>
<div class="cell" data-hash="index_cache/html/fig-column-effects-all_06b3cfc8fe367c56f3dfbc278a5a5c56">
<div class="cell-output-display">
<div id="fig-column-effects-all" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="index_files/figure-html/fig-column-effects-all-1.png" class="img-fluid figure-img" style="width:95.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3: <strong>?(caption)</strong></figcaption>
</figure>
</div>
</div>
</div>
<p>Parameters characterizing columns:</p>
<div class="cell" data-hash="index_cache/html/column-parameters-all_5e712c6f1a899ea6140f4a166584cc3e">
<div class="cell-output-display">
<p><img src="index_files/figure-html/column-parameters-all-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>Standard deviations:</p>
<div class="cell" data-hash="index_cache/html/sd-column-effects-all_3e96fa1e5a76cbe9a706ddf9031df2ff">
<div class="cell-output-display">
<p><img src="index_files/figure-html/sd-column-effects-all-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/sd-column-effects-all-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="isocratic-predictions" class="level2">
<h2 class="anchored" data-anchor-id="isocratic-predictions">Isocratic predictions</h2>
<p>To better asses the impact of parameters on retention we created graphs presenting the isocratic logarithm of retention factor vs.&nbsp;<span class="math inline">\(\varphi\)</span> for selected analytes. Separate graphs are shown for each dissociation form (r=1,r=2,r=3). Here the individual predictions (given all the data) are shown:</p>
<div class="cell" data-hash="index_cache/html/izo-pred-individual_9082e7f3fedab2bd20e5536809eb793d">
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-individual-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-individual-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-individual-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-individual-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-individual-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-individual-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>Similarly we can quantify the column effects (between column differences in logk using XBridge Shield RP18 as a reference column):</p>
<div class="cell" data-hash="index_cache/html/izo-diff-individual_0576839ef6ec890e024b9f3582f3b75c">
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-individual-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-individual-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-individual-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-individual-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-individual-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-individual-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>or predict the organic modifier content leading to logk of 1:</p>
<div class="cell" data-hash="index_cache/html/izo-logk1-individual_f3524212385ad6f9a2138a43e3c4868a">
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-individual-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-individual-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-individual-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-individual-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-individual-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-individual-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="individual-parameters" class="level2">
<h2 class="anchored" data-anchor-id="individual-parameters">Individual Parameters</h2>
<p>Individual parameter are the analyte-specific parameters estimated by the model. The following plots allow to assess the correlations between these parameters.</p>
<section id="neutral-form" class="level3">
<h3 class="anchored" data-anchor-id="neutral-form">Neutral Form</h3>
<p>Individual parameters for the reference column (XBridge Shield RP18):</p>
<div class="cell" data-hash="index_cache/html/iparam-column-neutral_e357be3e0805c3b70a04cc09cba8503c">
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-column-neutral-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>Individual parameters for column effects:</p>
<div class="cell" data-hash="index_cache/html/iparam-columneffects-neutral_a00dde24e3f58b602722f981e275aa7b">
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-columneffects-neutral-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-columneffects-neutral-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-columneffects-neutral-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="effects-of-dissociation" class="level3">
<h3 class="anchored" data-anchor-id="effects-of-dissociation">Effects of dissociation</h3>
<p>Individual parameters for the reference column (XBridge Shield RP18)</p>
<div class="cell" data-hash="index_cache/html/iparam-column-dissociated_485b0c785fbb23b35de49bd0013911d6">
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-column-dissociated-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>Individual parameters for the particular column (1-4) relative to XBridge Shield RP18</p>
<div class="cell" data-hash="index_cache/html/iparam-columneffects-dissociated_5ac48a9fa11be67d42363813023fb705">
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-columneffects-dissociated-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-columneffects-dissociated-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-columneffects-dissociated-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="pka-related-paraemters" class="level3">
<h3 class="anchored" data-anchor-id="pka-related-paraemters">pKa-related paraemters</h3>
<div class="cell" data-hash="index_cache/html/iparam-pKas_fdf2492857725519d490e2cb95f10655">
<div class="cell-output-display">
<p><img src="index_files/figure-html/iparam-pKas-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
<section id="eta-plots" class="level2">
<h2 class="anchored" data-anchor-id="eta-plots">Eta plots</h2>
<p>Eta plots shows the centered and standardized individual parameters (e.g.&nbsp;<span class="math inline">\(\eta_{logkwN,i} = (logkwN_i-(\hat{logkwN} + \beta_1 \cdot \log P_i))/\omega_1\)</span>). They allow to visualize the unexplained between-analyte variability of chromatographic parameters.</p>
<section id="neutral-forms" class="level3">
<h3 class="anchored" data-anchor-id="neutral-forms">Neutral Forms</h3>
<div class="cell" data-hash="index_cache/html/etaplots-neutral_250725cc408e20025ae3d7c0a232b22e">
<div class="cell-output-display">
<p><img src="index_files/figure-html/etaplots-neutral-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/etaplots-neutral-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/etaplots-neutral-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="effect-of-dissociation" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-dissociation">Effect of dissociation</h3>
<div class="cell" data-hash="index_cache/html/etaplots-dissociated_499a40cd636c90960d259e2279bbac30">
<div class="cell-output-display">
<p><img src="index_files/figure-html/etaplots-dissociated-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/etaplots-dissociated-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/etaplots-dissociated-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="effect-of-functional-groups-exploratory" class="level3">
<h3 class="anchored" data-anchor-id="effect-of-functional-groups-exploratory">Effect of functional groups (exploratory)</h3>
<p>The following ETA plots present the relationship between individual eta values for logkwN and number of functional groups. This part is exploratory. Graphs are shown if there are at least 10 functional groups present in the dataset.</p>
<div class="cell" data-hash="index_cache/html/functionalgroupseffects_d79b194238f7d9ed5d5719601c7ab3bc">
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-7.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-8.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-9.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-10.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-11.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-12.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-13.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-14.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-15.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-16.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-17.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/functionalgroupseffects-18.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
</section>
<section id="comparison-of-observed-and-model-predicted-retention-times" class="level1">
<h1>Comparison of observed and model predicted retention times</h1>
<p>The individual and population model predictions were simulated using a more dense design. The individual predictions are based on population-level parameters, predictors, and all of the observed retention time measurements. The population predictions are based on population-level parameters and predictors.</p>
<section id="individual-predictions" class="level2">
<h2 class="anchored" data-anchor-id="individual-predictions">Individual predictions:</h2>
<div class="cell" data-hash="index_cache/html/individualpred_5fc00969527c4e9ad80d98a079022ea1">
<div class="cell-output-display">
<p><img src="index_files/figure-html/individualpred-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/individualpred-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/individualpred-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/individualpred-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/individualpred-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/individualpred-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="population-predictions" class="level2">
<h2 class="anchored" data-anchor-id="population-predictions">Population predictions:</h2>
<div class="cell" data-hash="index_cache/html/populationrped_885f3ad7819fd8f6da228237bd2aa944">
<div class="cell-output-display">
<p><img src="index_files/figure-html/populationrped-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/populationrped-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/populationrped-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/populationrped-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/populationrped-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/populationrped-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
<section id="uncertainity-chromatogram" class="level1">
<h1>Uncertainity chromatogram</h1>
<p>Below is the example of an uncertainty chromatogram expected for tg = 90 min, pH = 4.9, Temp = <span class="math inline">\(25^oC\)</span> in MeOH. The individual and population predictions are shown.</p>
<div class="cell" data-hash="index_cache/html/uncertainitychromatogram_14ce71673a3f693ae7d27dcefbb5e865">
<div class="cell-output-display">
<p><img src="index_files/figure-html/uncertainitychromatogram-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/uncertainitychromatogram-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<section id="isocratic-predictions-population-predictions" class="level2">
<h2 class="anchored" data-anchor-id="isocratic-predictions-population-predictions">Isocratic predictions (population predictions)</h2>
<p>To better asses the impact of parameters on retention we created graphs presenting the isocratic logarithm of retention factor vs.&nbsp;<span class="math inline">\(\small \varphi\)</span> for selected analytes. Separate graphs are shown for each dissociation form (r=1, r=2, r=3). Here the population predictions are shown:</p>
<div class="cell" data-hash="index_cache/html/izo-pred-population_38c7b793e5e768b1437394b5951c9cfd">
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-population-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-population-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-population-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-population-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-population-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-pred-population-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>Similarly we can quantify the column effects (between column differences in logk using XBridge Shield RP18 as a reference column):</p>
<div class="cell" data-hash="index_cache/html/izo-diff-population_db0b712ffa985ce178698a693fc5e054">
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-population-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-population-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-population-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-population-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-population-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-diff-population-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>or predict the organic modifier content leading to logk of 1:</p>
<div class="cell" data-hash="index_cache/html/izo-logk1-population_ec8bc044e1271a1824328c8b88b24b31">
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-population-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-population-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-population-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-population-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-population-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/izo-logk1-population-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
<section id="effect-of-logp" class="level1">
<h1>Effect of logP</h1>
<p>The following plot show the effect of log P on isocratic retention times (population predictions) for typical neutral, basic and acidic analyte. The uncertainties are large. They are not shown to improve visibility.</p>
<div class="cell" data-hash="index_cache/html/plot-logP-effects_c143a63d5a47da22ed1551fa1e38b862">
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot-logP-effects-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="goodness-of-fit-plots" class="level1">
<h1>Goodness of fit plots</h1>
<p>Several goodness of fit plots were used to describe how well the model fits our set of observations.</p>
<p>Residuals:</p>
<div class="cell" data-hash="index_cache/html/plot-residuals_bf2916fe0fb87d55b5668c333cb93ea0">
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot-residuals-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
<p>Observed vs.&nbsp;population and individual predictions:</p>
<div class="cell" data-hash="index_cache/html/plot-dv-vs-pred_a658fff6d0f398d6d2c5dc6ea717e6ce">
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot-dv-vs-pred-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/plot-dv-vs-pred-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
<section id="predictions-and-decision-making.-case-study-1" class="level1">
<h1>Predictions and decision making. Case Study 1</h1>
<p>Here we want to show applicability of the model to predicting the best chromatogram using all the available data.</p>
<section id="utility-maps" class="level2">
<h2 class="anchored" data-anchor-id="utility-maps">Utility maps</h2>
<p>Let’s find the best chromatogram that maximize utility using the set of experiments used to build the model.</p>
<p>The utility function is based on lowest retention time, highest retention time and the difference of retention times between the critical pair of analytes. This utility is zero if at least one of the analyte has retention higher that 40, less than 2 min or the difference in retention time is less than 2. Otherwise, it favors shorter runs. (.) denotes design variables.</p>
<p><span class="math display">\[
U(.)= I((mintr(.)&gt;2) \ \&amp; \ (res(.)&gt;2)) \cdot (40-maxtr(.)) \cdot I(maxtr(.)&lt;40)
\]</span></p>
<p><span class="math display">\[
I(x) = 1 \ if \ condition \ x  \ is \ true \\
I(x) = 0 \ if \ condition \ x  \ is \ false
\]</span></p>
<div class="cell" data-hash="index_cache/html/casestudy1-utylitymaps-alldata_59d38129d4157d470333fa35f477297c">
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy1-utylitymaps-alldata-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy1-utylitymaps-alldata-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy1-utylitymaps-alldata-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy1-utylitymaps-alldata-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy1-utylitymaps-alldata-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName          EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;                  &lt;dbl&gt;
1    60  0.05   0.8 ACN      10  5.50    25 XBridge Shield RP18     11.4</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName    EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt;
1    60  0.05   0.8 ACN      10  5.50    25 XTerra MS C18     9.50</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName     EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt;
1    40  0.15   0.8 MeOH     12  6.00    25 XBridge Phenyl     4.08</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt;
1    80  0.05   0.8 ACN       5  4.00    25 XBridge C8     7.73</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName   EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;
1    80   0.1   0.8 ACN       5  4.00    25 Xterra MS C8     13.7</code></pre>
</div>
</div>
<section id="uncertainity-chromatogram-1" class="level3">
<h3 class="anchored" data-anchor-id="uncertainity-chromatogram-1">Uncertainity chromatogram</h3>
<p>Let’s visualize chromatograms with the highest expected utility</p>
<div class="cell" data-hash="index_cache/html/casestudy1-uncertainity-chrom_41ebdcd09ebf7b65102a4a9e2df12f3b">
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy1-uncertainity-chrom-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
</section>
<section id="predictions-and-decision-making.-case-2" class="level1">
<h1>Predictions and decision making. Case 2</h1>
<p>The proposed model can be used for decision making having access to limiet data. Here we want to ilustrate this by predicting XTerra MS C18, XBridge Phenyl, XBridge C8, Xterra MS C8 retention times based on XBridge Shield RP18 data.</p>
<section id="summary-of-individual-parameters" class="level2">
<h2 class="anchored" data-anchor-id="summary-of-individual-parameters">Summary of individual parameters</h2>
<p>Here shown for analyte 9 (Baclofen)</p>
<div class="cell" data-hash="index_cache/html/casestudy2-summary_f1b4f90f1c15e25c07daf403759a69df">
<div class="cell-output cell-output-stdout">
<pre><code>      variable  mean median   sd  mad    q5   q95 rhat ess_bulk ess_tail
 logkwx[3,1,1]  1.84   1.84 0.92 0.92  0.39  3.40 1.00     1704     1267
 logkwx[3,1,2]  1.05   1.04 1.11 1.12 -0.75  2.93 1.00     2005     1563
 logkwx[3,1,3]  1.05   1.04 1.11 1.12 -0.75  2.93 1.00     2005     1563
 logkwx[3,2,1]  2.27   2.25 0.92 0.92  0.77  3.80 1.00     1710     1359
 logkwx[3,2,2]  1.53   1.52 1.12 1.14 -0.30  3.42 1.00     2020     1416
 logkwx[3,2,3]  1.53   1.52 1.12 1.14 -0.30  3.42 1.00     2020     1416
 S1x[3,1,1,1]   3.87   3.88 0.95 0.93  2.27  5.45 1.00     1679     1326
 S1x[3,1,1,2]   4.08   4.05 1.17 1.16  2.18  5.96 1.00     1965     1502
 S1x[3,1,1,3]   4.08   4.05 1.17 1.16  2.18  5.96 1.00     1965     1502
 S1x[3,2,1,1]   4.49   4.50 1.09 1.06  2.66  6.34 1.00     1912     1237
 S1x[3,2,1,2]   4.99   5.00 1.39 1.46  2.78  7.28 1.01     2269     1256
 S1x[3,2,1,3]   4.99   5.00 1.39 1.46  2.78  7.28 1.01     2269     1256
 S1x[3,1,2,1]   4.61   4.62 0.95 0.94  3.03  6.22 1.00     1664     1326
 S1x[3,1,2,2]   4.80   4.77 1.18 1.15  2.88  6.71 1.00     1968     1479
 S1x[3,1,2,3]   4.80   4.77 1.18 1.15  2.88  6.71 1.00     1968     1479
 S1x[3,2,2,1]   5.38   5.41 1.10 1.06  3.57  7.22 1.00     1823     1305
 S1x[3,2,2,2]   5.91   5.91 1.41 1.47  3.67  8.20 1.01     2234     1194
 S1x[3,2,2,3]   5.91   5.91 1.41 1.47  3.67  8.20 1.01     2234     1194
 apHx[3,1,1]    0.00   0.00 0.00 0.00  0.00  0.00   NA       NA       NA
 apHx[3,1,2]   -0.03  -0.03 0.00 0.00 -0.03 -0.03 1.00     1913     1394
 apHx[3,1,3]   -0.03  -0.03 0.00 0.00 -0.03 -0.03 1.00     1913     1394
 pKawx[3,1]     7.35   7.35 0.84 0.84  5.95  8.74 1.00     3737     1279
 pKawx[3,2]     0.00   0.00 0.00 0.00  0.00  0.00   NA       NA       NA
 alphax[3,1,1]  2.19   2.19 0.96 0.95  0.60  3.74 1.00     4654     1273
 alphax[3,1,2]  0.00   0.00 0.00 0.00  0.00  0.00   NA       NA       NA
 alphax[3,2,1]  2.39   2.39 1.29 1.31  0.25  4.54 1.00     4518     1318
 alphax[3,2,2]  0.00   0.00 0.00 0.00  0.00  0.00   NA       NA       NA
 S2x[1,1]       0.47   0.47 0.02 0.02  0.44  0.50 1.00      893     1183
 S2x[2,1]       1.20   1.20 0.04 0.04  1.13  1.27 1.00      670     1346
 sigmax[3,1]    0.54   0.39 0.54 0.29  0.10  1.45 1.00     3967     1379
 sigmax[3,2]    0.66   0.46 0.65 0.35  0.12  1.76 1.00     3947     1422</code></pre>
</div>
</div>
</section>
<section id="predicted-retention-times" class="level2">
<h2 class="anchored" data-anchor-id="predicted-retention-times">Predicted retention times</h2>
<section id="plot-the-predicted-vs.-observed" class="level3">
<h3 class="anchored" data-anchor-id="plot-the-predicted-vs.-observed">Plot the predicted vs.&nbsp;observed:</h3>
<div class="cell" data-hash="index_cache/html/casestudy2-pred_84e19c8fec8a20bf2ff03c0fba6b5a57">
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-pred-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-pred-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-pred-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-pred-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-pred-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-pred-6.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
<section id="decision-making" class="level2">
<h2 class="anchored" data-anchor-id="decision-making">Decision making</h2>
<p>The same utility function was used:</p>
<div class="cell" data-hash="index_cache/html/casestudy2-utylitymaps_ca69e9bc4d80ddad96e583a88fb22326">
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-utylitymaps-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-utylitymaps-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-utylitymaps-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>1. The best choice for XBridge Shield RP18</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>    tg  fio fik Mod pH     pHo Temp          ColumnName EUtility
158 90 0.05 0.8 ACN  7 8.87588   25 XBridge Shield RP18 1.629025</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>2. The best choice for XTerra MS C18</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      tg  fio fik Mod pH      pHo Temp    ColumnName EUtility
15404 90 0.05 0.8 ACN  3 4.202902   35 XTerra MS C18 1.347357</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>3. The best choice for XBridge Phenyl</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      tg  fio fik Mod pH      pHo Temp     ColumnName EUtility
30632 90 0.05 0.8 ACN  3 4.202902   35 XBridge Phenyl  1.66615</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>4. The best choice for XBridge C8</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      tg  fio fik Mod pH      pHo Temp ColumnName EUtility
45860 90 0.05 0.8 ACN  3 4.202902   35 XBridge C8 1.669043</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>5. The best choice for Xterra MS C8</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      tg  fio fik Mod pH      pHo Temp   ColumnName EUtility
61088 90 0.05 0.8 ACN  3 4.202902   35 Xterra MS C8 1.561612</code></pre>
</div>
</div>
<section id="uncertainity-chromatogram-2" class="level3">
<h3 class="anchored" data-anchor-id="uncertainity-chromatogram-2">Uncertainity chromatogram</h3>
<p>Below is the example of a chromatogram (along with uncertainty) expected for tg = 90 min, pH = 8.9, Temp = 25oC in ACN.</p>
<div class="cell" data-hash="index_cache/html/casestudy2-uncertainity-chrom_b6d6679b4057b6f489379159e544e75f">
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-uncertainity-chrom-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
<section id="utility-maps-1" class="level2">
<h2 class="anchored" data-anchor-id="utility-maps-1">Utility maps</h2>
<p>We can also determine more detailed graph presenting relationship between the expected utility and design variables:</p>
<p>The best chromatogram can be sought based on utility map:</p>
<div class="cell" data-hash="index_cache/html/casestudy2-utylitymaps-danse_632cbd8314e6ea9916400bccf01c10b0">
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-utylitymaps-danse-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-utylitymaps-danse-2.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-utylitymaps-danse-3.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-utylitymaps-danse-4.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-utylitymaps-danse-5.png" class="img-fluid" style="width:95.0%"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName          EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;                  &lt;dbl&gt;
1    60  0.05   0.8 ACN      10  5.50    25 XBridge Shield RP18     10.1</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName    EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;            &lt;dbl&gt;
1    80   0.1   0.8 ACN       5  4.00    25 XTerra MS C18     2.64</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName     EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt;
1   100   0.1   0.8 ACN       5  4.00    25 XBridge Phenyl     2.06</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;         &lt;dbl&gt;
1    80  0.05   0.8 ACN       6  4.17    25 XBridge C8     1.86</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
     tg   fio   fik Mod    pHid   pHo  Temp ColumnName   EUtility
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;int&gt; &lt;chr&gt;           &lt;dbl&gt;
1   100   0.1   0.8 ACN       6  4.17    25 Xterra MS C8     2.39</code></pre>
</div>
</div>
<section id="uncertainity-chromatogram-3" class="level3">
<h3 class="anchored" data-anchor-id="uncertainity-chromatogram-3">Uncertainity chromatogram</h3>
<p>Let’s visualize chromatograms with the highest expected utility given the experimental data.</p>
<div class="cell" data-hash="index_cache/html/casestudy2-chromatogram-dense_36e55da2cbbeff2aa818e61682578165">
<div class="cell-output-display">
<p><img src="index_files/figure-html/casestudy2-chromatogram-dense-1.png" class="img-fluid" style="width:95.0%"></p>
</div>
</div>
</section>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>The large gradient retention time data and multilevel modeling allow to characterize separation of RP HPLC stationary phases.</p>
</section>
<section id="references" class="level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-kamedulska_toward_2022" class="csl-entry" role="listitem">
Kamedulska, Agnieszka, Łukasz Kubik, Julia Jacyna, Wiktoria Struck-Lewicka, Michał J. Markuszewski, and Paweł Wiczling. 2022. <span>“Toward the General Mechanistic Model of Liquid Chromatographic Retention.”</span> <em>Analytical Chemistry</em> 94 (31): 11070–80. <a href="https://doi.org/10.1021/acs.analchem.2c02034">https://doi.org/10.1021/acs.analchem.2c02034</a>.
</div>
<div id="ref-kamedulska_statistical_2022" class="csl-entry" role="listitem">
Kamedulska, Agnieszka, Łukasz Kubik, and Paweł Wiczling. 2022. <span>“Statistical Analysis of Isocratic Chromatographic Data Using Bayesian Modeling.”</span> <em>Analytical and Bioanalytical Chemistry</em> 414 (11): 3471–3348. <a href="https://doi.org/10.1007/s00216-022-03968-x">https://doi.org/10.1007/s00216-022-03968-x</a>.
</div>
<div id="ref-kubik_XBridgeC18_2022" class="csl-entry" role="listitem">
Kubik, Łukasz, Julia Jacyna, Wiktoria Struck-Lewicka, Michał J. Markuszewski, and Paweł Wiczling. 2022a. <span>“LC-TOF-MS Data Collected for 300 Small Molecules. XBridge Shield RP18 Column.”</span> <em>Osf.io/</em> 1 (1): 1. <a href="https://doi.org/10.17605/OSF.IO/ZQTJ7">https://doi.org/10.17605/OSF.IO/ZQTJ7</a>.
</div>
<div id="ref-kubik_XBridgeC8_2022" class="csl-entry" role="listitem">
———. 2022b. <span>“LC-TOF-MS Data Collected for 300 Small Molecules. XBridge-C8 Column.”</span> <em>Osf.io/</em> 1 (1): 1. <a href="https://doi.org/10.17605/OSF.IO/Y6S8P">https://doi.org/10.17605/OSF.IO/Y6S8P</a>.
</div>
<div id="ref-kubik_XterraC18_2022" class="csl-entry" role="listitem">
———. 2022c. <span>“LC-TOF-MS Data Collected for 300 Small Molecules. XTerra MS C18 Column.”</span> <em>Osf.io/</em> 1 (1): 1. <a href="https://doi.org/10.17605/OSF.IO/QBV7J">https://doi.org/10.17605/OSF.IO/QBV7J</a>.
</div>
<div id="ref-kubik_XTerraC8_2022" class="csl-entry" role="listitem">
———. 2022d. <span>“LC-TOF-MS Data Collected for 300 Small Molecules. XTerra-C8 Column.”</span> <em>Osf.io/</em> 1 (1): 1. <a href="https://doi.org/10.17605/OSF.IO/2MCNW">https://doi.org/10.17605/OSF.IO/2MCNW</a>.
</div>
<div id="ref-kubik_XBridgePhenyl_2022" class="csl-entry" role="listitem">
———. 2022e. <span>“LC-TOF-MS Data Collected for 300 Small Molecules.XBridge Phenyl Column.”</span> <em>Osf.io/</em> 1 (1): 1. <a href="https://doi.org/10.17605/OSF.IO/EVUJ9">https://doi.org/10.17605/OSF.IO/EVUJ9</a>.
</div>
<div id="ref-kubik_analysis_2018" class="csl-entry" role="listitem">
Kubik, Łukasz, Roman Kaliszan, and Paweł Wiczling. 2018. <span>“Analysis of <span>Isocratic</span>-<span>Chromatographic</span>-<span>Retention</span> <span>Data</span> Using <span>Bayesian</span> <span>Multilevel</span> <span>Modeling</span>.”</span> <em>Analytical Chemistry</em> 90 (22): 13670–79. <a href="https://doi.org/10.1021/acs.analchem.8b04033">https://doi.org/10.1021/acs.analchem.8b04033</a>.
</div>
<div id="ref-nikitas_new_2002" class="csl-entry" role="listitem">
Nikitas, P., and A. Pappa-Louisi. 2002. <span>“New Equations Describing the Combined Effect of <span class="nocase">pH</span> and Organic Modifier Concentration on the Retention in Reversed-Phase Liquid Chromatography.”</span> <em>Journal of Chromatography. A</em> 971 (1-2): 47–60. <a href="https://doi.org/10.1016/s0021-9673(02)00965-2">https://doi.org/10.1016/s0021-9673(02)00965-2</a>.
</div>
<div id="ref-wiczling_application_2021" class="csl-entry" role="listitem">
Wiczling, Paweł, Agnieszka Kamedulska, and Łukasz Kubik. 2021. <span>“Application of Bayesian Multilevel Modeling in the Quantitative Structure–Retention Relationship Studies of Heterogeneous Compounds.”</span> <em>Analytical Chemistry</em> 93 (18): 6961–71. <a href="https://doi.org/10.1021/acs.analchem.0c05227">https://doi.org/10.1021/acs.analchem.0c05227</a>.
</div>
</div>
</section>
<section id="licenses" class="level1 unnumbered">
<h1 class="unnumbered">Licenses</h1>
<ul>
<li>Code &amp; copy; 2023, Paweł Wiczling, licensed under BSD-3.</li>
<li>Text &amp; copy; 2023, Paweł Wiczling, licensed under CC-BY-NC 4.0.</li>
</ul>
</section>
<section id="original-computing-environment" class="level1 unnumbered">
<h1 class="unnumbered">Original Computing Environment</h1>
<div class="cell" data-hash="index_cache/html/sessionInfo_c0717f1ae4b7237ad6f88bd33f4eca30">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.1.3 (2022-03-10)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 22621)

Matrix products: default

locale:
[1] LC_COLLATE=Polish_Poland.1250  LC_CTYPE=Polish_Poland.1250   
[3] LC_MONETARY=Polish_Poland.1250 LC_NUMERIC=C                  
[5] LC_TIME=Polish_Poland.1250    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] kableExtra_1.3.4 GGally_2.1.2     posterior_1.3.1  bayesplot_1.9.0 
 [5] reshape2_1.4.4   knitr_1.40       cmdstanr_0.5.3   gridExtra_2.3   
 [9] ggplot2_3.4.2    dplyr_1.1.2      pracma_2.3.8    

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.9           lattice_0.20-45      svglite_2.1.1       
 [4] tidyr_1.3.0          zoo_1.8-11           digest_0.6.29       
 [7] utf8_1.2.2           R6_2.5.1             plyr_1.8.7          
[10] ggridges_0.5.3       backports_1.4.1      coda_0.19-4         
[13] evaluate_0.16        httr_1.4.5           pillar_1.9.0        
[16] tidybayes_3.0.2      rlang_1.1.0          data.table_1.14.2   
[19] rstudioapi_0.14      checkmate_2.1.0      rmarkdown_2.16      
[22] textshaping_0.3.6    labeling_0.4.2       webshot_0.5.4       
[25] stringr_1.5.0        htmlwidgets_1.5.4    munsell_0.5.0       
[28] compiler_4.1.3       xfun_0.32            pkgconfig_2.0.3     
[31] systemfonts_1.0.4    htmltools_0.5.3      tidyselect_1.2.0    
[34] tibble_3.2.1         tensorA_0.36.2       arrayhelpers_1.1-0  
[37] matrixStats_0.62.0   codetools_0.2-18     reshape_0.8.9       
[40] fansi_1.0.3          viridisLite_0.4.1    withr_2.5.0         
[43] ggdist_3.2.0         grid_4.1.3           distributional_0.3.1
[46] jsonlite_1.8.4       gtable_0.3.1         lifecycle_1.0.3     
[49] magrittr_2.0.3       scales_1.2.1         cli_3.4.0           
[52] stringi_1.7.8        farver_2.1.1         xml2_1.3.3          
[55] ragg_1.2.5           generics_0.1.3       vctrs_0.6.2         
[58] RColorBrewer_1.1-3   tools_4.1.3          svUnit_1.0.6        
[61] glue_1.6.2           purrr_1.0.1          abind_1.4-5         
[64] fastmap_1.1.0        yaml_2.3.5           colorspace_2.0-3    
[67] isoband_0.2.5        rvest_1.0.3         </code></pre>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb28" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Comparison of chromatographic stationary phases using Bayesian-based multilevel modeling"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Paweł Wiczling, Agnieszka Kamedulska"</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="an">adress:</span><span class="co"> "Department of Biopharmaceutics and Pharmacodynamics, Medical University of Gdańsk, Gen. J. Hallera 107, 80-416 Gdańsk, Poland"</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date())`"</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">  pdf:</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">    colorlinks: true</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-width: 7</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-height: 7</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="html"}</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setuphtml, include=FALSE}</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">cache=</span><span class="cn">TRUE</span>, <span class="at">message=</span><span class="cn">FALSE</span>, <span class="at">error=</span><span class="cn">FALSE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">comment=</span><span class="cn">NA</span>, <span class="at">out.width=</span><span class="st">'95%'</span>)</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>::: {.content-visible when-format="pdf"}</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setuppdf, include=FALSE}</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">cache=</span><span class="cn">TRUE</span>, <span class="at">message=</span><span class="cn">FALSE</span>, <span class="at">error=</span><span class="cn">FALSE</span>, <span class="at">warning=</span><span class="cn">FALSE</span>, <span class="at">echo=</span><span class="cn">FALSE</span>, <span class="at">comment=</span><span class="cn">NA</span>, <span class="at">out.width=</span><span class="st">'95%'</span>)</span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>In this work we applied the previously developed Bayesian multilevel framework <span class="co">[</span><span class="ot">@kamedulska_toward_2022, @kamedulska_statistical_2022, @wiczling_application_2021, @kubik_analysis_2018</span><span class="co">]</span> to characterize chromatographic gradient retention time datasets collected using a multicomponent mixtures of analytes, five stationary phases, and a wide range of chromatographic conditions (pH, organic modifier, temperature, gradient program). Such datasets carry much information about chromatographic retention that, if extracted, can provide useful predictive information, i.e. a detailed multidimensional characterization of chromatographic stationary phases and ability to predict retention (along with uncertainty) based on various number of preliminary experiments (e.g. to predict retention time for a set of analytes given no, or several measurements collected using a different stationary phase).</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>In this case study, we compared five RP-HPLC stationary phases (XBridge Shield RP18, XTerra MS C18, XBridge Phenyl, XBridge C8, Xterra MS C8) based on LC-MS/TOF data.</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a><span class="fu"># Experimental design</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>The data was collected using a mixture of 300 analytes and 84 gradient liquid chromatography experiments for each column. The experiments differed in gradient duration (30, 90, and 270 min) and pH of the mobile phase (from 2.5 to 10.5). Experiments were conducted in MeOH or ACN as organic modifiers and at two temperatures ($\small 25^0C$ and $\small 35^0C$).</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>The molecular structure of the analytes was converted from SMILE format to MDL mol format using OpenBabel. The input molecules were then analyzed for the presence of approximately 204 functional groups and structural elements using Checkmol (version 0.5b N. Haider, University of Vienna, 2003-2018). Functional groups that were not present on any analyte and functional groups merging other simpler functional groups were excluded from the analysis. The lipophilicity (log P), dissociation constant (pKalit) were added to the dataset. They were calculated using ACD/Labs program based on the structures of analytes generated from smiles strings.</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setup</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>The packages we will use are listed below.</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(gridExtra)</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10271998</span>) </span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data</span></span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>Data can be accessed via github (data folder) or osf.io repositories <span class="co">[</span><span class="ot">@kubik_XBridgeC18_2022, @kubik_XterraC18_2022, @kubik_XTerraC8_2022, @kubik_XBridgePhenyl_2022, @kubik_XBridgeC8_2022</span><span class="co">]</span>.</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prepare the data</span></span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>We will begin with loading and merging all the required datasets:</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{r loaddata}</span></span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/1-X_Bridge_Shield_C18_5cm.csv'</span>)</span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/1-XTerra_MS_C18.csv'</span>)</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/1-X_Bridge_Phenyl.csv'</span>)</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>data4 <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/1-XBridge_C8.csv'</span>)</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>data5 <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/1-Xterra_C8.csv'</span>)</span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>dataNames <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/4-compounds-names.csv'</span>)</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>dataACD <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/2-ACD-pKas-logP.csv'</span>)</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a>dataACD<span class="sc">$</span>R <span class="ot">=</span> <span class="fu">rowSums</span>(dataACD[,<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>]<span class="sc">&lt;</span><span class="dv">14</span>) <span class="co"># No of dissociation steps</span></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a>functional_groups <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/6-checkmol-functional-groups.csv'</span>)</span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>functional_groups_names <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">'data/Legend-checkmol-functional-group-names.csv'</span>)</span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a><span class="co"># marge the data:</span></span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>data1[<span class="st">'Column'</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>data2[<span class="st">'Column'</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>data3[<span class="st">'Column'</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a>data4[<span class="st">'Column'</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a>data5[<span class="st">'Column'</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>data1[<span class="st">'ColumnName'</span>] <span class="ot">&lt;-</span> <span class="st">'XBridge Shield RP18'</span></span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>data2[<span class="st">'ColumnName'</span>] <span class="ot">&lt;-</span> <span class="st">'XTerra MS C18'</span></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>data3[<span class="st">'ColumnName'</span>] <span class="ot">&lt;-</span> <span class="st">'XBridge Phenyl'</span></span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>data4[<span class="st">'ColumnName'</span>] <span class="ot">&lt;-</span> <span class="st">'XBridge C8'</span></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>data5[<span class="st">'ColumnName'</span>] <span class="ot">&lt;-</span> <span class="st">'Xterra MS C8'</span></span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">rbind</span>(data1, data2, data3, data4, data5)</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Mod  <span class="ot">=</span> <span class="fu">as.character</span>(data<span class="sc">$</span>Mod)</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Mod2 <span class="ot">=</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>Mod<span class="sc">==</span><span class="st">"MeOH"</span>,<span class="dv">1</span>,<span class="dv">2</span>)   </span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span> </span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">select</span>(dataACD,METID,R))</span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(data1, data2, data3, data4, data5)</span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a>The data requires some cleaning:</span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>we remove measurements with low score, analytes with less than 42 measurements per column, analytes with less than 210 measurements out of total 420, and use only measurements with the highest score (if several are present)</span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cleaning1}</span></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data  <span class="sc">%&gt;%</span></span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(Score<span class="sc">&gt;</span><span class="dv">95</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(METID,EXPID,Column) <span class="sc">%&gt;%</span></span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which.max</span>(Score)) <span class="sc">%&gt;%</span></span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(METID,Column) <span class="sc">%&gt;%</span></span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(n<span class="sc">&gt;</span><span class="dv">42</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(METID) <span class="sc">%&gt;%</span></span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(nn<span class="sc">&gt;</span><span class="dv">210</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>n,<span class="sc">-</span>nn) <span class="sc">%&gt;%</span></span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>we remove some outlying measurements (mismatch between literature pKa and observed data)</span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cleaning2}</span></span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span>  </span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(METID<span class="sc">!=</span><span class="dv">72</span>) <span class="sc">%&gt;%</span>  <span class="co"># dilevalol is repeated in the dataset</span></span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="sc">!</span>(tg<span class="sc">==</span><span class="dv">270</span> <span class="sc">&amp;</span> Temp<span class="sc">==</span><span class="dv">25</span> <span class="sc">&amp;</span> Mod2<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> pH<span class="sc">==</span><span class="dv">5</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="sc">!</span>(tg<span class="sc">==</span><span class="dv">270</span> <span class="sc">&amp;</span> Temp<span class="sc">==</span><span class="dv">25</span> <span class="sc">&amp;</span> Mod2<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> pH<span class="sc">==</span><span class="dv">9</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(R<span class="sc">&lt;=</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>   <span class="fu">subset</span>(<span class="sc">!</span>(METID <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">91</span>,<span class="dv">154</span>,<span class="dv">204</span>,<span class="dv">227</span>,<span class="dv">274</span>,<span class="dv">102</span>,<span class="dv">235</span>,<span class="dv">131</span>,<span class="dv">158</span>,<span class="dv">257</span>,<span class="dv">138</span>,<span class="dv">281</span>,<span class="dv">248</span>,<span class="dv">110</span>,<span class="dv">135</span>,<span class="dv">78</span>,<span class="dv">201</span>,<span class="dv">264</span>,<span class="dv">31</span>,<span class="dv">293</span>,<span class="dv">8</span>,<span class="dv">25</span>,<span class="dv">176</span>,<span class="dv">246</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>R)</span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>we also prepare available predictors: pKa, logP and functional_groups</span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cleaning3}</span></span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a>pKaslit <span class="ot">=</span> dataACD[,<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>]           <span class="co"># pKa values as predicted by ACD</span></span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a>pKasliterror <span class="ot">=</span> dataACD[,<span class="dv">25</span><span class="sc">:</span><span class="dv">29</span>]    <span class="co"># pKa error as predicted by ACD</span></span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a>chargesA <span class="ot">=</span> <span class="fu">abs</span>(dataACD[,<span class="dv">13</span><span class="sc">:</span><span class="dv">18</span>])   <span class="co"># number of ionized groups (anions)</span></span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a>chargesB <span class="ot">=</span> <span class="fu">abs</span>(dataACD[,<span class="dv">19</span><span class="sc">:</span><span class="dv">24</span>])   <span class="co"># number of ionized groups (cations)</span></span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a>charges <span class="ot">=</span> chargesA<span class="sc">+</span>chargesB                         <span class="co"># absolute charge</span></span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a>groupsA <span class="ot">=</span> (chargesA[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">-</span> chargesA[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])         <span class="co"># acidic group</span></span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a>groupsB <span class="ot">=</span> <span class="sc">-</span>(chargesB[,<span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>] <span class="sc">-</span> chargesB[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])        <span class="co"># basic group</span></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a>R <span class="ot">=</span> dataACD<span class="sc">$</span>R                      <span class="co"># number of dissociation steps</span></span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">=</span> groupsB<span class="sc">-</span>groupsA</span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a>logPobs <span class="ot">=</span> dataACD<span class="sc">$</span>logP </span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a>functional_groups<span class="ot">=</span>functional_groups[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(functional_groups)]</span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a><span class="co"># combine nr of caroboxylic acid and carboxyalic acid salt functional groups</span></span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a><span class="co"># heterocyclic compounds with more than 6 heterocycles are treated as if they have six</span></span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a>functional_groups[,<span class="dv">76</span>]<span class="ot">=</span>functional_groups[,<span class="dv">76</span>]<span class="sc">+</span>functional_groups[,<span class="dv">77</span>]       </span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a>functional_groups[<span class="fu">which</span>(functional_groups[,<span class="dv">202</span>]<span class="sc">&gt;</span><span class="fl">5.5</span>),<span class="dv">202</span>] <span class="ot">=</span> <span class="dv">6</span>; </span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude some functional groups</span></span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a>idx_included <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">9</span>,<span class="dv">11</span>,<span class="dv">14</span>,<span class="dv">18</span>,<span class="dv">19</span>,<span class="dv">20</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">26</span>,<span class="dv">29</span>,<span class="dv">30</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">33</span>,<span class="dv">34</span>,<span class="dv">38</span>,<span class="dv">39</span>,<span class="dv">40</span>,<span class="dv">41</span>,<span class="dv">45</span>,<span class="dv">49</span>,<span class="dv">50</span>,<span class="dv">52</span>,<span class="dv">53</span>,<span class="dv">54</span>,<span class="dv">56</span>,<span class="dv">57</span>,<span class="dv">59</span>,<span class="dv">63</span>,<span class="dv">64</span>,<span class="dv">68</span>,<span class="dv">69</span>,<span class="dv">70</span>,<span class="dv">71</span>,<span class="dv">76</span>,<span class="dv">78</span>,<span class="dv">79</span>,<span class="dv">81</span>,<span class="dv">82</span>,<span class="dv">83</span>,<span class="dv">84</span>,<span class="dv">85</span>,<span class="dv">88</span>,<span class="dv">90</span>,<span class="dv">106</span>,<span class="dv">108</span>,<span class="dv">113</span>,<span class="dv">114</span>,<span class="dv">115</span>,<span class="dv">127</span>,<span class="dv">131</span>,<span class="dv">133</span>,<span class="dv">137</span>,<span class="dv">138</span>,<span class="dv">150</span>,<span class="dv">164</span>,<span class="dv">166</span>,<span class="dv">167</span>)</span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a>functional_groups_names <span class="ot">&lt;-</span> functional_groups_names[idx_included,]</span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a>functional_groups <span class="ot">&lt;-</span> functional_groups[,idx_included]</span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(idx_included)</span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>finally, we select analytes with <span class="sc">\&lt;</span>=2 dissociation steps fot the analysis</span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cleaning4}</span></span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a>maxR <span class="ot">&lt;-</span> <span class="dv">2</span>         </span>
<span id="cb28-182"><a href="#cb28-182" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(dataACD<span class="sc">$</span>METID <span class="sc">%in%</span> data<span class="sc">$</span>METID)</span>
<span id="cb28-183"><a href="#cb28-183" aria-hidden="true" tabindex="-1"></a> <span class="co"># max two dissociation steps        </span></span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a>pKaslit <span class="ot">&lt;-</span> pKaslit[idx,<span class="dv">1</span><span class="sc">:</span>maxR]           <span class="co"># pKa values as predicted by ACD</span></span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a>pKasliterror <span class="ot">&lt;-</span> pKasliterror[idx,<span class="dv">1</span><span class="sc">:</span>maxR] <span class="co"># pKa error as predicted by ACD</span></span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a>chargesA <span class="ot">&lt;-</span> chargesA[idx,<span class="dv">1</span><span class="sc">:</span>(maxR<span class="sc">+</span><span class="dv">1</span>)]     <span class="co"># number of ionized groups (anions)</span></span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a>chargesB <span class="ot">&lt;-</span> chargesB[idx,<span class="dv">1</span><span class="sc">:</span>(maxR<span class="sc">+</span><span class="dv">1</span>)]     <span class="co"># number of ionized groups (cations)</span></span>
<span id="cb28-188"><a href="#cb28-188" aria-hidden="true" tabindex="-1"></a>charges <span class="ot">&lt;-</span> charges[idx,<span class="dv">1</span><span class="sc">:</span>(maxR<span class="sc">+</span><span class="dv">1</span>)]       <span class="co"># absolute charge</span></span>
<span id="cb28-189"><a href="#cb28-189" aria-hidden="true" tabindex="-1"></a>groupsA <span class="ot">&lt;-</span> groupsA[idx,<span class="dv">1</span><span class="sc">:</span>maxR]           <span class="co"># acidic group</span></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a>groupsB <span class="ot">&lt;-</span> groupsB[idx,<span class="dv">1</span><span class="sc">:</span>maxR]           <span class="co"># basic group</span></span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> R[idx]                              <span class="co"># number of dissociation steps</span></span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a>logPobs <span class="ot">&lt;-</span> logPobs[idx]                 <span class="co"># logP</span></span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a>nrfungroups<span class="ot">=</span>functional_groups[idx,]</span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a>totalnrgroups <span class="ot">&lt;-</span> <span class="fu">summarise_each</span>(nrfungroups, <span class="fu">funs</span>(sum))</span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a><span class="co"># remove functional groups not present in the dataset:</span></span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a>nrfungroups <span class="ot">&lt;-</span> nrfungroups[,<span class="fu">which</span>(totalnrgroups<span class="sc">!=</span><span class="dv">0</span>)]</span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a>functionalgroupsnames<span class="ot">&lt;-</span> functional_groups_names[<span class="fu">which</span>(totalnrgroups<span class="sc">!=</span><span class="dv">0</span>),]</span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a>totalnrgroups <span class="ot">&lt;-</span> <span class="fu">summarise_each</span>(nrfungroups, <span class="fu">funs</span>(sum))</span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">ncol</span>(nrfungroups)</span>
<span id="cb28-201"><a href="#cb28-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-202"><a href="#cb28-202" aria-hidden="true" tabindex="-1"></a><span class="co"># identify acidic groups</span></span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a>idxGroupsA <span class="ot">&lt;-</span><span class="fu">which</span>(groupsA<span class="sc">!=</span><span class="dv">0</span>,<span class="at">arr.ind =</span> T)</span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a>nGroupsA <span class="ot">&lt;-</span> <span class="fu">nrow</span>(idxGroupsA)</span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a>pKaslitA<span class="ot">&lt;-</span>pKaslit[idxGroupsA]</span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-207"><a href="#cb28-207" aria-hidden="true" tabindex="-1"></a><span class="co"># identify basic groups</span></span>
<span id="cb28-208"><a href="#cb28-208" aria-hidden="true" tabindex="-1"></a>idxGroupsB <span class="ot">&lt;-</span><span class="fu">which</span>(groupsB<span class="sc">!=</span><span class="dv">0</span>,<span class="at">arr.ind =</span> T)</span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a>nGroupsB <span class="ot">&lt;-</span> <span class="fu">nrow</span>(idxGroupsB)</span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a>pKaslitB<span class="ot">&lt;-</span>pKaslit[idxGroupsB]</span>
<span id="cb28-211"><a href="#cb28-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-212"><a href="#cb28-212" aria-hidden="true" tabindex="-1"></a><span class="co"># groups dissociated in the whole pH range</span></span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a>idxB <span class="ot">=</span> <span class="fu">which</span>(chargesB[,<span class="dv">3</span>]<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a>idxA <span class="ot">=</span> <span class="fu">which</span>(chargesA[,<span class="dv">1</span>]<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a>nObs <span class="ot">&lt;-</span> <span class="fu">length</span>(data<span class="sc">$</span>METID)</span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID))</span>
<span id="cb28-219"><a href="#cb28-219" aria-hidden="true" tabindex="-1"></a>nColumns<span class="ot">&lt;-</span><span class="fu">length</span>(<span class="fu">unique</span>(data<span class="sc">$</span>Column))</span>
<span id="cb28-220"><a href="#cb28-220" aria-hidden="true" tabindex="-1"></a>                </span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a><span class="co">#  variables used later to annotate graphs legend</span></span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a>temp.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"25\u00b0C"</span>,<span class="st">"35\u00b0C"</span>)</span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(temp.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'25'</span>,<span class="st">'35'</span>)</span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a>mod.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ACN"</span>,<span class="st">"MeOH"</span>)</span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(mod.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'2'</span>,<span class="st">'1'</span>)</span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a>col.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)</span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(col.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'3'</span>,<span class="st">'4'</span>,<span class="st">'5'</span>)</span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a>diss.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"r=1"</span>,<span class="st">"r=2"</span>,<span class="st">"r=3"</span>)</span>
<span id="cb28-232"><a href="#cb28-232" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(diss.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'3'</span>)</span>
<span id="cb28-233"><a href="#cb28-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exploratory data analysis</span></span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-238"><a href="#cb28-238" aria-hidden="true" tabindex="-1"></a>During the exploratory data analysis phase, we create a series of plots to better understand our data.</span>
<span id="cb28-239"><a href="#cb28-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plots</span></span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a>The following graphs present retention time profiles for 6 analytes:</span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>acridine (monoprotic acid)</span>
<span id="cb28-245"><a href="#cb28-245" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>baclofen (zwitterion: acidic and basic group)</span>
<span id="cb28-246"><a href="#cb28-246" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>hydrocortison (neutral)</span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>pioglitazone (zwitterion: basic and acidic group)</span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>quinine (diprotic: 2 basic groups),</span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>tolbutamide (monoprotic base).</span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a>The vertical lines show ACD-based pKa values (solid line: acidic group; dotted line: basic group)</span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-253"><a href="#cb28-253" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rawdata}</span></span>
<span id="cb28-254"><a href="#cb28-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-256"><a href="#cb28-256" aria-hidden="true" tabindex="-1"></a><span class="co">#analyte_ID_sample &lt;-unique(data$METID) # if all</span></span>
<span id="cb28-257"><a href="#cb28-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-258"><a href="#cb28-258" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID) <span class="sc">%in%</span> analyte_ID_sample)</span>
<span id="cb28-259"><a href="#cb28-259" aria-hidden="true" tabindex="-1"></a>groups <span class="ot">&lt;-</span> groupsB<span class="sc">-</span>groupsA</span>
<span id="cb28-260"><a href="#cb28-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-261"><a href="#cb28-261" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-262"><a href="#cb28-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-263"><a href="#cb28-263" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data[<span class="fu">which</span>(data<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),])<span class="sc">+</span></span>
<span id="cb28-264"><a href="#cb28-264" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> RT, <span class="at">color =</span> <span class="fu">as.factor</span>(tg), <span class="at">shape=</span><span class="fu">as.factor</span>(ColumnName)), <span class="at">width =</span><span class="fl">0.1</span>, <span class="at">height=</span><span class="fl">0.1</span>)<span class="sc">+</span> </span>
<span id="cb28-265"><a href="#cb28-265" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(Temp<span class="sc">~</span>Mod2, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-266"><a href="#cb28-266" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> pKaslit[idx[i],<span class="dv">1</span>],<span class="at">linetype=</span>groups[idx[i],<span class="dv">1</span>]<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-267"><a href="#cb28-267" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> pKaslit[idx[i],<span class="dv">2</span>],<span class="at">linetype=</span>groups[idx[i],<span class="dv">2</span>]<span class="sc">+</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-268"><a href="#cb28-268" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), </span>
<span id="cb28-269"><a href="#cb28-269" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span><span class="st">"pH"</span>, <span class="at">y =</span> <span class="st">"Retention time, min"</span>, </span>
<span id="cb28-270"><a href="#cb28-270" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span>    <span class="st">"tg, min"</span>, </span>
<span id="cb28-271"><a href="#cb28-271" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="st">'Column'</span>)<span class="sc">+</span> </span>
<span id="cb28-272"><a href="#cb28-272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">2</span>,<span class="dv">11</span>)</span>
<span id="cb28-273"><a href="#cb28-273" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-274"><a href="#cb28-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-275"><a href="#cb28-275" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">rawdata</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-276"><a href="#cb28-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-277"><a href="#cb28-277" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-278"><a href="#cb28-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-279"><a href="#cb28-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-280"><a href="#cb28-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-281"><a href="#cb28-281" aria-hidden="true" tabindex="-1"></a><span class="fu">### Summary of the data</span></span>
<span id="cb28-282"><a href="#cb28-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-283"><a href="#cb28-283" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Number of identified analytes: <span class="in">`r nAnalytes`</span></span>
<span id="cb28-284"><a href="#cb28-284" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Number of observations: <span class="in">`r nObs`</span></span>
<span id="cb28-285"><a href="#cb28-285" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>$\small logP$: <span class="in">`r round(mean(logPobs),2)`</span> $\pm$ <span class="in">`r round(sd(logPobs),2)`</span></span>
<span id="cb28-286"><a href="#cb28-286" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Number of analytes with 0, 1 and 2 dissociation steps: <span class="in">`r tabulate(as.factor(R))`</span></span>
<span id="cb28-287"><a href="#cb28-287" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Number of acidic and basic groups: <span class="in">`r round(length(pKaslitA),2)`</span> and <span class="in">`r round(length(pKaslitB),2)`</span></span>
<span id="cb28-288"><a href="#cb28-288" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Number of functional groups across all analytes included in the analysis:</span>
<span id="cb28-289"><a href="#cb28-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-290"><a href="#cb28-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r functionalgroups}</span></span>
<span id="cb28-291"><a href="#cb28-291" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>totalnrgroups <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">gather</span>(<span class="st">"Name"</span>, <span class="st">"count"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">54</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb28-292"><a href="#cb28-292" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">y=</span><span class="fu">reorder</span>(Name,count)))<span class="sc">+</span></span>
<span id="cb28-293"><a href="#cb28-293" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb28-294"><a href="#cb28-294" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Number of functional groups"</span>, <span class="at">y=</span><span class="st">"Functional group name"</span>)</span>
<span id="cb28-295"><a href="#cb28-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-296"><a href="#cb28-296" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-297"><a href="#cb28-297" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">predictors</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"functionalgroups"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-298"><a href="#cb28-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-299"><a href="#cb28-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-300"><a href="#cb28-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-301"><a href="#cb28-301" aria-hidden="true" tabindex="-1"></a><span class="fu"># Methods</span></span>
<span id="cb28-302"><a href="#cb28-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-303"><a href="#cb28-303" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model</span></span>
<span id="cb28-304"><a href="#cb28-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-305"><a href="#cb28-305" aria-hidden="true" tabindex="-1"></a>In this work $\small z$ = 1..<span class="in">`r nObs`</span> denotes observation, $\small i$=1..<span class="in">`r nAnalytes`</span> denotes analyte, $\small col$=1..5 denotes column, $\small m$=1..2 denotes organic modifier and $\small r$=1..$\small R<span class="co">[</span><span class="ot">i</span><span class="co">]</span>$ denotes dissociation step for $\small i$-th analyte. The observed retention times ($\small t_{Robs,z}$) were described using the following model:</span>
<span id="cb28-306"><a href="#cb28-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-307"><a href="#cb28-307" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-308"><a href="#cb28-308" aria-hidden="true" tabindex="-1"></a>t_{Robs,z} \sim student_t(\nu, t_{R,z} ,\sigma_{col<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,i<span class="co">[</span><span class="ot">z</span><span class="co">]</span>})</span>
<span id="cb28-309"><a href="#cb28-309" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-310"><a href="#cb28-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-311"><a href="#cb28-311" aria-hidden="true" tabindex="-1"></a>where z denotes z-th observation and student_t denotes the Student's t-distribution with the mean given by the predicted retention time $\small t_{R,z}$, scale $\small \sigma_{i,col}$ (analyte and column-specific), and normality parameter $\small \nu$ (set to 3).</span>
<span id="cb28-312"><a href="#cb28-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-313"><a href="#cb28-313" aria-hidden="true" tabindex="-1"></a>Gradient retention time $\small t_{R,z}$ was calculated utilizing the well-known integral equation:</span>
<span id="cb28-314"><a href="#cb28-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-315"><a href="#cb28-315" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-316"><a href="#cb28-316" aria-hidden="true" tabindex="-1"></a>\int_0^{t_{R,z}-t_{0,z}-t_e}\frac{dt}{t_{0,z}\cdot ki_z(t) }=1,</span>
<span id="cb28-317"><a href="#cb28-317" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-318"><a href="#cb28-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-319"><a href="#cb28-319" aria-hidden="true" tabindex="-1"></a>where $\small ki_z(t)$ denotes instantaneous isocratic retention factor corresponding to the mobile phase composition at time t at column inlet for analyte and conditions corresponding to the z-th observation, $\small t_{0,z}$ denotes column hold-up (dead) time and $\small t_e$ denotes extra column-time. The numerical solution of this integral equation was carried out using method of steps with 4 and 10 steps for methanol and acetonitrile gradients using method proposed by Nikitas et al. <span class="co">[</span><span class="ot">@nikitas_new_2002</span><span class="co">]</span> The following function described the relationship between the isocratic retention factor and pH for an ith-analyte with $\small R<span class="co">[</span><span class="ot">i</span><span class="co">]</span>$ dissociation steps and $\small R<span class="co">[</span><span class="ot">i</span><span class="co">]</span>+1$ forms.</span>
<span id="cb28-320"><a href="#cb28-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-321"><a href="#cb28-321" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-322"><a href="#cb28-322" aria-hidden="true" tabindex="-1"></a>ki_z(t)=\frac{k_{z,i<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,1}(t)+\sum_{r=1}^{R<span class="co">[</span><span class="ot">i[z]</span><span class="co">]</span>} k_{z,i<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,r+1}(t) \cdot 10^{r\cdot pH_z(t)-\sum_{r=1}^{R<span class="co">[</span><span class="ot">i</span><span class="co">]</span>} pKa_{z,i<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,r}(t)} }{1+\sum_{r=1}^R 10^{r\cdot pH_z(t)-\sum_{r=1}^{R<span class="co">[</span><span class="ot">i[z]</span><span class="co">]</span>} pKa_{z,i<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,r}(t) } }</span>
<span id="cb28-323"><a href="#cb28-323" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-324"><a href="#cb28-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-325"><a href="#cb28-325" aria-hidden="true" tabindex="-1"></a>$\small log(k_{z,i,r})$ was assumed to depend on the organic modifier content based on the Neue equation, on temperature assuming linear equation, and on the pH of the mobiles phase (for ionized forms of analytes).</span>
<span id="cb28-326"><a href="#cb28-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-327"><a href="#cb28-327" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-328"><a href="#cb28-328" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-329"><a href="#cb28-329" aria-hidden="true" tabindex="-1"></a>&amp; log(k_{z,i,r}(t)) = logkw_{col<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,i,r} - \frac{S1_{m<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,col<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,i,r} \cdot (1+S2_{m<span class="co">[</span><span class="ot">z</span><span class="co">]</span>}) \cdot \varphi_z(t)}{1+S2_{m<span class="co">[</span><span class="ot">z</span><span class="co">]</span>} \cdot \varphi_z(t)} + ... <span class="sc">\\</span> </span>
<span id="cb28-330"><a href="#cb28-330" aria-hidden="true" tabindex="-1"></a>&amp; apH_{col<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,m<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,i,r} \cdot (pH_z(t)-7) + dlogkT_{col<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,i} \cdot (T_z-25)/10</span>
<span id="cb28-331"><a href="#cb28-331" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-332"><a href="#cb28-332" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-333"><a href="#cb28-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-334"><a href="#cb28-334" aria-hidden="true" tabindex="-1"></a>where $\small logkw_{col,i,r}$ represents logarithm of retention factors extrapolated to 0% of organic modifier content for column $\small col$, $\small i$-th analyte and $\small r$-th analyte form; $\small S1_{i,m,col,r}$ and $\small S2_m$ are the slopes in the Neue equation for column $\small c$, modifier $\small m$, $\small i$-th analyte and $\small r$-th analyte form. In this parametrization of the Neue equation, $\small S1$ reflects the difference between logarithm of retention factors corresponding to water (0% of organic modifier content) and MeOH or ACN (100% of organic modifier content) as eluents. $\small dlogkT_{col,i}$ denotes the change in $\small logkw$ due to the increase in temperature by $\small 10^oC$. $\small apH_{col,m,i,r}$ denotes the pH effects on $\small logkw$;</span>
<span id="cb28-335"><a href="#cb28-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-336"><a href="#cb28-336" aria-hidden="true" tabindex="-1"></a>Further a linear relationship between $\small pKa$ values and the organic modifier content was assumed:</span>
<span id="cb28-337"><a href="#cb28-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-338"><a href="#cb28-338" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-339"><a href="#cb28-339" aria-hidden="true" tabindex="-1"></a>pKa_{z,i,r}(t)=pKaw_{i,r}+\alpha_{m<span class="co">[</span><span class="ot">z</span><span class="co">]</span>,i,r}\cdot\varphi_z(t)</span>
<span id="cb28-340"><a href="#cb28-340" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-341"><a href="#cb28-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-342"><a href="#cb28-342" aria-hidden="true" tabindex="-1"></a>where $\small pKa_{z,i,r}(t)$ denotes dissociation constant of an $\small i$-th analyte and $\small r$-th dissociation step form and chromatographic conditions corresponding the z-th observation, $\small pKaw_{i,r}$ denotes aqueous $\small pKa$, and $\alpha_{m,i,r}$ denotes the slope for $\small m$-th modifier, $\small i$-th analyte and $\small r$-th form. The linear relationships is generally valid for $\small \varphi$ <span class="sc">\&lt;</span> 0.8.</span>
<span id="cb28-343"><a href="#cb28-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-344"><a href="#cb28-344" aria-hidden="true" tabindex="-1"></a>The relationship between pH and the organic modifier content for various combinations of organic modifier and buffer was experimentally determined prior to the chromatographic analysis. The obtained relationships was then described using quadratic equations for each nominal pH, temperature and organic modifier:</span>
<span id="cb28-345"><a href="#cb28-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-346"><a href="#cb28-346" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-347"><a href="#cb28-347" aria-hidden="true" tabindex="-1"></a>pH_z(t)=pHo_z+\alpha 1_z\cdot \varphi_z(t)+\alpha2_z\cdot {\varphi_z(t)}^2</span>
<span id="cb28-348"><a href="#cb28-348" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-349"><a href="#cb28-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-350"><a href="#cb28-350" aria-hidden="true" tabindex="-1"></a>First, individual values of $\small logkw$, $\small S1$ are defined for the neutral form of an analyte in MeOH for the Xbridge Sheld RP18 column (denoted as $\small logkwN_i$ and $\small S1mN_i$). The effect of ACN was described as ($\small dS1N_i$), the effect of column ($\small c=1..4$) was described by $\small clogkwN_{c,i}$, $\small cS1mN_{c,i}$, and $\small cdS1N_{c,i}$). The individual parameters for the neutral forms were described using the following equations:</span>
<span id="cb28-351"><a href="#cb28-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-352"><a href="#cb28-352" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-353"><a href="#cb28-353" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-354"><a href="#cb28-354" aria-hidden="true" tabindex="-1"></a>&amp; \begin{bmatrix}</span>
<span id="cb28-355"><a href="#cb28-355" aria-hidden="true" tabindex="-1"></a>logkwN_i <span class="sc">\\</span></span>
<span id="cb28-356"><a href="#cb28-356" aria-hidden="true" tabindex="-1"></a>S1mN_i<span class="sc">\\</span></span>
<span id="cb28-357"><a href="#cb28-357" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} \sim</span>
<span id="cb28-358"><a href="#cb28-358" aria-hidden="true" tabindex="-1"></a>MVN(\begin{bmatrix}</span>
<span id="cb28-359"><a href="#cb28-359" aria-hidden="true" tabindex="-1"></a>\hat{logkw}+\beta_1 \cdot (logP_i-2.2) <span class="sc">\\</span></span>
<span id="cb28-360"><a href="#cb28-360" aria-hidden="true" tabindex="-1"></a>\hat{S1m}+\beta_2 \cdot (logP_i-2.2) <span class="sc">\\</span></span>
<span id="cb28-361"><a href="#cb28-361" aria-hidden="true" tabindex="-1"></a>\end{bmatrix},  \Omega) <span class="sc">\\</span></span>
<span id="cb28-362"><a href="#cb28-362" aria-hidden="true" tabindex="-1"></a>&amp; dS1N_i \sim N(\hat{dS1}, \omega_3)<span class="sc">\\</span></span>
<span id="cb28-363"><a href="#cb28-363" aria-hidden="true" tabindex="-1"></a>&amp; \Omega =</span>
<span id="cb28-364"><a href="#cb28-364" aria-hidden="true" tabindex="-1"></a>diag(\omega_{1:2}) \cdot \begin{bmatrix}</span>
<span id="cb28-365"><a href="#cb28-365" aria-hidden="true" tabindex="-1"></a> 1 &amp; \rho <span class="sc">\\</span></span>
<span id="cb28-366"><a href="#cb28-366" aria-hidden="true" tabindex="-1"></a> \rho &amp; 1  <span class="sc">\\</span></span>
<span id="cb28-367"><a href="#cb28-367" aria-hidden="true" tabindex="-1"></a> \end{bmatrix} \cdot diag(\omega_{1:2}) <span class="sc">\\</span></span>
<span id="cb28-368"><a href="#cb28-368" aria-hidden="true" tabindex="-1"></a>&amp; \begin{bmatrix}</span>
<span id="cb28-369"><a href="#cb28-369" aria-hidden="true" tabindex="-1"></a>clogkwN_{1,i} <span class="sc">\\</span></span>
<span id="cb28-370"><a href="#cb28-370" aria-hidden="true" tabindex="-1"></a>clogkwN_{2,i} <span class="sc">\\</span></span>
<span id="cb28-371"><a href="#cb28-371" aria-hidden="true" tabindex="-1"></a>clogkwN_{3,i} <span class="sc">\\</span></span>
<span id="cb28-372"><a href="#cb28-372" aria-hidden="true" tabindex="-1"></a>clogkwN_{4,i} <span class="sc">\\</span></span>
<span id="cb28-373"><a href="#cb28-373" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} \sim</span>
<span id="cb28-374"><a href="#cb28-374" aria-hidden="true" tabindex="-1"></a>MVN(\begin{bmatrix}</span>
<span id="cb28-375"><a href="#cb28-375" aria-hidden="true" tabindex="-1"></a>\hat{clogkw_1}+c\beta_{1,1} \cdot (logP_i-2.2) <span class="sc">\\</span></span>
<span id="cb28-376"><a href="#cb28-376" aria-hidden="true" tabindex="-1"></a>\hat{clogkw_2}+c\beta_{2,1} \cdot (logP_i-2.2) <span class="sc">\\</span></span>
<span id="cb28-377"><a href="#cb28-377" aria-hidden="true" tabindex="-1"></a>\hat{clogkw_3}+c\beta_{3,1} \cdot (logP_i-2.2) <span class="sc">\\</span></span>
<span id="cb28-378"><a href="#cb28-378" aria-hidden="true" tabindex="-1"></a>\hat{clogkw_4}+c\beta_{4,1} \cdot (logP_i-2.2) <span class="sc">\\</span></span>
<span id="cb28-379"><a href="#cb28-379" aria-hidden="true" tabindex="-1"></a>\end{bmatrix},  c\Omega) <span class="sc">\\</span></span>
<span id="cb28-380"><a href="#cb28-380" aria-hidden="true" tabindex="-1"></a>&amp; c\Omega =</span>
<span id="cb28-381"><a href="#cb28-381" aria-hidden="true" tabindex="-1"></a>diag(c\omega) \cdot \begin{bmatrix}</span>
<span id="cb28-382"><a href="#cb28-382" aria-hidden="true" tabindex="-1"></a> 1 &amp; c\rho_{12} &amp; c\rho_{13} &amp; c\rho_{14} <span class="sc">\\</span></span>
<span id="cb28-383"><a href="#cb28-383" aria-hidden="true" tabindex="-1"></a>  c\rho_{21} &amp; 1 &amp; c\rho_{23} &amp; c\rho_{24} <span class="sc">\\</span></span>
<span id="cb28-384"><a href="#cb28-384" aria-hidden="true" tabindex="-1"></a>   c\rho_{31} &amp; c\rho_{32} &amp; 1 &amp; c\rho_{34} <span class="sc">\\</span></span>
<span id="cb28-385"><a href="#cb28-385" aria-hidden="true" tabindex="-1"></a>   c \rho_{41} &amp; c\rho_{42} &amp; c\rho_{43} &amp; 1 <span class="sc">\\</span></span>
<span id="cb28-386"><a href="#cb28-386" aria-hidden="true" tabindex="-1"></a> \end{bmatrix} \cdot diag(c\omega) <span class="sc">\\</span></span>
<span id="cb28-387"><a href="#cb28-387" aria-hidden="true" tabindex="-1"></a>&amp; cS1mN_{c,i} \sim N(\hat{cS1m}+c\beta_{c,2}\cdot (logP_i-2.2), c\omega_{c,2}) \text{ for c=1...4} <span class="sc">\\</span></span>
<span id="cb28-388"><a href="#cb28-388" aria-hidden="true" tabindex="-1"></a>&amp; cdS1N_{c,i} \sim N(\hat{cdS1_c}, c\omega_{c,3}) \text{ for c=1...4} <span class="sc">\\</span></span>
<span id="cb28-389"><a href="#cb28-389" aria-hidden="true" tabindex="-1"></a>&amp; dlogkT_{c,i} \sim N(\hat{dlogkT_c},\omega_{T,c}) \text{ for c=1...4} <span class="sc">\\</span></span>
<span id="cb28-390"><a href="#cb28-390" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-391"><a href="#cb28-391" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-392"><a href="#cb28-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-393"><a href="#cb28-393" aria-hidden="true" tabindex="-1"></a>were MVN denotes the multivariate normal distribution; $\small \hat{logkw}$, $\small \hat{S1m}$, $\small \hat{dS1}$ are the mean values of individual chromatographic parameters that correspond to a typical neutral analyte with $\small logP$ =2.2 at $\small 25^oC$ on Xbridge Shield RP18 stationary phase. $\small \beta s$ are regression coefficients between the individual chromatographic parameters and the $\small logP_i$. $\small \omega$ denotes the standard deviation for between analyte variability (BAV). $\small \hat{dlogkT}$ denotes the effect of temperature for a typical analyte and $\small \omega_T$ the standard deviation for between analyte variability for temperature effects. Similar set of equations was used for column effects. Here c denoted the column effect (4 differences with respect to he reference column).</span>
<span id="cb28-394"><a href="#cb28-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-395"><a href="#cb28-395" aria-hidden="true" tabindex="-1"></a>The difference in retention between the ionized form of an analyte and the neutral form of an analyte was separately estimated for acids and bases for $\small logkw$, $\small S1m$, $\small dS1$ parameters. Similar set of equations was used for column effects.</span>
<span id="cb28-396"><a href="#cb28-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-397"><a href="#cb28-397" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-398"><a href="#cb28-398" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-399"><a href="#cb28-399" aria-hidden="true" tabindex="-1"></a>&amp; dlogkwA_a \sim N(\hat{dlogkw_1}, \kappa_1), <span class="sc">\\</span></span>
<span id="cb28-400"><a href="#cb28-400" aria-hidden="true" tabindex="-1"></a>&amp; dlogkwB_b \sim N(\hat{dlogkw_2}, \kappa_1), <span class="sc">\\</span></span>
<span id="cb28-401"><a href="#cb28-401" aria-hidden="true" tabindex="-1"></a>&amp; dS1mA_a \sim N(\hat{dS1m_1}, \kappa_2), <span class="sc">\\</span></span>
<span id="cb28-402"><a href="#cb28-402" aria-hidden="true" tabindex="-1"></a>&amp; dS1mB_b \sim N(\hat{dS1m_2}, \kappa_2), <span class="sc">\\</span></span>
<span id="cb28-403"><a href="#cb28-403" aria-hidden="true" tabindex="-1"></a>&amp; ddS1A_a \sim N(\hat{ddS1_1}, \kappa_3), <span class="sc">\\</span></span>
<span id="cb28-404"><a href="#cb28-404" aria-hidden="true" tabindex="-1"></a>&amp; ddS1B_b \sim N(\hat{ddS1_2}, \kappa_3), <span class="sc">\\</span></span>
<span id="cb28-405"><a href="#cb28-405" aria-hidden="true" tabindex="-1"></a>&amp; cdlogkwA_{c,a} \sim N(\hat{cdlogkw_{c,1}}, c\kappa_{c,1}) \text{ for c=1...4}, <span class="sc">\\</span></span>
<span id="cb28-406"><a href="#cb28-406" aria-hidden="true" tabindex="-1"></a>&amp; cdlogkwB_{c,b} \sim N(\hat{cdlogkw_{c,2}}, c\kappa_{c,1}) \text{ for c=1...4}, <span class="sc">\\</span></span>
<span id="cb28-407"><a href="#cb28-407" aria-hidden="true" tabindex="-1"></a>&amp; cdS1mA_{c,a} \sim N(\hat{cdS1m_{c,1}}, c\kappa_{c,2}) \text{ for c=1...4}, <span class="sc">\\</span></span>
<span id="cb28-408"><a href="#cb28-408" aria-hidden="true" tabindex="-1"></a>&amp; cdS1mB_{c,b} \sim N(\hat{cdS1m_{c,2}}, c\kappa_{c,2}) \text{ for c=1...4}, <span class="sc">\\</span></span>
<span id="cb28-409"><a href="#cb28-409" aria-hidden="true" tabindex="-1"></a>&amp; cddS1A_{c,a} \sim N(\hat{cddS1_{c,1}}, c\kappa_{c,3}) \text{ for c=1...4}, <span class="sc">\\</span></span>
<span id="cb28-410"><a href="#cb28-410" aria-hidden="true" tabindex="-1"></a>&amp; cddS1B_{c,b} \sim N(\hat{cddS1_{c,2}}, c\kappa_{c,3}) \text{ for c=1...4}. <span class="sc">\\</span></span>
<span id="cb28-411"><a href="#cb28-411" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-412"><a href="#cb28-412" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb28-413"><a href="#cb28-413" aria-hidden="true" tabindex="-1"></a>where a=1..<span class="in">`r nGroupsA`</span> and b=1..<span class="in">`r nGroupsB`</span> denote the indexes of acidic and basic groups.</span>
<span id="cb28-414"><a href="#cb28-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-415"><a href="#cb28-415" aria-hidden="true" tabindex="-1"></a>Similarly $\small pKa$ an $\small \alpha$ parameters were described separately for acids and based:</span>
<span id="cb28-416"><a href="#cb28-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-417"><a href="#cb28-417" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-418"><a href="#cb28-418" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-419"><a href="#cb28-419" aria-hidden="true" tabindex="-1"></a>&amp; pKawA_{a} \sim N(pKaAlit_{a}, \tau_1), <span class="sc">\\</span></span>
<span id="cb28-420"><a href="#cb28-420" aria-hidden="true" tabindex="-1"></a>&amp; pKawB_{b} \sim N(pKaBlit_{b}, \tau_1), <span class="sc">\\</span></span>
<span id="cb28-421"><a href="#cb28-421" aria-hidden="true" tabindex="-1"></a>&amp; \alpha mA_{a} \sim N(\hat{\alpha m_1},\tau_2), <span class="sc">\\</span></span>
<span id="cb28-422"><a href="#cb28-422" aria-hidden="true" tabindex="-1"></a>&amp; \alpha mB_{b} \sim N(\hat{\alpha m_2},\tau_2), <span class="sc">\\</span></span>
<span id="cb28-423"><a href="#cb28-423" aria-hidden="true" tabindex="-1"></a>&amp; d\alpha A_{a} \sim N(\hat{d\alpha_1},\tau_3), <span class="sc">\\</span></span>
<span id="cb28-424"><a href="#cb28-424" aria-hidden="true" tabindex="-1"></a>&amp; d\alpha B_{b} \sim N(\hat{d\alpha_2},\tau_3).</span>
<span id="cb28-425"><a href="#cb28-425" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-426"><a href="#cb28-426" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-427"><a href="#cb28-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-428"><a href="#cb28-428" aria-hidden="true" tabindex="-1"></a>Further, we created the matrices containing the value of parameters for i-th analyte, col-th column, m-th modifier an r-th dissociation step based on the value of neutral form and effects of column, organic modifier, and dissociation. This transformation was denoted as f(.). The exact procedure can be found in the model code displayed later.</span>
<span id="cb28-429"><a href="#cb28-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-430"><a href="#cb28-430" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-431"><a href="#cb28-431" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-432"><a href="#cb28-432" aria-hidden="true" tabindex="-1"></a>&amp; logkw_{col,i,r}= f(logkwN_i,clogkwN_{c,i},dlogkwA_{a},cdlogkwA_{c,a}, dlogkwB_{b}, cdlogkwB_{c.b},...) <span class="sc">\\</span></span>
<span id="cb28-433"><a href="#cb28-433" aria-hidden="true" tabindex="-1"></a>&amp; S1_{m,col,i,r}  = f(S1mN_i,cS1mN_{c,i}, dS1mA_a, cdS1mA_{c,a}, S1mB_b, cdS1mB_{c,b}, ...<span class="sc">\\</span></span>
<span id="cb28-434"><a href="#cb28-434" aria-hidden="true" tabindex="-1"></a>&amp; dS1N_i, cdS1N_{c,i}, ddS1A_a, cddS1A_{c,a}, ddS1B_b, cddS1B_{c,b},...) <span class="sc">\\</span></span>
<span id="cb28-435"><a href="#cb28-435" aria-hidden="true" tabindex="-1"></a>&amp; apH_{m,col,i,r} = f(\hat{apH_1},\hat{capH_{c,1}},\hat{apH_2},\hat{capH_{c,2}},...) <span class="sc">\\</span></span>
<span id="cb28-436"><a href="#cb28-436" aria-hidden="true" tabindex="-1"></a>&amp; S2_{m} = 10^{f(\hat{logS2m},\hat{dlogS2},...)} <span class="sc">\\</span></span>
<span id="cb28-437"><a href="#cb28-437" aria-hidden="true" tabindex="-1"></a>&amp; pKaw_{i,r} = f(pKawA_{a},pKawB_{b},...) <span class="sc">\\</span></span>
<span id="cb28-438"><a href="#cb28-438" aria-hidden="true" tabindex="-1"></a>&amp; \alpha_{m,i,r} = f(\alpha mA_{a}, d\alpha A_{a}, \alpha mB_{b}, d\alpha B_{b},...)</span>
<span id="cb28-439"><a href="#cb28-439" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-440"><a href="#cb28-440" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-441"><a href="#cb28-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-442"><a href="#cb28-442" aria-hidden="true" tabindex="-1"></a>Residual error model assumes different parameters for each column and analyte:</span>
<span id="cb28-443"><a href="#cb28-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-444"><a href="#cb28-444" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-445"><a href="#cb28-445" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb28-446"><a href="#cb28-446" aria-hidden="true" tabindex="-1"></a>&amp; log(\sigma_{col,i}) = f(log\sigma_i, clog\sigma_{c,i}) <span class="sc">\\</span></span>
<span id="cb28-447"><a href="#cb28-447" aria-hidden="true" tabindex="-1"></a>&amp; log\sigma_i  \sim N(log(m\sigma),s\sigma) <span class="sc">\\</span></span>
<span id="cb28-448"><a href="#cb28-448" aria-hidden="true" tabindex="-1"></a>&amp; clog\sigma_{c,i} \sim N(clogm\sigma_c,cs\sigma_c) \text{ for c=1...4},</span>
<span id="cb28-449"><a href="#cb28-449" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb28-450"><a href="#cb28-450" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-451"><a href="#cb28-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-452"><a href="#cb28-452" aria-hidden="true" tabindex="-1"></a>The detailed description of parameters and used priors is provided in the following table (BAV denotes between analyte variability):</span>
<span id="cb28-453"><a href="#cb28-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-454"><a href="#cb28-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r table, results="asis"}</span></span>
<span id="cb28-455"><a href="#cb28-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-456"><a href="#cb28-456" aria-hidden="true" tabindex="-1"></a><span class="co"># to properly render in quarto: https://github.com/quarto-dev/quarto-cli/issues/3340</span></span>
<span id="cb28-457"><a href="#cb28-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-458"><a href="#cb28-458" aria-hidden="true" tabindex="-1"></a>Name <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'$</span><span class="sc">\\</span><span class="st">hat{logkw}$'</span>,</span>
<span id="cb28-459"><a href="#cb28-459" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{S1m}$'</span>,</span>
<span id="cb28-460"><a href="#cb28-460" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{dS1}$'</span>,</span>
<span id="cb28-461"><a href="#cb28-461" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">beta_1$'</span>,</span>
<span id="cb28-462"><a href="#cb28-462" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">beta_2$'</span>,</span>
<span id="cb28-463"><a href="#cb28-463" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{dlogkw_1}$'</span>,</span>
<span id="cb28-464"><a href="#cb28-464" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{dlogkw_2}$'</span>,</span>
<span id="cb28-465"><a href="#cb28-465" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{dS1m_1}$'</span>,</span>
<span id="cb28-466"><a href="#cb28-466" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{dS1m_2}$'</span>,</span>
<span id="cb28-467"><a href="#cb28-467" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{ddS1_1}$'</span>,</span>
<span id="cb28-468"><a href="#cb28-468" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{ddS1_2}$'</span>,</span>
<span id="cb28-469"><a href="#cb28-469" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{apH_1}$'</span>,</span>
<span id="cb28-470"><a href="#cb28-470" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{apH_2}$'</span>,</span>
<span id="cb28-471"><a href="#cb28-471" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{dlogkT}$'</span>,</span>
<span id="cb28-472"><a href="#cb28-472" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">omega_1$'</span>,</span>
<span id="cb28-473"><a href="#cb28-473" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">omega_2$'</span>,</span>
<span id="cb28-474"><a href="#cb28-474" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">omega_3$'</span>,</span>
<span id="cb28-475"><a href="#cb28-475" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">rho$'</span>,</span>
<span id="cb28-476"><a href="#cb28-476" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">omega_T$'</span>,</span>
<span id="cb28-477"><a href="#cb28-477" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">kappa_1$'</span>,</span>
<span id="cb28-478"><a href="#cb28-478" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">kappa_2$'</span>,</span>
<span id="cb28-479"><a href="#cb28-479" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">kappa_3$'</span>,</span>
<span id="cb28-480"><a href="#cb28-480" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{clogkw_c}$'</span>,</span>
<span id="cb28-481"><a href="#cb28-481" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cS1m_c}$'</span>,</span>
<span id="cb28-482"><a href="#cb28-482" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cdS1_c}$'</span>,</span>
<span id="cb28-483"><a href="#cb28-483" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">beta_{c,1}$'</span>,</span>
<span id="cb28-484"><a href="#cb28-484" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">beta_{c,2}$'</span>,</span>
<span id="cb28-485"><a href="#cb28-485" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cdlogkw_{c,1}}$'</span>,</span>
<span id="cb28-486"><a href="#cb28-486" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cdlogkw_{c,2}}$'</span>,</span>
<span id="cb28-487"><a href="#cb28-487" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cdS1m_{c,1}}$'</span>,</span>
<span id="cb28-488"><a href="#cb28-488" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cdS1m_{c,2}}$'</span>,</span>
<span id="cb28-489"><a href="#cb28-489" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cddS1_{c,1}}$'</span>,</span>
<span id="cb28-490"><a href="#cb28-490" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cddS1_{c,2}}$'</span>,</span>
<span id="cb28-491"><a href="#cb28-491" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{cdlogkT_c}$'</span>,</span>
<span id="cb28-492"><a href="#cb28-492" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$capH_{c,1}$'</span>,</span>
<span id="cb28-493"><a href="#cb28-493" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$capH_{c,2}$'</span>,</span>
<span id="cb28-494"><a href="#cb28-494" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">omega_{c,1}$'</span>,</span>
<span id="cb28-495"><a href="#cb28-495" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">omega_{c,2}$'</span>,</span>
<span id="cb28-496"><a href="#cb28-496" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">omega_{c,3}$'</span>,</span>
<span id="cb28-497"><a href="#cb28-497" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">kappa_{c,1}$'</span>,</span>
<span id="cb28-498"><a href="#cb28-498" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">kappa_{c,2}$'</span>,</span>
<span id="cb28-499"><a href="#cb28-499" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">kappa_{c,3}$'</span>,</span>
<span id="cb28-500"><a href="#cb28-500" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">omega_{T,c}$'</span>,</span>
<span id="cb28-501"><a href="#cb28-501" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{logS2m}$'</span>,</span>
<span id="cb28-502"><a href="#cb28-502" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{dlogS2}$'</span>,</span>
<span id="cb28-503"><a href="#cb28-503" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{</span><span class="sc">\\</span><span class="st">alpha m_1}$'</span>,</span>
<span id="cb28-504"><a href="#cb28-504" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{</span><span class="sc">\\</span><span class="st">alpha m_2}$'</span>,</span>
<span id="cb28-505"><a href="#cb28-505" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{d</span><span class="sc">\\</span><span class="st">alpha_1}$'</span>,</span>
<span id="cb28-506"><a href="#cb28-506" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">hat{d</span><span class="sc">\\</span><span class="st">alpha_2}$'</span>,</span>
<span id="cb28-507"><a href="#cb28-507" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">tau_1$'</span>,</span>
<span id="cb28-508"><a href="#cb28-508" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">tau_2$'</span>,</span>
<span id="cb28-509"><a href="#cb28-509" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$</span><span class="sc">\\</span><span class="st">tau_3$'</span>,</span>
<span id="cb28-510"><a href="#cb28-510" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$m</span><span class="sc">\\</span><span class="st">sigma$'</span>,</span>
<span id="cb28-511"><a href="#cb28-511" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$s</span><span class="sc">\\</span><span class="st">sigma$'</span>,</span>
<span id="cb28-512"><a href="#cb28-512" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$clogmsigma_c$'</span>,</span>
<span id="cb28-513"><a href="#cb28-513" aria-hidden="true" tabindex="-1"></a>         <span class="st">'$c</span><span class="sc">\\</span><span class="st">sigma_c$'</span>)</span>
<span id="cb28-514"><a href="#cb28-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-515"><a href="#cb28-515" aria-hidden="true" tabindex="-1"></a>Namecode <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'logkwHat'</span>,</span>
<span id="cb28-516"><a href="#cb28-516" aria-hidden="true" tabindex="-1"></a>         <span class="st">'S1mHat'</span>,</span>
<span id="cb28-517"><a href="#cb28-517" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dS1Hat'</span>,</span>
<span id="cb28-518"><a href="#cb28-518" aria-hidden="true" tabindex="-1"></a>         <span class="st">'beta[1]'</span>,</span>
<span id="cb28-519"><a href="#cb28-519" aria-hidden="true" tabindex="-1"></a>         <span class="st">'beta[2]'</span>,</span>
<span id="cb28-520"><a href="#cb28-520" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dlogkwHat[1]'</span>,</span>
<span id="cb28-521"><a href="#cb28-521" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dlogkwHat[2]'</span>,</span>
<span id="cb28-522"><a href="#cb28-522" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dS1mHat[1]'</span>,</span>
<span id="cb28-523"><a href="#cb28-523" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dS1mHat[2]'</span>,</span>
<span id="cb28-524"><a href="#cb28-524" aria-hidden="true" tabindex="-1"></a>         <span class="st">'ddS1Hat[1]'</span>,</span>
<span id="cb28-525"><a href="#cb28-525" aria-hidden="true" tabindex="-1"></a>         <span class="st">'ddS1Hat[2]'</span>,</span>
<span id="cb28-526"><a href="#cb28-526" aria-hidden="true" tabindex="-1"></a>         <span class="st">'apH[1]'</span>,</span>
<span id="cb28-527"><a href="#cb28-527" aria-hidden="true" tabindex="-1"></a>         <span class="st">'apH[2]'</span>,</span>
<span id="cb28-528"><a href="#cb28-528" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dlogkTHat'</span>,</span>
<span id="cb28-529"><a href="#cb28-529" aria-hidden="true" tabindex="-1"></a>         <span class="st">'omega[1]'</span>,</span>
<span id="cb28-530"><a href="#cb28-530" aria-hidden="true" tabindex="-1"></a>         <span class="st">'omega[2]'</span>,</span>
<span id="cb28-531"><a href="#cb28-531" aria-hidden="true" tabindex="-1"></a>         <span class="st">'omega[3]'</span>,</span>
<span id="cb28-532"><a href="#cb28-532" aria-hidden="true" tabindex="-1"></a>         <span class="st">'rho[2,1]'</span>,</span>
<span id="cb28-533"><a href="#cb28-533" aria-hidden="true" tabindex="-1"></a>         <span class="st">'omegaT'</span>,</span>
<span id="cb28-534"><a href="#cb28-534" aria-hidden="true" tabindex="-1"></a>         <span class="st">'kappa[1]'</span>,</span>
<span id="cb28-535"><a href="#cb28-535" aria-hidden="true" tabindex="-1"></a>         <span class="st">'kappa[2]'</span>,</span>
<span id="cb28-536"><a href="#cb28-536" aria-hidden="true" tabindex="-1"></a>         <span class="st">'kappa[3]'</span>,</span>
<span id="cb28-537"><a href="#cb28-537" aria-hidden="true" tabindex="-1"></a>         <span class="st">'clogkwHat[c]'</span>,</span>
<span id="cb28-538"><a href="#cb28-538" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cS1mHat[c]'</span>,</span>
<span id="cb28-539"><a href="#cb28-539" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cdS1Hat[c]'</span>,</span>
<span id="cb28-540"><a href="#cb28-540" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cbeta[c,1]'</span>,</span>
<span id="cb28-541"><a href="#cb28-541" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cbeta[c,2]'</span>,</span>
<span id="cb28-542"><a href="#cb28-542" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cdlogkwHat[c,1]'</span>,</span>
<span id="cb28-543"><a href="#cb28-543" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cdlogkwHat[c,2]'</span>,</span>
<span id="cb28-544"><a href="#cb28-544" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cdS1mHat[c,1]'</span>,</span>
<span id="cb28-545"><a href="#cb28-545" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cdS1mHat[c,2]'</span>,</span>
<span id="cb28-546"><a href="#cb28-546" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cddS1Hat[c,1]'</span>,</span>
<span id="cb28-547"><a href="#cb28-547" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cddS1Hat[c,2]'</span>,</span>
<span id="cb28-548"><a href="#cb28-548" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cdlogkTHat[c]'</span>,</span>
<span id="cb28-549"><a href="#cb28-549" aria-hidden="true" tabindex="-1"></a>         <span class="st">'capH[c,1]'</span>,</span>
<span id="cb28-550"><a href="#cb28-550" aria-hidden="true" tabindex="-1"></a>         <span class="st">'capH[c,2]'</span>,</span>
<span id="cb28-551"><a href="#cb28-551" aria-hidden="true" tabindex="-1"></a>         <span class="st">'comega[c,1]'</span>,</span>
<span id="cb28-552"><a href="#cb28-552" aria-hidden="true" tabindex="-1"></a>         <span class="st">'comega[c,2]'</span>,</span>
<span id="cb28-553"><a href="#cb28-553" aria-hidden="true" tabindex="-1"></a>         <span class="st">'comega[c,3]'</span>,</span>
<span id="cb28-554"><a href="#cb28-554" aria-hidden="true" tabindex="-1"></a>         <span class="st">'ckappa[c,1]'</span>,</span>
<span id="cb28-555"><a href="#cb28-555" aria-hidden="true" tabindex="-1"></a>         <span class="st">'ckappa[c,2]'</span>,</span>
<span id="cb28-556"><a href="#cb28-556" aria-hidden="true" tabindex="-1"></a>         <span class="st">'ckappa[c,3]'</span>,</span>
<span id="cb28-557"><a href="#cb28-557" aria-hidden="true" tabindex="-1"></a>         <span class="st">'comegaT[c]'</span>,</span>
<span id="cb28-558"><a href="#cb28-558" aria-hidden="true" tabindex="-1"></a>         <span class="st">'logS2mHat'</span>,</span>
<span id="cb28-559"><a href="#cb28-559" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dlogS2Hat'</span>,</span>
<span id="cb28-560"><a href="#cb28-560" aria-hidden="true" tabindex="-1"></a>         <span class="st">'alphamHat[1]'</span>,</span>
<span id="cb28-561"><a href="#cb28-561" aria-hidden="true" tabindex="-1"></a>         <span class="st">'alphamHat[2]'</span>,</span>
<span id="cb28-562"><a href="#cb28-562" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dalphaHat[1]'</span>,</span>
<span id="cb28-563"><a href="#cb28-563" aria-hidden="true" tabindex="-1"></a>         <span class="st">'dalphaHat[2]'</span>,</span>
<span id="cb28-564"><a href="#cb28-564" aria-hidden="true" tabindex="-1"></a>         <span class="st">'tau[1]'</span>,</span>
<span id="cb28-565"><a href="#cb28-565" aria-hidden="true" tabindex="-1"></a>         <span class="st">'tau[2]'</span>,</span>
<span id="cb28-566"><a href="#cb28-566" aria-hidden="true" tabindex="-1"></a>         <span class="st">'tau[3]'</span>,</span>
<span id="cb28-567"><a href="#cb28-567" aria-hidden="true" tabindex="-1"></a>         <span class="st">'msigma'</span>,</span>
<span id="cb28-568"><a href="#cb28-568" aria-hidden="true" tabindex="-1"></a>         <span class="st">'ssigma'</span>,</span>
<span id="cb28-569"><a href="#cb28-569" aria-hidden="true" tabindex="-1"></a>         <span class="st">'clogmsigma[c]'</span>,</span>
<span id="cb28-570"><a href="#cb28-570" aria-hidden="true" tabindex="-1"></a>         <span class="st">'cssigma[c]'</span>)</span>
<span id="cb28-571"><a href="#cb28-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-572"><a href="#cb28-572" aria-hidden="true" tabindex="-1"></a>Description <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'typical logkw [Neutral]'</span>,</span>
<span id="cb28-573"><a href="#cb28-573" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of MeOH on logkw [Neutral]'</span>,</span>
<span id="cb28-574"><a href="#cb28-574" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of ACN on S1m [Neutral]'</span>,</span>
<span id="cb28-575"><a href="#cb28-575" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of logP on logkw [Neutral]'</span>,</span>
<span id="cb28-576"><a href="#cb28-576" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of logP on S1m [Neutral]'</span>,</span>
<span id="cb28-577"><a href="#cb28-577" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of dissociation on logkw [Acids]'</span>,</span>
<span id="cb28-578"><a href="#cb28-578" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of dissociation on logkw [Bases]'</span>,</span>
<span id="cb28-579"><a href="#cb28-579" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of dissociation on S1m [Acids]'</span>,</span>
<span id="cb28-580"><a href="#cb28-580" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of dissociation on S1m [Bases]'</span>,</span>
<span id="cb28-581"><a href="#cb28-581" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of dissociation on dS1 [Acids]'</span>,</span>
<span id="cb28-582"><a href="#cb28-582" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of dissociation on dS1 [Bases]'</span>,</span>
<span id="cb28-583"><a href="#cb28-583" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of pH on logkw [Acids]'</span>,</span>
<span id="cb28-584"><a href="#cb28-584" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of pH on logkw [Bases]'</span>,</span>
<span id="cb28-585"><a href="#cb28-585" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of temperature on logkw'</span>,</span>
<span id="cb28-586"><a href="#cb28-586" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for logkw [Neutral]'</span>,</span>
<span id="cb28-587"><a href="#cb28-587" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for S1 [Neutral]'</span>,</span>
<span id="cb28-588"><a href="#cb28-588" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for dS1 [Neutral]'</span>,</span>
<span id="cb28-589"><a href="#cb28-589" aria-hidden="true" tabindex="-1"></a>                <span class="st">'correlation logkw vs S1 [Neutral]'</span>,</span>
<span id="cb28-590"><a href="#cb28-590" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for dlogkT [Neutral]'</span>,</span>
<span id="cb28-591"><a href="#cb28-591" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for dlogkw [Acids and Bases]'</span>,</span>
<span id="cb28-592"><a href="#cb28-592" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for dS1m [Acids and Bases]'</span>,</span>
<span id="cb28-593"><a href="#cb28-593" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for ddS1 [Acids and Bases]'</span>,</span>
<span id="cb28-594"><a href="#cb28-594" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on logkw [Neutral]'</span>,</span>
<span id="cb28-595"><a href="#cb28-595" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on S1m [Neutral]'</span>,</span>
<span id="cb28-596"><a href="#cb28-596" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on dS1 [Neutral]'</span>,</span>
<span id="cb28-597"><a href="#cb28-597" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on beta[1] [Neutral]'</span>,</span>
<span id="cb28-598"><a href="#cb28-598" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on beta[2] [Neutral]'</span>,</span>
<span id="cb28-599"><a href="#cb28-599" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on dlogkw [Acids]'</span>,</span>
<span id="cb28-600"><a href="#cb28-600" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on dlogkw [Bases]'</span>,</span>
<span id="cb28-601"><a href="#cb28-601" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on dS1m [Acids]'</span>,</span>
<span id="cb28-602"><a href="#cb28-602" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on dS1m [Bases]'</span>,</span>
<span id="cb28-603"><a href="#cb28-603" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on ddS1 [Acids]'</span>,</span>
<span id="cb28-604"><a href="#cb28-604" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on ddS1 [Bases]'</span>,</span>
<span id="cb28-605"><a href="#cb28-605" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on dlogkwT'</span>,</span>
<span id="cb28-606"><a href="#cb28-606" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on apH [Acids]'</span>,</span>
<span id="cb28-607"><a href="#cb28-607" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on apH [Bases]'</span>,</span>
<span id="cb28-608"><a href="#cb28-608" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for clogkw [Neutral]'</span>,</span>
<span id="cb28-609"><a href="#cb28-609" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for cS1 [Neutral]'</span>,</span>
<span id="cb28-610"><a href="#cb28-610" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for cdS1 [Neutral]'</span>,</span>
<span id="cb28-611"><a href="#cb28-611" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for cdlogkw [Acids and Bases]'</span>,</span>
<span id="cb28-612"><a href="#cb28-612" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for cdS1m [Acids and Bases]'</span>,</span>
<span id="cb28-613"><a href="#cb28-613" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for cddS1 [Acids and Bases]'</span>,</span>
<span id="cb28-614"><a href="#cb28-614" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for dlogkT'</span>,</span>
<span id="cb28-615"><a href="#cb28-615" aria-hidden="true" tabindex="-1"></a>                <span class="st">'typical value of S2m (log10 scale)'</span>,</span>
<span id="cb28-616"><a href="#cb28-616" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of ACN on logS2m'</span>,</span>
<span id="cb28-617"><a href="#cb28-617" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of MeOH on pKa [Acids]'</span>,</span>
<span id="cb28-618"><a href="#cb28-618" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of MeOH on pKa [Bases]'</span>,</span>
<span id="cb28-619"><a href="#cb28-619" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of ACN on alpham [Acids]'</span>,</span>
<span id="cb28-620"><a href="#cb28-620" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of ACN on alpham [Bases]'</span>,</span>
<span id="cb28-621"><a href="#cb28-621" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for pKalit'</span>,</span>
<span id="cb28-622"><a href="#cb28-622" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for alpham'</span>,</span>
<span id="cb28-623"><a href="#cb28-623" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV for dalpha'</span>,</span>
<span id="cb28-624"><a href="#cb28-624" aria-hidden="true" tabindex="-1"></a>                <span class="st">'typical sd of residuals for XBridge'</span>,</span>
<span id="cb28-625"><a href="#cb28-625" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV of residuals for XBridge'</span>,</span>
<span id="cb28-626"><a href="#cb28-626" aria-hidden="true" tabindex="-1"></a>                <span class="st">'effect of column c on msigma (log scale)'</span>,</span>
<span id="cb28-627"><a href="#cb28-627" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sd of BAV of residuals for column c'</span></span>
<span id="cb28-628"><a href="#cb28-628" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb28-629"><a href="#cb28-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-630"><a href="#cb28-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-631"><a href="#cb28-631" aria-hidden="true" tabindex="-1"></a>Priors <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'N(2.2,2)'</span>,</span>
<span id="cb28-632"><a href="#cb28-632" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(4, 1)'</span>,</span>
<span id="cb28-633"><a href="#cb28-633" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(1, 1)'</span>,</span>
<span id="cb28-634"><a href="#cb28-634" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(1, 0.125)'</span>,</span>
<span id="cb28-635"><a href="#cb28-635" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0.5, 0.5)'</span>,</span>
<span id="cb28-636"><a href="#cb28-636" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(-1, 0.125)'</span>,</span>
<span id="cb28-637"><a href="#cb28-637" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(-1, 0.125)'</span>,</span>
<span id="cb28-638"><a href="#cb28-638" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.5)'</span>,</span>
<span id="cb28-639"><a href="#cb28-639" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.5)'</span>,</span>
<span id="cb28-640"><a href="#cb28-640" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.25)'</span>,</span>
<span id="cb28-641"><a href="#cb28-641" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.25)'</span>,</span>
<span id="cb28-642"><a href="#cb28-642" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.1)'</span>,</span>
<span id="cb28-643"><a href="#cb28-643" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.1)'</span>,</span>
<span id="cb28-644"><a href="#cb28-644" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(-0.087, 0.022)'</span>,</span>
<span id="cb28-645"><a href="#cb28-645" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 2)'</span>,</span>
<span id="cb28-646"><a href="#cb28-646" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 2)'</span>,</span>
<span id="cb28-647"><a href="#cb28-647" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 2)'</span>,</span>
<span id="cb28-648"><a href="#cb28-648" aria-hidden="true" tabindex="-1"></a>         <span class="st">'LKJCORRN(0.75, 0.125)'</span>,</span>
<span id="cb28-649"><a href="#cb28-649" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.022)'</span>,</span>
<span id="cb28-650"><a href="#cb28-650" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.25)'</span>,</span>
<span id="cb28-651"><a href="#cb28-651" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.25)'</span>,</span>
<span id="cb28-652"><a href="#cb28-652" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.25)'</span>,</span>
<span id="cb28-653"><a href="#cb28-653" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 1)'</span>,</span>
<span id="cb28-654"><a href="#cb28-654" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.5)'</span>,</span>
<span id="cb28-655"><a href="#cb28-655" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.5)'</span>,</span>
<span id="cb28-656"><a href="#cb28-656" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.25)'</span>,</span>
<span id="cb28-657"><a href="#cb28-657" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.25)'</span>,</span>
<span id="cb28-658"><a href="#cb28-658" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.0625)'</span>,</span>
<span id="cb28-659"><a href="#cb28-659" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.0625)'</span>,</span>
<span id="cb28-660"><a href="#cb28-660" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.25)'</span>,</span>
<span id="cb28-661"><a href="#cb28-661" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.25)'</span>,</span>
<span id="cb28-662"><a href="#cb28-662" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.125)'</span>,</span>
<span id="cb28-663"><a href="#cb28-663" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.125)'</span>,</span>
<span id="cb28-664"><a href="#cb28-664" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.011)'</span>,</span>
<span id="cb28-665"><a href="#cb28-665" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.05)'</span>,</span>
<span id="cb28-666"><a href="#cb28-666" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.05)'</span>,</span>
<span id="cb28-667"><a href="#cb28-667" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 1)'</span>,</span>
<span id="cb28-668"><a href="#cb28-668" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 1)'</span>,</span>
<span id="cb28-669"><a href="#cb28-669" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 1)'</span>,</span>
<span id="cb28-670"><a href="#cb28-670" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.125)'</span>,</span>
<span id="cb28-671"><a href="#cb28-671" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.125)'</span>,</span>
<span id="cb28-672"><a href="#cb28-672" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.125)'</span>,</span>
<span id="cb28-673"><a href="#cb28-673" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.011)'</span>,</span>
<span id="cb28-674"><a href="#cb28-674" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(-0.7, 0.125);'</span>,</span>
<span id="cb28-675"><a href="#cb28-675" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(1, 0.125);'</span>,</span>
<span id="cb28-676"><a href="#cb28-676" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(2, 0.25)'</span>,</span>
<span id="cb28-677"><a href="#cb28-677" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(-1, 0.25)'</span>,</span>
<span id="cb28-678"><a href="#cb28-678" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.125)'</span>,</span>
<span id="cb28-679"><a href="#cb28-679" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0, 0.125)'</span>,</span>
<span id="cb28-680"><a href="#cb28-680" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.25)'</span>,</span>
<span id="cb28-681"><a href="#cb28-681" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.125)'</span>,</span>
<span id="cb28-682"><a href="#cb28-682" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0, 0.125)'</span>,</span>
<span id="cb28-683"><a href="#cb28-683" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0,1)'</span>,</span>
<span id="cb28-684"><a href="#cb28-684" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N(0,1)'</span>,</span>
<span id="cb28-685"><a href="#cb28-685" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0,125)'</span>,</span>
<span id="cb28-686"><a href="#cb28-686" aria-hidden="true" tabindex="-1"></a>         <span class="st">'N+(0,125)'</span>)</span>
<span id="cb28-687"><a href="#cb28-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-688"><a href="#cb28-688" aria-hidden="true" tabindex="-1"></a>table_of_parameters <span class="ot">=</span> <span class="fu">data.frame</span>(Name,Namecode,Description,Priors)</span>
<span id="cb28-689"><a href="#cb28-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-690"><a href="#cb28-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-691"><a href="#cb28-691" aria-hidden="true" tabindex="-1"></a>table_of_parameters <span class="sc">%&gt;%</span></span>
<span id="cb28-692"><a href="#cb28-692" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">"Desciption of model paramters"</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">longtable=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-693"><a href="#cb28-693" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-694"><a href="#cb28-694" aria-hidden="true" tabindex="-1"></a>kableExtra<span class="sc">::</span><span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"repeat_header"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-695"><a href="#cb28-695" aria-hidden="true" tabindex="-1"></a> kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">"XBridge Shield RP18 parameters"</span>, <span class="dv">1</span>, <span class="dv">22</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-696"><a href="#cb28-696" aria-hidden="true" tabindex="-1"></a> kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">"between column differences"</span>, <span class="dv">23</span>, <span class="dv">43</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-697"><a href="#cb28-697" aria-hidden="true" tabindex="-1"></a> kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">"S2"</span>, <span class="dv">44</span>, <span class="dv">45</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-698"><a href="#cb28-698" aria-hidden="true" tabindex="-1"></a> kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">"pKa"</span>, <span class="dv">46</span>, <span class="dv">52</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-699"><a href="#cb28-699" aria-hidden="true" tabindex="-1"></a> kableExtra<span class="sc">::</span><span class="fu">pack_rows</span>(<span class="st">"Residuals"</span>, <span class="dv">53</span>, <span class="dv">56</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-700"><a href="#cb28-700" aria-hidden="true" tabindex="-1"></a> <span class="fu">unclass</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-701"><a href="#cb28-701" aria-hidden="true" tabindex="-1"></a> <span class="fu">cat</span>()</span>
<span id="cb28-702"><a href="#cb28-702" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb28-703"><a href="#cb28-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-704"><a href="#cb28-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-705"><a href="#cb28-705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Stan</span></span>
<span id="cb28-706"><a href="#cb28-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-707"><a href="#cb28-707" aria-hidden="true" tabindex="-1"></a>Multilevel modeling was performed in <span class="co">[</span><span class="ot">Stan software</span><span class="co">](https://mc-stan.org/)</span> linked with R/ <span class="co">[</span><span class="ot">cmdstanr</span><span class="co">](https://mc-stan.org/cmdstanr/)</span>. For the inference we used the follwoing settings: number of iterations = 500, warmup = 1000, and number of Markov chains = 8. The reduce_sum function, which was selected to accelerate the calculations, works by parallelizing the execution of a single Stan chain across multiple cores. Convergence diagnostics were checked using Gelman−Rubin statistics and trace plots.</span>
<span id="cb28-708"><a href="#cb28-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-709"><a href="#cb28-709" aria-hidden="true" tabindex="-1"></a><span class="fu">### Initialize variables and parameters</span></span>
<span id="cb28-710"><a href="#cb28-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-711"><a href="#cb28-711" aria-hidden="true" tabindex="-1"></a><span class="in">```{r stansetup}</span></span>
<span id="cb28-712"><a href="#cb28-712" aria-hidden="true" tabindex="-1"></a><span class="co"># create Stan data set:</span></span>
<span id="cb28-713"><a href="#cb28-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-714"><a href="#cb28-714" aria-hidden="true" tabindex="-1"></a>datastruct <span class="ot">&lt;-</span> <span class="fu">with</span>(data,</span>
<span id="cb28-715"><a href="#cb28-715" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">list</span>(<span class="at">nAnalytes=</span><span class="fu">length</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID)),</span>
<span id="cb28-716"><a href="#cb28-716" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nModifiers=</span><span class="fu">length</span>(<span class="fu">unique</span>(data<span class="sc">$</span>Mod2)),</span>
<span id="cb28-717"><a href="#cb28-717" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nColumns=</span><span class="fu">length</span>(<span class="fu">unique</span>(data<span class="sc">$</span>Column)),</span>
<span id="cb28-718"><a href="#cb28-718" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nObs=</span><span class="fu">length</span>(data<span class="sc">$</span>METID),</span>
<span id="cb28-719"><a href="#cb28-719" aria-hidden="true" tabindex="-1"></a>                       <span class="at">analyte=</span><span class="fu">match</span>(data<span class="sc">$</span>METID, <span class="fu">unique</span>(data<span class="sc">$</span>METID)),</span>
<span id="cb28-720"><a href="#cb28-720" aria-hidden="true" tabindex="-1"></a>                       <span class="at">modifier=</span><span class="fu">match</span>(data<span class="sc">$</span>Mod2, <span class="fu">sort</span>(<span class="fu">unique</span>(data<span class="sc">$</span>Mod2))),</span>
<span id="cb28-721"><a href="#cb28-721" aria-hidden="true" tabindex="-1"></a>                       <span class="at">column=</span><span class="fu">match</span>(data<span class="sc">$</span>Column, <span class="fu">unique</span>(data<span class="sc">$</span>Column)),</span>
<span id="cb28-722"><a href="#cb28-722" aria-hidden="true" tabindex="-1"></a>                       <span class="at">steps=</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">-</span>data<span class="sc">$</span>Mod2) <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>(data<span class="sc">$</span>Mod2<span class="dv">-1</span>),</span>
<span id="cb28-723"><a href="#cb28-723" aria-hidden="true" tabindex="-1"></a>                       <span class="at">hplcparam=</span><span class="fu">cbind</span>(data<span class="sc">$</span>tg,data<span class="sc">$</span>td,data<span class="sc">$</span>to,data<span class="sc">$</span>te,data<span class="sc">$</span>fio,data<span class="sc">$</span>fik,data<span class="sc">$</span>Mod2<span class="dv">-1</span>,data<span class="sc">$</span>pHo,</span>
<span id="cb28-724"><a href="#cb28-724" aria-hidden="true" tabindex="-1"></a>                                       data<span class="sc">$</span>alpha1,data<span class="sc">$</span>alpha2,(data<span class="sc">$</span>Temp<span class="dv">-25</span>)<span class="sc">/</span><span class="dv">10</span>,data<span class="sc">$</span>Column<span class="dv">-1</span>),</span>
<span id="cb28-725"><a href="#cb28-725" aria-hidden="true" tabindex="-1"></a>                       <span class="at">logPobs=</span>logPobs, </span>
<span id="cb28-726"><a href="#cb28-726" aria-hidden="true" tabindex="-1"></a>                       <span class="at">maxR=</span>maxR,</span>
<span id="cb28-727"><a href="#cb28-727" aria-hidden="true" tabindex="-1"></a>                       <span class="at">R=</span>R,</span>
<span id="cb28-728"><a href="#cb28-728" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nGroupsA=</span>nGroupsA,</span>
<span id="cb28-729"><a href="#cb28-729" aria-hidden="true" tabindex="-1"></a>                       <span class="at">nGroupsB=</span>nGroupsB,</span>
<span id="cb28-730"><a href="#cb28-730" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pKaslitA=</span>pKaslitA,</span>
<span id="cb28-731"><a href="#cb28-731" aria-hidden="true" tabindex="-1"></a>                       <span class="at">pKaslitB=</span>pKaslitB,</span>
<span id="cb28-732"><a href="#cb28-732" aria-hidden="true" tabindex="-1"></a>                       <span class="at">idxGroupsA=</span>idxGroupsA,</span>
<span id="cb28-733"><a href="#cb28-733" aria-hidden="true" tabindex="-1"></a>                       <span class="at">idxGroupsB=</span>idxGroupsB,</span>
<span id="cb28-734"><a href="#cb28-734" aria-hidden="true" tabindex="-1"></a>                       <span class="at">trobs=</span>data<span class="sc">$</span>RT,</span>
<span id="cb28-735"><a href="#cb28-735" aria-hidden="true" tabindex="-1"></a>                       <span class="at">run_estimation=</span><span class="dv">1</span>))</span>
<span id="cb28-736"><a href="#cb28-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-737"><a href="#cb28-737" aria-hidden="true" tabindex="-1"></a><span class="co"># initialize the values for each variable in each chain:</span></span>
<span id="cb28-738"><a href="#cb28-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-739"><a href="#cb28-739" aria-hidden="true" tabindex="-1"></a>init <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb28-740"><a href="#cb28-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(   <span class="at">logkwHat  =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">2.2</span>,<span class="dv">2</span>),</span>
<span id="cb28-741"><a href="#cb28-741" aria-hidden="true" tabindex="-1"></a>          <span class="at">S1mHat    =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">1</span>),</span>
<span id="cb28-742"><a href="#cb28-742" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1Hat    =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.5</span>),</span>
<span id="cb28-743"><a href="#cb28-743" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogkwHat =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="fl">0.125</span>),</span>
<span id="cb28-744"><a href="#cb28-744" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1mHat   =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="fl">0.5</span>),</span>
<span id="cb28-745"><a href="#cb28-745" aria-hidden="true" tabindex="-1"></a>          <span class="at">ddS1Hat   =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb28-746"><a href="#cb28-746" aria-hidden="true" tabindex="-1"></a>          <span class="at">logS2mHat =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.7</span>,<span class="fl">0.125</span>),</span>
<span id="cb28-747"><a href="#cb28-747" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogS2Hat =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.125</span>),</span>
<span id="cb28-748"><a href="#cb28-748" aria-hidden="true" tabindex="-1"></a>          <span class="at">beta  =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>),<span class="fu">c</span>(<span class="fl">0.125</span>,<span class="fl">0.5</span>)),</span>
<span id="cb28-749"><a href="#cb28-749" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogkTHat    =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.087</span>,<span class="fl">0.0022</span>),</span>
<span id="cb28-750"><a href="#cb28-750" aria-hidden="true" tabindex="-1"></a>          <span class="at">apH  =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="fl">0.1</span>),</span>
<span id="cb28-751"><a href="#cb28-751" aria-hidden="true" tabindex="-1"></a>          <span class="at">alphamHat  =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">2</span>,<span class="sc">-</span><span class="dv">1</span>),<span class="fl">0.25</span>),</span>
<span id="cb28-752"><a href="#cb28-752" aria-hidden="true" tabindex="-1"></a>          <span class="at">dalphaHat =</span> <span class="fu">rnorm</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="fl">0.125</span>),</span>
<span id="cb28-753"><a href="#cb28-753" aria-hidden="true" tabindex="-1"></a>          <span class="at">tau   =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.125</span>,<span class="fl">0.125</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">0.2</span>)),</span>
<span id="cb28-754"><a href="#cb28-754" aria-hidden="true" tabindex="-1"></a>          <span class="at">omega =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)),</span>
<span id="cb28-755"><a href="#cb28-755" aria-hidden="true" tabindex="-1"></a>          <span class="at">rho =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.75</span>, <span class="fl">0.75</span>, <span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>),</span>
<span id="cb28-756"><a href="#cb28-756" aria-hidden="true" tabindex="-1"></a>          <span class="at">omegaT  =</span> <span class="fu">rlnorm</span>(<span class="dv">1</span>,<span class="fu">log</span>(<span class="fl">0.022</span>),<span class="fl">0.2</span>), </span>
<span id="cb28-757"><a href="#cb28-757" aria-hidden="true" tabindex="-1"></a>          <span class="at">kappa =</span> <span class="fl">0.25</span><span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">rnorm</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="fl">0.2</span>)),</span>
<span id="cb28-758"><a href="#cb28-758" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb28-759"><a href="#cb28-759" aria-hidden="true" tabindex="-1"></a>          <span class="at">clogkwHat  =</span>  <span class="fu">rnorm</span>(nColumns<span class="dv">-1</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb28-760"><a href="#cb28-760" aria-hidden="true" tabindex="-1"></a>          <span class="at">cS1mHat  =</span>  <span class="fu">rnorm</span>(nColumns<span class="dv">-1</span>,<span class="dv">0</span>,<span class="fl">0.5</span>),</span>
<span id="cb28-761"><a href="#cb28-761" aria-hidden="true" tabindex="-1"></a>          <span class="at">cdS1Hat  =</span>  <span class="fu">rnorm</span>(nColumns<span class="dv">-1</span>,<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb28-762"><a href="#cb28-762" aria-hidden="true" tabindex="-1"></a>          <span class="at">cdlogkwHat =</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.0625</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-763"><a href="#cb28-763" aria-hidden="true" tabindex="-1"></a>          <span class="at">cdS1mHat =</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.25</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-764"><a href="#cb28-764" aria-hidden="true" tabindex="-1"></a>          <span class="at">cddS1Hat =</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.125</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-765"><a href="#cb28-765" aria-hidden="true" tabindex="-1"></a>          <span class="at">cbeta  =</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.25</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-766"><a href="#cb28-766" aria-hidden="true" tabindex="-1"></a>          <span class="at">cdlogkTHat =</span> <span class="fu">rnorm</span>(nColumns<span class="dv">-1</span>,<span class="dv">0</span>,<span class="fl">0.011</span>),</span>
<span id="cb28-767"><a href="#cb28-767" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb28-768"><a href="#cb28-768" aria-hidden="true" tabindex="-1"></a>          <span class="at">capH   =</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">2</span><span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.05</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-769"><a href="#cb28-769" aria-hidden="true" tabindex="-1"></a>          <span class="at">comega =</span> <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">3</span><span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>))),</span>
<span id="cb28-770"><a href="#cb28-770" aria-hidden="true" tabindex="-1"></a>          <span class="at">ckappa =</span> <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">3</span><span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.125</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>))),</span>
<span id="cb28-771"><a href="#cb28-771" aria-hidden="true" tabindex="-1"></a>          <span class="at">comegaT =</span> <span class="fl">0.1</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">1</span><span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.011</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>))),</span>
<span id="cb28-772"><a href="#cb28-772" aria-hidden="true" tabindex="-1"></a>          <span class="at">corr_L =</span> <span class="fu">diag</span>(nColumns<span class="dv">-1</span>),</span>
<span id="cb28-773"><a href="#cb28-773" aria-hidden="true" tabindex="-1"></a>          <span class="at">paramN =</span>  <span class="fu">cbind</span>(<span class="dv">2</span><span class="fl">+0.75</span><span class="sc">*</span>(logPobs<span class="fl">-2.2</span>), <span class="dv">4</span><span class="sc">*</span><span class="fu">matrix</span>(<span class="dv">1</span>,nAnalytes,<span class="dv">1</span>)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span>(logPobs<span class="fl">-2.2</span>)),</span>
<span id="cb28-774"><a href="#cb28-774" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1N   =</span>  <span class="fu">matrix</span>(<span class="dv">0</span>,nAnalytes,<span class="dv">1</span>),</span>
<span id="cb28-775"><a href="#cb28-775" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogkT =</span> <span class="fu">rnorm</span>(nAnalytes,<span class="sc">-</span><span class="fl">0.0868</span>,<span class="fl">0.0217</span>),</span>
<span id="cb28-776"><a href="#cb28-776" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogkwA =</span> <span class="fu">matrix</span>(<span class="sc">-</span><span class="dv">1</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-777"><a href="#cb28-777" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogkwB =</span> <span class="fu">matrix</span>(<span class="sc">-</span><span class="dv">1</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-778"><a href="#cb28-778" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1mA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-779"><a href="#cb28-779" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1mB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-780"><a href="#cb28-780" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1A =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-781"><a href="#cb28-781" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1B =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-782"><a href="#cb28-782" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb28-783"><a href="#cb28-783" aria-hidden="true" tabindex="-1"></a>          <span class="at">etaclogkwNStd =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nAnalytes),</span>
<span id="cb28-784"><a href="#cb28-784" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacS1mN =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nAnalytes),</span>
<span id="cb28-785"><a href="#cb28-785" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1N =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nAnalytes),</span>
<span id="cb28-786"><a href="#cb28-786" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdlogkT =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nAnalytes),</span>
<span id="cb28-787"><a href="#cb28-787" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdlogkwA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsA),</span>
<span id="cb28-788"><a href="#cb28-788" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdlogkwB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsB),</span>
<span id="cb28-789"><a href="#cb28-789" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1mA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsA),</span>
<span id="cb28-790"><a href="#cb28-790" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1mB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsB),</span>
<span id="cb28-791"><a href="#cb28-791" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1A =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsA),</span>
<span id="cb28-792"><a href="#cb28-792" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1B =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>, nGroupsB),</span>
<span id="cb28-793"><a href="#cb28-793" aria-hidden="true" tabindex="-1"></a>          <span class="at">pKawA =</span> pKaslitA,</span>
<span id="cb28-794"><a href="#cb28-794" aria-hidden="true" tabindex="-1"></a>          <span class="at">pKawB =</span> pKaslitB,</span>
<span id="cb28-795"><a href="#cb28-795" aria-hidden="true" tabindex="-1"></a>          <span class="at">etaalphamA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-796"><a href="#cb28-796" aria-hidden="true" tabindex="-1"></a>          <span class="at">etaalphamB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-797"><a href="#cb28-797" aria-hidden="true" tabindex="-1"></a>          <span class="at">etadalphaA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-798"><a href="#cb28-798" aria-hidden="true" tabindex="-1"></a>          <span class="at">etadalphaB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-799"><a href="#cb28-799" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb28-800"><a href="#cb28-800" aria-hidden="true" tabindex="-1"></a>          <span class="at">msigma  =</span> <span class="fu">rlnorm</span>(<span class="dv">1</span>,<span class="fu">log</span>(<span class="dv">1</span>),<span class="fl">0.2</span>),</span>
<span id="cb28-801"><a href="#cb28-801" aria-hidden="true" tabindex="-1"></a>          <span class="at">ssigma  =</span> <span class="fu">rlnorm</span>(<span class="dv">1</span>,<span class="fu">log</span>(<span class="fl">0.2</span>),<span class="fl">0.2</span>),</span>
<span id="cb28-802"><a href="#cb28-802" aria-hidden="true" tabindex="-1"></a>          <span class="at">logsigma   =</span> <span class="fu">rnorm</span>(nAnalytes,<span class="dv">0</span>,<span class="fl">0.2</span>),</span>
<span id="cb28-803"><a href="#cb28-803" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb28-804"><a href="#cb28-804" aria-hidden="true" tabindex="-1"></a>          <span class="at">clogmsigma  =</span> <span class="fu">rnorm</span>(nColumns<span class="dv">-1</span>,<span class="dv">0</span>,<span class="fl">0.125</span>),</span>
<span id="cb28-805"><a href="#cb28-805" aria-hidden="true" tabindex="-1"></a>          <span class="at">cssigma     =</span> <span class="fu">rlnorm</span>(nColumns<span class="dv">-1</span>,<span class="fu">log</span>(<span class="fl">0.125</span>),<span class="fl">0.125</span>),</span>
<span id="cb28-806"><a href="#cb28-806" aria-hidden="true" tabindex="-1"></a>          <span class="at">etaclogsigma   =</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(nAnalytes<span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.125</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>))</span>
<span id="cb28-807"><a href="#cb28-807" aria-hidden="true" tabindex="-1"></a>          </span>
<span id="cb28-808"><a href="#cb28-808" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-809"><a href="#cb28-809" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-810"><a href="#cb28-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-811"><a href="#cb28-811" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-812"><a href="#cb28-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-813"><a href="#cb28-813" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Stan model:</span></span>
<span id="cb28-814"><a href="#cb28-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-815"><a href="#cb28-815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r stancode}</span></span>
<span id="cb28-816"><a href="#cb28-816" aria-hidden="true" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">readLines</span>(<span class="st">"stan/hplc-gra-fivecolumns.stan"</span>))</span>
<span id="cb28-817"><a href="#cb28-817" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-818"><a href="#cb28-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-819"><a href="#cb28-819" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fitting the model</span></span>
<span id="cb28-820"><a href="#cb28-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-821"><a href="#cb28-821" aria-hidden="true" tabindex="-1"></a>Compile the model:</span>
<span id="cb28-822"><a href="#cb28-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-823"><a href="#cb28-823" aria-hidden="true" tabindex="-1"></a><span class="in">```{r stancompile, eval = FALSE}</span></span>
<span id="cb28-824"><a href="#cb28-824" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns.stan"</span>, </span>
<span id="cb28-825"><a href="#cb28-825" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>), </span>
<span id="cb28-826"><a href="#cb28-826" aria-hidden="true" tabindex="-1"></a>                      <span class="at">cpp_options =</span> <span class="fu">list</span>(<span class="at">stan_threads =</span> <span class="cn">TRUE</span>))</span>
<span id="cb28-827"><a href="#cb28-827" aria-hidden="true" tabindex="-1"></a><span class="co"># for optimization</span></span>
<span id="cb28-828"><a href="#cb28-828" aria-hidden="true" tabindex="-1"></a>modode <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns.stan"</span>, </span>
<span id="cb28-829"><a href="#cb28-829" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb28-830"><a href="#cb28-830" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-831"><a href="#cb28-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-832"><a href="#cb28-832" aria-hidden="true" tabindex="-1"></a>The optimization was used for initial testing:</span>
<span id="cb28-833"><a href="#cb28-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-834"><a href="#cb28-834" aria-hidden="true" tabindex="-1"></a><span class="in">```{r stanoptimize, eval = FALSE}</span></span>
<span id="cb28-835"><a href="#cb28-835" aria-hidden="true" tabindex="-1"></a>fit_ode <span class="ot">&lt;-</span> modode<span class="sc">$</span><span class="fu">optimize</span>(</span>
<span id="cb28-836"><a href="#cb28-836" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datastruct,</span>
<span id="cb28-837"><a href="#cb28-837" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>,</span>
<span id="cb28-838"><a href="#cb28-838" aria-hidden="true" tabindex="-1"></a>  <span class="at">init =</span> init</span>
<span id="cb28-839"><a href="#cb28-839" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-840"><a href="#cb28-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-841"><a href="#cb28-841" aria-hidden="true" tabindex="-1"></a>fit_ode<span class="sc">$</span><span class="fu">print</span>(<span class="at">max_rows=</span><span class="dv">100</span>)</span>
<span id="cb28-842"><a href="#cb28-842" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-843"><a href="#cb28-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-844"><a href="#cb28-844" aria-hidden="true" tabindex="-1"></a>For local computations one can use cmdstanr:</span>
<span id="cb28-845"><a href="#cb28-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-846"><a href="#cb28-846" aria-hidden="true" tabindex="-1"></a><span class="in">```{r stansample, eval = FALSE}</span></span>
<span id="cb28-847"><a href="#cb28-847" aria-hidden="true" tabindex="-1"></a><span class="co"># fit &lt;- mod1$sample(</span></span>
<span id="cb28-848"><a href="#cb28-848" aria-hidden="true" tabindex="-1"></a><span class="co">#   data = datastruct,</span></span>
<span id="cb28-849"><a href="#cb28-849" aria-hidden="true" tabindex="-1"></a><span class="co">#   output_dir = "stanfiles",</span></span>
<span id="cb28-850"><a href="#cb28-850" aria-hidden="true" tabindex="-1"></a><span class="co">#   init = init,</span></span>
<span id="cb28-851"><a href="#cb28-851" aria-hidden="true" tabindex="-1"></a><span class="co">#   iter_warmup = 1000,</span></span>
<span id="cb28-852"><a href="#cb28-852" aria-hidden="true" tabindex="-1"></a><span class="co">#   iter_sampling = 1000,</span></span>
<span id="cb28-853"><a href="#cb28-853" aria-hidden="true" tabindex="-1"></a><span class="co">#   chains = 4,</span></span>
<span id="cb28-854"><a href="#cb28-854" aria-hidden="true" tabindex="-1"></a><span class="co">#   parallel_chains = 4,</span></span>
<span id="cb28-855"><a href="#cb28-855" aria-hidden="true" tabindex="-1"></a><span class="co">#   threads_per_chain = 6,</span></span>
<span id="cb28-856"><a href="#cb28-856" aria-hidden="true" tabindex="-1"></a><span class="co">#   refresh = 100,</span></span>
<span id="cb28-857"><a href="#cb28-857" aria-hidden="true" tabindex="-1"></a><span class="co">#   adapt_delta=0.9</span></span>
<span id="cb28-858"><a href="#cb28-858" aria-hidden="true" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb28-859"><a href="#cb28-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-860"><a href="#cb28-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-861"><a href="#cb28-861" aria-hidden="true" tabindex="-1"></a>We performed computations at the Academic Computer Center in Gdańsk, <span class="co">[</span><span class="ot">Tryton Cluster</span><span class="co">](https://docs.task.gda.pl/kdm/zasoby-sprzetowe/tryton/)</span>. In this case:</span>
<span id="cb28-862"><a href="#cb28-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-863"><a href="#cb28-863" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>we dumped the necessary data to .json format</span>
<span id="cb28-864"><a href="#cb28-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-865"><a href="#cb28-865" aria-hidden="true" tabindex="-1"></a><span class="in">```{r dumpfiles, eval = FALSE}</span></span>
<span id="cb28-866"><a href="#cb28-866" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(datastruct, <span class="st">"stan/standata.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-867"><a href="#cb28-867" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(<span class="fu">init</span>(), <span class="st">"stan/init-1.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-868"><a href="#cb28-868" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(<span class="fu">init</span>(), <span class="st">"stan/init-2.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-869"><a href="#cb28-869" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(<span class="fu">init</span>(), <span class="st">"stan/init-3.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-870"><a href="#cb28-870" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(<span class="fu">init</span>(), <span class="st">"stan/init-4.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-871"><a href="#cb28-871" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(<span class="fu">init</span>(), <span class="st">"stan/init-5.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-872"><a href="#cb28-872" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(<span class="fu">init</span>(), <span class="st">"stan/init-6.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-873"><a href="#cb28-873" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(<span class="fu">init</span>(), <span class="st">"stan/init-7.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-874"><a href="#cb28-874" aria-hidden="true" tabindex="-1"></a><span class="fu">write_stan_json</span>(<span class="fu">init</span>(), <span class="st">"stan/init-8.json"</span>, <span class="at">always_decimal =</span> <span class="cn">FALSE</span>)</span>
<span id="cb28-875"><a href="#cb28-875" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-876"><a href="#cb28-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-877"><a href="#cb28-877" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>we run the model using the batch file:</span>
<span id="cb28-878"><a href="#cb28-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-879"><a href="#cb28-879" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb28-880"><a href="#cb28-880" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;pre&gt; </span></span>
<span id="cb28-881"><a href="#cb28-881" aria-hidden="true" tabindex="-1"></a><span class="in">#!/bin/bash -l</span></span>
<span id="cb28-882"><a href="#cb28-882" aria-hidden="true" tabindex="-1"></a><span class="in">#SBATCH --job-name=cmdstan_conda</span></span>
<span id="cb28-883"><a href="#cb28-883" aria-hidden="true" tabindex="-1"></a><span class="in">#SBATCH -N 1</span></span>
<span id="cb28-884"><a href="#cb28-884" aria-hidden="true" tabindex="-1"></a><span class="in">#SBATCH -n 24</span></span>
<span id="cb28-885"><a href="#cb28-885" aria-hidden="true" tabindex="-1"></a><span class="in">#SBATCH -p batch</span></span>
<span id="cb28-886"><a href="#cb28-886" aria-hidden="true" tabindex="-1"></a><span class="in">#SBATCH --time=48:00:00</span></span>
<span id="cb28-887"><a href="#cb28-887" aria-hidden="true" tabindex="-1"></a><span class="in">#SBATCH --mem=64gb</span></span>
<span id="cb28-888"><a href="#cb28-888" aria-hidden="true" tabindex="-1"></a><span class="in">#SBATCH --array=1-8%8</span></span>
<span id="cb28-889"><a href="#cb28-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-890"><a href="#cb28-890" aria-hidden="true" tabindex="-1"></a><span class="in">module load tryton/cmdstan/2.30.1-conda</span></span>
<span id="cb28-891"><a href="#cb28-891" aria-hidden="true" tabindex="-1"></a><span class="in">export STAN_THREADS=true</span></span>
<span id="cb28-892"><a href="#cb28-892" aria-hidden="true" tabindex="-1"></a><span class="in">export CMDSTAN_MODEL_NAME="hplc-gra-twocolumns"</span></span>
<span id="cb28-893"><a href="#cb28-893" aria-hidden="true" tabindex="-1"></a><span class="in">export MODEL_SRC_DIR=${TASK_USER_WORK}</span></span>
<span id="cb28-894"><a href="#cb28-894" aria-hidden="true" tabindex="-1"></a><span class="in">cd ${MODEL_SRC_DIR}</span></span>
<span id="cb28-895"><a href="#cb28-895" aria-hidden="true" tabindex="-1"></a><span class="in">[ -f ${CMDSTAN_MODEL_NAME} ] &amp;&amp; echo "Model "${CMDSTAN_MODEL_NAME}" exists" || cmdstan_model ${CMDSTAN_MODEL_NAME}</span></span>
<span id="cb28-896"><a href="#cb28-896" aria-hidden="true" tabindex="-1"></a><span class="in">wait</span></span>
<span id="cb28-897"><a href="#cb28-897" aria-hidden="true" tabindex="-1"></a><span class="in">${PWD}/${CMDSTAN_MODEL_NAME} sample num_samples=500 num_warmup=1000 algorithm=hmc engine=nuts max_depth=10 stepsize=0.01 adapt delta=0.9 data file=$PWD/standata.json init=$PWD/init-${SLURM_ARRAY_TASK_ID}.json  num_threads=${SLURM_NTASKS} output file=$PWD/output_${SLURM_ARRAY_TASK_ID}.csv </span></span>
<span id="cb28-898"><a href="#cb28-898" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/pre&gt;</span></span>
<span id="cb28-899"><a href="#cb28-899" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-900"><a href="#cb28-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-901"><a href="#cb28-901" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>After calculations, we loaded the output files using cmdstanr. The files are accessible through <span class="co">[</span><span class="ot">stan output files</span><span class="co">](https://cloud.gumed.edu.pl/s/MbHmekcg79w4ot4 "Stan output files")</span>.</span>
<span id="cb28-902"><a href="#cb28-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-903"><a href="#cb28-903" aria-hidden="true" tabindex="-1"></a><span class="in">```{r stanload}</span></span>
<span id="cb28-904"><a href="#cb28-904" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">as_cmdstan_fit</span>(<span class="fu">c</span>(</span>
<span id="cb28-905"><a href="#cb28-905" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_1.csv'</span>,</span>
<span id="cb28-906"><a href="#cb28-906" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_2.csv'</span>,</span>
<span id="cb28-907"><a href="#cb28-907" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_3.csv'</span>,</span>
<span id="cb28-908"><a href="#cb28-908" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_4.csv'</span>,</span>
<span id="cb28-909"><a href="#cb28-909" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_5.csv'</span>,</span>
<span id="cb28-910"><a href="#cb28-910" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_6.csv'</span>,</span>
<span id="cb28-911"><a href="#cb28-911" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_7.csv'</span>,</span>
<span id="cb28-912"><a href="#cb28-912" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_8.csv'</span></span>
<span id="cb28-913"><a href="#cb28-913" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-914"><a href="#cb28-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-915"><a href="#cb28-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-916"><a href="#cb28-916" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>finally we checked the diagnostics of Monte Carlo inferences based on the Stan documentation described here [](https://mc-stan.org/docs/cmdstan-guide/diagnose.html).</span>
<span id="cb28-917"><a href="#cb28-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-918"><a href="#cb28-918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r standiagnose, eval = FALSE}</span></span>
<span id="cb28-919"><a href="#cb28-919" aria-hidden="true" tabindex="-1"></a> <span class="co">#fit$cmdstan_diagnose()</span></span>
<span id="cb28-920"><a href="#cb28-920" aria-hidden="true" tabindex="-1"></a> <span class="fu">setwd</span>(<span class="st">"stanfiles"</span>)</span>
<span id="cb28-921"><a href="#cb28-921" aria-hidden="true" tabindex="-1"></a> str <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">cmdstan_path</span>(), <span class="st">"/bin/diagnose  output_*.csv"</span>)</span>
<span id="cb28-922"><a href="#cb28-922" aria-hidden="true" tabindex="-1"></a> <span class="fu">system</span>(str,<span class="at">intern=</span><span class="cn">TRUE</span>)</span>
<span id="cb28-923"><a href="#cb28-923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-924"><a href="#cb28-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-925"><a href="#cb28-925" aria-hidden="true" tabindex="-1"></a>The diagnostics are reasonable given model complexity. Output copied here to save time:</span>
<span id="cb28-926"><a href="#cb28-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-927"><a href="#cb28-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{=html}</span></span>
<span id="cb28-928"><a href="#cb28-928" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;pre&gt;</span></span>
<span id="cb28-929"><a href="#cb28-929" aria-hidden="true" tabindex="-1"></a><span class="in"> [1] "Processing csv files: output_1.csv, output_2.csv, output_3.csv, output_4.csv, output_5.csv, output_6.csv, output_7.csv, output_8.csv"</span></span>
<span id="cb28-930"><a href="#cb28-930" aria-hidden="true" tabindex="-1"></a><span class="in"> [2] ""</span></span>
<span id="cb28-931"><a href="#cb28-931" aria-hidden="true" tabindex="-1"></a><span class="in"> [3] "Checking sampler transitions treedepth." </span></span>
<span id="cb28-932"><a href="#cb28-932" aria-hidden="true" tabindex="-1"></a><span class="in"> [4] "4000 of 4000 (100.00%) transitions hit the maximum treedepth limit of 10, or 2^10 leapfrog steps." </span></span>
<span id="cb28-933"><a href="#cb28-933" aria-hidden="true" tabindex="-1"></a><span class="in"> [5] "Trajectories that are prematurely terminated due to this limit will result in slow exploration." </span></span>
<span id="cb28-934"><a href="#cb28-934" aria-hidden="true" tabindex="-1"></a><span class="in"> [6] "For optimal performance, increase this limit." </span></span>
<span id="cb28-935"><a href="#cb28-935" aria-hidden="true" tabindex="-1"></a><span class="in"> [7] ""</span></span>
<span id="cb28-936"><a href="#cb28-936" aria-hidden="true" tabindex="-1"></a><span class="in"> [8] "Checking sampler transitions for divergences." </span></span>
<span id="cb28-937"><a href="#cb28-937" aria-hidden="true" tabindex="-1"></a><span class="in"> [9] "No divergent transitions found." </span></span>
<span id="cb28-938"><a href="#cb28-938" aria-hidden="true" tabindex="-1"></a><span class="in">[10] ""</span></span>
<span id="cb28-939"><a href="#cb28-939" aria-hidden="true" tabindex="-1"></a><span class="in">[11] "Checking E-BFMI - sampler transitions HMC potential energy." </span></span>
<span id="cb28-940"><a href="#cb28-940" aria-hidden="true" tabindex="-1"></a><span class="in">[12] "E-BFMI satisfactory."</span></span>
<span id="cb28-941"><a href="#cb28-941" aria-hidden="true" tabindex="-1"></a><span class="in">[13] ""</span></span>
<span id="cb28-942"><a href="#cb28-942" aria-hidden="true" tabindex="-1"></a><span class="in">[14] "Effective sample size satisfactory." </span></span>
<span id="cb28-943"><a href="#cb28-943" aria-hidden="true" tabindex="-1"></a><span class="in">[15] ""</span></span>
<span id="cb28-944"><a href="#cb28-944" aria-hidden="true" tabindex="-1"></a><span class="in">[16] "The following parameters had split R-hat greater than 1.05:" </span></span>
<span id="cb28-945"><a href="#cb28-945" aria-hidden="true" tabindex="-1"></a><span class="in">[17] "etacdS1N[3,38], etaalphamB[92]"</span></span>
<span id="cb28-946"><a href="#cb28-946" aria-hidden="true" tabindex="-1"></a><span class="in">[18] "Such high values indicate incomplete mixing and biased estimation."</span></span>
<span id="cb28-947"><a href="#cb28-947" aria-hidden="true" tabindex="-1"></a><span class="in">[19] "You should consider regularizating your model with additional prior information or a more effective parameterization." </span></span>
<span id="cb28-948"><a href="#cb28-948" aria-hidden="true" tabindex="-1"></a><span class="in">[20] ""</span></span>
<span id="cb28-949"><a href="#cb28-949" aria-hidden="true" tabindex="-1"></a><span class="in">[21] "Processing complete."                                                                 </span></span>
<span id="cb28-950"><a href="#cb28-950" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;/pre&gt;</span></span>
<span id="cb28-951"><a href="#cb28-951" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-952"><a href="#cb28-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-953"><a href="#cb28-953" aria-hidden="true" tabindex="-1"></a><span class="fu"># Results</span></span>
<span id="cb28-954"><a href="#cb28-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-955"><a href="#cb28-955" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of model parameters (table):</span></span>
<span id="cb28-956"><a href="#cb28-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-957"><a href="#cb28-957" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tbl-summary}</span></span>
<span id="cb28-958"><a href="#cb28-958" aria-hidden="true" tabindex="-1"></a><span class="co"># fit$print(max_rows=200) # for first 200 parameters</span></span>
<span id="cb28-959"><a href="#cb28-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-960"><a href="#cb28-960" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"logkwHat"</span>,<span class="st">"S1mHat"</span>,<span class="st">"dS1Hat"</span>,</span>
<span id="cb28-961"><a href="#cb28-961" aria-hidden="true" tabindex="-1"></a>            <span class="st">"dlogkwHat"</span>,<span class="st">"dS1mHat"</span>,<span class="st">"ddS1Hat"</span>,</span>
<span id="cb28-962"><a href="#cb28-962" aria-hidden="true" tabindex="-1"></a>            <span class="st">"logS2mHat"</span>,<span class="st">"dlogS2Hat"</span>,</span>
<span id="cb28-963"><a href="#cb28-963" aria-hidden="true" tabindex="-1"></a>            <span class="st">"beta"</span>,</span>
<span id="cb28-964"><a href="#cb28-964" aria-hidden="true" tabindex="-1"></a>            <span class="st">"dlogkTHat"</span>,<span class="st">"apH"</span>,</span>
<span id="cb28-965"><a href="#cb28-965" aria-hidden="true" tabindex="-1"></a>            <span class="st">"omega"</span>,<span class="st">"omegaT"</span>, <span class="st">"kappa"</span>,</span>
<span id="cb28-966"><a href="#cb28-966" aria-hidden="true" tabindex="-1"></a>            <span class="st">"rho[2,1]"</span>,</span>
<span id="cb28-967"><a href="#cb28-967" aria-hidden="true" tabindex="-1"></a>            <span class="st">"msigma"</span>,<span class="st">"ssigma"</span>), <span class="at">max_rows =</span> <span class="dv">26</span>)</span>
<span id="cb28-968"><a href="#cb28-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-969"><a href="#cb28-969" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"alphamHat"</span>,<span class="st">"dalphaHat"</span>,</span>
<span id="cb28-970"><a href="#cb28-970" aria-hidden="true" tabindex="-1"></a>            <span class="st">"tau"</span>), <span class="at">max_rows =</span> <span class="dv">7</span>)</span>
<span id="cb28-971"><a href="#cb28-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-972"><a href="#cb28-972" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"clogkwHat"</span>,<span class="st">"cS1mHat"</span>,<span class="st">"cdS1Hat"</span>,</span>
<span id="cb28-973"><a href="#cb28-973" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkwHat"</span>,<span class="st">"cdS1mHat"</span>,<span class="st">"cddS1Hat"</span>,</span>
<span id="cb28-974"><a href="#cb28-974" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cbeta"</span>,</span>
<span id="cb28-975"><a href="#cb28-975" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkTHat"</span>,</span>
<span id="cb28-976"><a href="#cb28-976" aria-hidden="true" tabindex="-1"></a>            <span class="st">"capH"</span>,</span>
<span id="cb28-977"><a href="#cb28-977" aria-hidden="true" tabindex="-1"></a>            <span class="st">"comega"</span>, <span class="st">"ckappa"</span>, <span class="st">"comegaT"</span>,</span>
<span id="cb28-978"><a href="#cb28-978" aria-hidden="true" tabindex="-1"></a>            <span class="st">"crho"</span>,</span>
<span id="cb28-979"><a href="#cb28-979" aria-hidden="true" tabindex="-1"></a>            <span class="st">"clogmsigma"</span>,<span class="st">"cssigma"</span>), <span class="at">max_rows =</span> <span class="dv">108</span>)</span>
<span id="cb28-980"><a href="#cb28-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-981"><a href="#cb28-981" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-982"><a href="#cb28-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-983"><a href="#cb28-983" aria-hidden="true" tabindex="-1"></a>The summary can also be extracted for individual parameters. Here presented for analyte 9 (<span class="in">`r dataNames$Name[9]`</span>)</span>
<span id="cb28-984"><a href="#cb28-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-985"><a href="#cb28-985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tbl-isummary}</span></span>
<span id="cb28-986"><a href="#cb28-986" aria-hidden="true" tabindex="-1"></a><span class="co"># which(unique(data$METID)==9) - 3rd compound in stan</span></span>
<span id="cb28-987"><a href="#cb28-987" aria-hidden="true" tabindex="-1"></a>fit<span class="sc">$</span><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"logkwx[3,1,1]"</span>, <span class="st">"logkwx[3,1,2]"</span>, <span class="st">"logkwx[3,1,3]"</span>,</span>
<span id="cb28-988"><a href="#cb28-988" aria-hidden="true" tabindex="-1"></a>            <span class="st">"logkwx[3,2,1]"</span>, <span class="st">"logkwx[3,2,2]"</span>, <span class="st">"logkwx[3,2,3]"</span>,</span>
<span id="cb28-989"><a href="#cb28-989" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S1x[3,1,1,1]"</span>, <span class="st">"S1x[3,1,1,2]"</span>, <span class="st">"S1x[3,1,1,3]"</span>,</span>
<span id="cb28-990"><a href="#cb28-990" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S1x[3,2,1,1]"</span>, <span class="st">"S1x[3,2,1,2]"</span>, <span class="st">"S1x[3,2,1,3]"</span>,</span>
<span id="cb28-991"><a href="#cb28-991" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S1x[3,1,2,1]"</span>, <span class="st">"S1x[3,1,2,2]"</span>, <span class="st">"S1x[3,1,2,3]"</span>, </span>
<span id="cb28-992"><a href="#cb28-992" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S1x[3,2,2,1]"</span>, <span class="st">"S1x[3,2,2,2]"</span>, <span class="st">"S1x[3,2,2,3]"</span>,</span>
<span id="cb28-993"><a href="#cb28-993" aria-hidden="true" tabindex="-1"></a>                <span class="st">"apHx[3,1,1]"</span>, <span class="st">"apHx[3,1,2]"</span>, <span class="st">"apHx[3,1,3]"</span>,</span>
<span id="cb28-994"><a href="#cb28-994" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pKawx[3,1]"</span>, <span class="st">"pKawx[3,2]"</span>,</span>
<span id="cb28-995"><a href="#cb28-995" aria-hidden="true" tabindex="-1"></a>                <span class="st">"alphax[3,1,1]"</span>, <span class="st">"alphax[3,1,2]"</span>,</span>
<span id="cb28-996"><a href="#cb28-996" aria-hidden="true" tabindex="-1"></a>                <span class="st">"alphax[3,2,1]"</span>, <span class="st">"alphax[3,2,2]"</span>,</span>
<span id="cb28-997"><a href="#cb28-997" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2x[1,1]"</span>, <span class="st">"S2x[2,1]"</span>,</span>
<span id="cb28-998"><a href="#cb28-998" aria-hidden="true" tabindex="-1"></a>                <span class="st">"sigmax[3,1]"</span>, <span class="st">"sigmax[3,2]"</span>), <span class="at">max_rows =</span> <span class="dv">31</span>)</span>
<span id="cb28-999"><a href="#cb28-999" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1000"><a href="#cb28-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1001"><a href="#cb28-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```{r summary2, eval = FALSE, echo=FALSE}</span></span>
<span id="cb28-1002"><a href="#cb28-1002" aria-hidden="true" tabindex="-1"></a> x<span class="ot">&lt;-</span>fit<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"logkwHat"</span>,<span class="st">"S1mHat"</span>,<span class="st">"dS1Hat"</span>,</span>
<span id="cb28-1003"><a href="#cb28-1003" aria-hidden="true" tabindex="-1"></a>             <span class="st">"dlogkwHat"</span>,<span class="st">"dS1mHat"</span>,<span class="st">"ddS1Hat"</span>,</span>
<span id="cb28-1004"><a href="#cb28-1004" aria-hidden="true" tabindex="-1"></a>             <span class="st">"logS2mHat"</span>,<span class="st">"dlogS2Hat"</span>,</span>
<span id="cb28-1005"><a href="#cb28-1005" aria-hidden="true" tabindex="-1"></a>             <span class="st">"beta"</span>,</span>
<span id="cb28-1006"><a href="#cb28-1006" aria-hidden="true" tabindex="-1"></a>             <span class="st">"alphamHat"</span>,<span class="st">"dalphaHat"</span>,</span>
<span id="cb28-1007"><a href="#cb28-1007" aria-hidden="true" tabindex="-1"></a>             <span class="st">"dlogkTHat"</span>,<span class="st">"apH"</span>,</span>
<span id="cb28-1008"><a href="#cb28-1008" aria-hidden="true" tabindex="-1"></a>             <span class="st">"omega"</span>,<span class="st">"omegaT"</span>,</span>
<span id="cb28-1009"><a href="#cb28-1009" aria-hidden="true" tabindex="-1"></a>             <span class="st">"kappa"</span>,</span>
<span id="cb28-1010"><a href="#cb28-1010" aria-hidden="true" tabindex="-1"></a>             <span class="st">"msigma"</span>,<span class="st">"ssigma"</span>,</span>
<span id="cb28-1011"><a href="#cb28-1011" aria-hidden="true" tabindex="-1"></a>             <span class="st">"tau"</span>,</span>
<span id="cb28-1012"><a href="#cb28-1012" aria-hidden="true" tabindex="-1"></a>             <span class="st">"clogkwHat"</span>,<span class="st">"cS1mHat"</span>,<span class="st">"cdS1Hat"</span>,</span>
<span id="cb28-1013"><a href="#cb28-1013" aria-hidden="true" tabindex="-1"></a>             <span class="st">"cdlogkwHat"</span>,<span class="st">"cdS1mHat"</span>,<span class="st">"cddS1Hat"</span>,</span>
<span id="cb28-1014"><a href="#cb28-1014" aria-hidden="true" tabindex="-1"></a>             <span class="st">"cbeta"</span>,</span>
<span id="cb28-1015"><a href="#cb28-1015" aria-hidden="true" tabindex="-1"></a>             <span class="st">"cdlogkTHat"</span>,</span>
<span id="cb28-1016"><a href="#cb28-1016" aria-hidden="true" tabindex="-1"></a>             <span class="st">"capH"</span>,</span>
<span id="cb28-1017"><a href="#cb28-1017" aria-hidden="true" tabindex="-1"></a>             <span class="st">"comega"</span>, <span class="st">"ckappa"</span>, <span class="st">"comegaT"</span>,</span>
<span id="cb28-1018"><a href="#cb28-1018" aria-hidden="true" tabindex="-1"></a>             <span class="st">"clogmsigma"</span>,<span class="st">"cssigma"</span>, <span class="st">"rho[2,1]"</span>, <span class="st">"corr_L"</span>), <span class="st">"mean"</span>, <span class="st">"sd"</span>)</span>
<span id="cb28-1019"><a href="#cb28-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1020"><a href="#cb28-1020" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(x, <span class="at">n=</span><span class="dv">141</span>)</span>
<span id="cb28-1021"><a href="#cb28-1021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1022"><a href="#cb28-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1023"><a href="#cb28-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">## Trace plots</span></span>
<span id="cb28-1024"><a href="#cb28-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1025"><a href="#cb28-1025" aria-hidden="true" tabindex="-1"></a>Several trace plots are shown.</span>
<span id="cb28-1026"><a href="#cb28-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1027"><a href="#cb28-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```{r traceplots, include=TRUE}</span></span>
<span id="cb28-1028"><a href="#cb28-1028" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"logkwHat"</span>,<span class="st">"S1mHat"</span>,<span class="st">"dS1Hat"</span>,<span class="st">"clogkwHat"</span>,<span class="st">"cS1mHat"</span>,<span class="st">"cdS1Hat"</span>))) </span>
<span id="cb28-1029"><a href="#cb28-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1030"><a href="#cb28-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1031"><a href="#cb28-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of model parameters (figures)</span></span>
<span id="cb28-1032"><a href="#cb28-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1033"><a href="#cb28-1033" aria-hidden="true" tabindex="-1"></a>First plot presents parameter specific for XBridge Shield RP18 column and parameters common for all the columns:</span>
<span id="cb28-1034"><a href="#cb28-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1035"><a href="#cb28-1035" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-summary, include=TRUE}</span></span>
<span id="cb28-1036"><a href="#cb28-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1037"><a href="#cb28-1037" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"logkwHat"</span>,<span class="st">"S1mHat"</span>,<span class="st">"dS1Hat"</span>,<span class="st">"dlogkwHat"</span>,</span>
<span id="cb28-1038"><a href="#cb28-1038" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"dlogkTHat"</span>, <span class="st">"dS1mHat"</span>,<span class="st">"ddS1Hat"</span>,<span class="st">"logS2mHat"</span>,<span class="st">"dlogS2Hat"</span>,<span class="st">"beta"</span>,</span>
<span id="cb28-1039"><a href="#cb28-1039" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">"apH"</span>,<span class="st">"alphamHat"</span>,<span class="st">"dalphaHat"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)</span>
<span id="cb28-1040"><a href="#cb28-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1041"><a href="#cb28-1041" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"omega"</span>,<span class="st">"omegaT"</span>,<span class="st">"kappa"</span>,<span class="st">"msigma"</span>,<span class="st">"ssigma"</span>, <span class="st">"tau"</span>,<span class="st">"rho[2,1]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)</span>
<span id="cb28-1042"><a href="#cb28-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1043"><a href="#cb28-1043" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">param</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"XBridgeShieldRP18_1"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-1044"><a href="#cb28-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">param</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"XBridgeShieldRP18_2"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p2, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-1045"><a href="#cb28-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1046"><a href="#cb28-1046" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-1047"><a href="#cb28-1047" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb28-1048"><a href="#cb28-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1049"><a href="#cb28-1049" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1050"><a href="#cb28-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1051"><a href="#cb28-1051" aria-hidden="true" tabindex="-1"></a>Column effects relative to XBridge Shield RP18 column:</span>
<span id="cb28-1052"><a href="#cb28-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1053"><a href="#cb28-1053" aria-hidden="true" tabindex="-1"></a><span class="in">```{r columneffects1, include=TRUE}</span></span>
<span id="cb28-1054"><a href="#cb28-1054" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"clogkwHat[1]"</span>,<span class="st">"cS1mHat[1]"</span>,<span class="st">"cdS1Hat[1]"</span>,</span>
<span id="cb28-1055"><a href="#cb28-1055" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkwHat[1,1]"</span>, <span class="st">"cdlogkwHat[1,2]"</span>,</span>
<span id="cb28-1056"><a href="#cb28-1056" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdS1mHat[1,1]"</span>,<span class="st">"cdS1mHat[1,2]"</span>, </span>
<span id="cb28-1057"><a href="#cb28-1057" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cddS1Hat[1,1]"</span>,<span class="st">"cddS1Hat[1,2]"</span>,</span>
<span id="cb28-1058"><a href="#cb28-1058" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cbeta[1,1]"</span>,<span class="st">"cbeta[1,2]"</span>,</span>
<span id="cb28-1059"><a href="#cb28-1059" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkTHat[1]"</span>,</span>
<span id="cb28-1060"><a href="#cb28-1060" aria-hidden="true" tabindex="-1"></a>            <span class="st">"capH[1,1]"</span>, <span class="st">"capH[1,2]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-1061"><a href="#cb28-1061" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb28-1062"><a href="#cb28-1062" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"clogkwHat[1]"</span><span class="ot">=</span><span class="st">"clogkwHat[c]"</span>,</span>
<span id="cb28-1063"><a href="#cb28-1063" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cS1mHat[1]"</span><span class="ot">=</span><span class="st">"cS1mHat[c]"</span>,</span>
<span id="cb28-1064"><a href="#cb28-1064" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cdS1Hat[1]"</span><span class="ot">=</span><span class="st">"cdS1Hat[c]"</span>,</span>
<span id="cb28-1065"><a href="#cb28-1065" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cdlogkwHat[1,1]"</span><span class="ot">=</span><span class="st">"cdlogkwHat[c,1]"</span>, </span>
<span id="cb28-1066"><a href="#cb28-1066" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cdlogkwHat[1,2]"</span><span class="ot">=</span><span class="st">"cdlogkwHat[c,2]"</span>,</span>
<span id="cb28-1067"><a href="#cb28-1067" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cdS1mHat[1,1]"</span><span class="ot">=</span> <span class="st">"cdS1mHat[c,1]"</span>,</span>
<span id="cb28-1068"><a href="#cb28-1068" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cdS1mHat[1,2]"</span><span class="ot">=</span><span class="st">"cdS1mHat[c,2]"</span>, </span>
<span id="cb28-1069"><a href="#cb28-1069" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cddS1Hat[1,1]"</span><span class="ot">=</span><span class="st">"cddS1Hat[c,1]"</span>,</span>
<span id="cb28-1070"><a href="#cb28-1070" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cddS1Hat[1,2]"</span><span class="ot">=</span><span class="st">"cddS1Hat[c,2]"</span>,</span>
<span id="cb28-1071"><a href="#cb28-1071" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cbeta[1,1]"</span><span class="ot">=</span><span class="st">"cbeta[c,1]"</span>,</span>
<span id="cb28-1072"><a href="#cb28-1072" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cbeta[1,2]"</span><span class="ot">=</span><span class="st">"cbeta[c,2]"</span>,</span>
<span id="cb28-1073"><a href="#cb28-1073" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"cdlogkTHat[1]"</span><span class="ot">=</span><span class="st">"cdlogkTHat[c]"</span>,</span>
<span id="cb28-1074"><a href="#cb28-1074" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"capH[1,1]"</span><span class="ot">=</span><span class="st">"capH[c,1]"</span>, </span>
<span id="cb28-1075"><a href="#cb28-1075" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"capH[1,2]"</span><span class="ot">=</span><span class="st">"capH[c,2]"</span>),</span>
<span id="cb28-1076"><a href="#cb28-1076" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"capH[1,2]"</span>,</span>
<span id="cb28-1077"><a href="#cb28-1077" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"capH[1,1]"</span>,</span>
<span id="cb28-1078"><a href="#cb28-1078" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cdlogkTHat[1]"</span>,                    </span>
<span id="cb28-1079"><a href="#cb28-1079" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cbeta[1,2]"</span>,</span>
<span id="cb28-1080"><a href="#cb28-1080" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cbeta[1,1]"</span>,</span>
<span id="cb28-1081"><a href="#cb28-1081" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cddS1Hat[1,2]"</span>,</span>
<span id="cb28-1082"><a href="#cb28-1082" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cddS1Hat[1,1]"</span>,</span>
<span id="cb28-1083"><a href="#cb28-1083" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cdS1mHat[1,2]"</span>,</span>
<span id="cb28-1084"><a href="#cb28-1084" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cdS1mHat[1,1]"</span>,</span>
<span id="cb28-1085"><a href="#cb28-1085" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cdlogkwHat[1,2]"</span>,</span>
<span id="cb28-1086"><a href="#cb28-1086" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cdlogkwHat[1,1]"</span>, </span>
<span id="cb28-1087"><a href="#cb28-1087" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cdS1Hat[1]"</span>,</span>
<span id="cb28-1088"><a href="#cb28-1088" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"cS1mHat[1]"</span>,                              </span>
<span id="cb28-1089"><a href="#cb28-1089" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"clogkwHat[1]"</span>))<span class="sc">+</span></span>
<span id="cb28-1090"><a href="#cb28-1090" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb28-1091"><a href="#cb28-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1092"><a href="#cb28-1092" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"clogkwHat[2]"</span>,<span class="st">"cS1mHat[2]"</span>,<span class="st">"cdS1Hat[2]"</span>,</span>
<span id="cb28-1093"><a href="#cb28-1093" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkwHat[2,1]"</span>, <span class="st">"cdlogkwHat[2,2]"</span>,</span>
<span id="cb28-1094"><a href="#cb28-1094" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdS1mHat[2,1]"</span>,<span class="st">"cdS1mHat[2,2]"</span>, </span>
<span id="cb28-1095"><a href="#cb28-1095" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cddS1Hat[2,1]"</span>,<span class="st">"cddS1Hat[2,2]"</span>,</span>
<span id="cb28-1096"><a href="#cb28-1096" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cbeta[2,1]"</span>,<span class="st">"cbeta[2,2]"</span>,</span>
<span id="cb28-1097"><a href="#cb28-1097" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkTHat[2]"</span>,</span>
<span id="cb28-1098"><a href="#cb28-1098" aria-hidden="true" tabindex="-1"></a>            <span class="st">"capH[2,1]"</span>, <span class="st">"capH[2,2]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-1099"><a href="#cb28-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb28-1100"><a href="#cb28-1100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb28-1101"><a href="#cb28-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1102"><a href="#cb28-1102" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"clogkwHat[3]"</span>,<span class="st">"cS1mHat[3]"</span>,<span class="st">"cdS1Hat[3]"</span>,</span>
<span id="cb28-1103"><a href="#cb28-1103" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkwHat[3,1]"</span>, <span class="st">"cdlogkwHat[3,2]"</span>,</span>
<span id="cb28-1104"><a href="#cb28-1104" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdS1mHat[3,1]"</span>,<span class="st">"cdS1mHat[3,2]"</span>, </span>
<span id="cb28-1105"><a href="#cb28-1105" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cddS1Hat[3,1]"</span>,<span class="st">"cddS1Hat[3,2]"</span>,</span>
<span id="cb28-1106"><a href="#cb28-1106" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cbeta[3,1]"</span>,<span class="st">"cbeta[3,2]"</span>,</span>
<span id="cb28-1107"><a href="#cb28-1107" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkTHat[3]"</span>,</span>
<span id="cb28-1108"><a href="#cb28-1108" aria-hidden="true" tabindex="-1"></a>            <span class="st">"capH[3,1]"</span>, <span class="st">"capH[3,2]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-1109"><a href="#cb28-1109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb28-1110"><a href="#cb28-1110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb28-1111"><a href="#cb28-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1112"><a href="#cb28-1112" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"clogkwHat[4]"</span>,<span class="st">"cS1mHat[4]"</span>,<span class="st">"cdS1Hat[4]"</span>,</span>
<span id="cb28-1113"><a href="#cb28-1113" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkwHat[4,1]"</span>, <span class="st">"cdlogkwHat[4,2]"</span>,</span>
<span id="cb28-1114"><a href="#cb28-1114" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdS1mHat[4,1]"</span>,<span class="st">"cdS1mHat[4,2]"</span>, </span>
<span id="cb28-1115"><a href="#cb28-1115" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cddS1Hat[4,1]"</span>,<span class="st">"cddS1Hat[4,2]"</span>,</span>
<span id="cb28-1116"><a href="#cb28-1116" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cbeta[4,1]"</span>,<span class="st">"cbeta[4,2]"</span>,</span>
<span id="cb28-1117"><a href="#cb28-1117" aria-hidden="true" tabindex="-1"></a>            <span class="st">"cdlogkTHat[4]"</span>,</span>
<span id="cb28-1118"><a href="#cb28-1118" aria-hidden="true" tabindex="-1"></a>            <span class="st">"capH[4,1]"</span>, <span class="st">"capH[4,2]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-1119"><a href="#cb28-1119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb28-1120"><a href="#cb28-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>)</span>
<span id="cb28-1121"><a href="#cb28-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1122"><a href="#cb28-1122" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">grid.arrange</span>(p1<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"XTerra MS C18"</span>), </span>
<span id="cb28-1123"><a href="#cb28-1123" aria-hidden="true" tabindex="-1"></a>               p2<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"XBridge Phenyl"</span>),</span>
<span id="cb28-1124"><a href="#cb28-1124" aria-hidden="true" tabindex="-1"></a>               p3<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"XBridge C8"</span>),</span>
<span id="cb28-1125"><a href="#cb28-1125" aria-hidden="true" tabindex="-1"></a>               p4<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Xterra MS C8"</span>), <span class="at">ncol=</span><span class="dv">4</span>, <span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb28-1126"><a href="#cb28-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1127"><a href="#cb28-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1128"><a href="#cb28-1128" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">param</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"columneffects1"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-1129"><a href="#cb28-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1130"><a href="#cb28-1130" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1131"><a href="#cb28-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1132"><a href="#cb28-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r columneffects2, include=TRUE}</span></span>
<span id="cb28-1133"><a href="#cb28-1133" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"comega[1,1]"</span>,</span>
<span id="cb28-1134"><a href="#cb28-1134" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comega[1,2]"</span>,</span>
<span id="cb28-1135"><a href="#cb28-1135" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comega[1,3]"</span>,</span>
<span id="cb28-1136"><a href="#cb28-1136" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comegaT[1]"</span>,</span>
<span id="cb28-1137"><a href="#cb28-1137" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[1,1]"</span>,</span>
<span id="cb28-1138"><a href="#cb28-1138" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[1,2]"</span>,</span>
<span id="cb28-1139"><a href="#cb28-1139" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[1,3]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb28-1140"><a href="#cb28-1140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb28-1141"><a href="#cb28-1141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"comega[1,1]"</span><span class="ot">=</span><span class="st">"comega[c,1]"</span>,</span>
<span id="cb28-1142"><a href="#cb28-1142" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"comega[1,2]"</span><span class="ot">=</span><span class="st">"comega[c,2]"</span>,</span>
<span id="cb28-1143"><a href="#cb28-1143" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"comega[1,3]"</span><span class="ot">=</span><span class="st">"comega[c,3]"</span>,</span>
<span id="cb28-1144"><a href="#cb28-1144" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"comegaT[1]"</span> <span class="ot">=</span> <span class="st">"comegaT[c]"</span>,</span>
<span id="cb28-1145"><a href="#cb28-1145" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"ckappa[1,1]"</span><span class="ot">=</span><span class="st">"ckappa[c,1]"</span>,</span>
<span id="cb28-1146"><a href="#cb28-1146" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"ckappa[1,2]"</span><span class="ot">=</span><span class="st">"ckappa[c,2]"</span>,</span>
<span id="cb28-1147"><a href="#cb28-1147" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"ckappa[1,3]"</span><span class="ot">=</span><span class="st">"ckappa[c,3]"</span>),</span>
<span id="cb28-1148"><a href="#cb28-1148" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"ckappa[1,3]"</span>,</span>
<span id="cb28-1149"><a href="#cb28-1149" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ckappa[1,2]"</span>,</span>
<span id="cb28-1150"><a href="#cb28-1150" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"ckappa[1,1]"</span>,</span>
<span id="cb28-1151"><a href="#cb28-1151" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"comegaT[1]"</span>,</span>
<span id="cb28-1152"><a href="#cb28-1152" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"comega[1,3]"</span>,                                          </span>
<span id="cb28-1153"><a href="#cb28-1153" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"comega[1,2]"</span>,</span>
<span id="cb28-1154"><a href="#cb28-1154" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"comega[1,1]"</span>))<span class="sc">+</span></span>
<span id="cb28-1155"><a href="#cb28-1155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.8</span>)</span>
<span id="cb28-1156"><a href="#cb28-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1157"><a href="#cb28-1157" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"comega[2,1]"</span>,</span>
<span id="cb28-1158"><a href="#cb28-1158" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comega[2,2]"</span>,</span>
<span id="cb28-1159"><a href="#cb28-1159" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comega[2,3]"</span>,</span>
<span id="cb28-1160"><a href="#cb28-1160" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comegaT[2]"</span>,</span>
<span id="cb28-1161"><a href="#cb28-1161" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[2,1]"</span>,</span>
<span id="cb28-1162"><a href="#cb28-1162" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[2,2]"</span>,</span>
<span id="cb28-1163"><a href="#cb28-1163" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[2,3]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-1164"><a href="#cb28-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb28-1165"><a href="#cb28-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.8</span>)</span>
<span id="cb28-1166"><a href="#cb28-1166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1167"><a href="#cb28-1167" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"comega[3,1]"</span>,</span>
<span id="cb28-1168"><a href="#cb28-1168" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comega[3,2]"</span>,</span>
<span id="cb28-1169"><a href="#cb28-1169" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comega[3,3]"</span>,</span>
<span id="cb28-1170"><a href="#cb28-1170" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comegaT[3]"</span>,</span>
<span id="cb28-1171"><a href="#cb28-1171" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[3,1]"</span>,</span>
<span id="cb28-1172"><a href="#cb28-1172" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[3,2]"</span>,</span>
<span id="cb28-1173"><a href="#cb28-1173" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[3,3]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-1174"><a href="#cb28-1174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb28-1175"><a href="#cb28-1175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.8</span>)</span>
<span id="cb28-1176"><a href="#cb28-1176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1177"><a href="#cb28-1177" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">&lt;-</span>bayesplot<span class="sc">::</span><span class="fu">mcmc_intervals</span>(fit<span class="sc">$</span><span class="fu">draws</span>(<span class="fu">c</span>(<span class="st">"comega[4,1]"</span>,</span>
<span id="cb28-1178"><a href="#cb28-1178" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comega[4,2]"</span>,</span>
<span id="cb28-1179"><a href="#cb28-1179" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comega[4,3]"</span>,</span>
<span id="cb28-1180"><a href="#cb28-1180" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"comegaT[4]"</span>,</span>
<span id="cb28-1181"><a href="#cb28-1181" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[4,1]"</span>,</span>
<span id="cb28-1182"><a href="#cb28-1182" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[4,2]"</span>,</span>
<span id="cb28-1183"><a href="#cb28-1183" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"ckappa[4,3]"</span>)), <span class="at">point_size =</span> <span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-1184"><a href="#cb28-1184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>(),<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>))<span class="sc">+</span></span>
<span id="cb28-1185"><a href="#cb28-1185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.8</span>)</span>
<span id="cb28-1186"><a href="#cb28-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1187"><a href="#cb28-1187" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">grid.arrange</span>(p1<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"XTerra MS C18"</span>), </span>
<span id="cb28-1188"><a href="#cb28-1188" aria-hidden="true" tabindex="-1"></a>               p2<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"XBridge Phenyl"</span>),</span>
<span id="cb28-1189"><a href="#cb28-1189" aria-hidden="true" tabindex="-1"></a>               p3<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"XBridge C8"</span>),</span>
<span id="cb28-1190"><a href="#cb28-1190" aria-hidden="true" tabindex="-1"></a>               p4<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">"Xterra MS C8"</span>), <span class="at">ncol=</span><span class="dv">4</span>, <span class="at">widths=</span><span class="fu">c</span>(<span class="fl">1.75</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb28-1191"><a href="#cb28-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1192"><a href="#cb28-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1193"><a href="#cb28-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">param</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"columneffects2"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-1194"><a href="#cb28-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1195"><a href="#cb28-1195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1196"><a href="#cb28-1196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1197"><a href="#cb28-1197" aria-hidden="true" tabindex="-1"></a>Parameters characterizing columns:</span>
<span id="cb28-1198"><a href="#cb28-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1199"><a href="#cb28-1199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-clogkw}</span></span>
<span id="cb28-1200"><a href="#cb28-1200" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"clogkwHat"</span>,<span class="st">"cdlogkwHat"</span>))</span>
<span id="cb28-1201"><a href="#cb28-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1202"><a href="#cb28-1202" aria-hidden="true" tabindex="-1"></a>Neutral_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1203"><a href="#cb28-1203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1204"><a href="#cb28-1204" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(clogkwHat[c]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1205"><a href="#cb28-1205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1206"><a href="#cb28-1206" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1207"><a href="#cb28-1207" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1208"><a href="#cb28-1208" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1209"><a href="#cb28-1209" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1210"><a href="#cb28-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1211"><a href="#cb28-1211" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">logkwHat =</span> clogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1212"><a href="#cb28-1212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"N"</span>)</span>
<span id="cb28-1213"><a href="#cb28-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1214"><a href="#cb28-1214" aria-hidden="true" tabindex="-1"></a>Acids_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1215"><a href="#cb28-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1216"><a href="#cb28-1216" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(clogkwHat[c],cdlogkwHat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1217"><a href="#cb28-1217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1218"><a href="#cb28-1218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1219"><a href="#cb28-1219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1220"><a href="#cb28-1220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xlogkwHat=</span>clogkwHat<span class="sc">+</span>cdlogkwHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1221"><a href="#cb28-1221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1222"><a href="#cb28-1222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1223"><a href="#cb28-1223" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1224"><a href="#cb28-1224" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1225"><a href="#cb28-1225" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1226"><a href="#cb28-1226" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1227"><a href="#cb28-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1228"><a href="#cb28-1228" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">logkwHat =</span> xlogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1229"><a href="#cb28-1229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"A"</span>)</span>
<span id="cb28-1230"><a href="#cb28-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1231"><a href="#cb28-1231" aria-hidden="true" tabindex="-1"></a>Basic_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1232"><a href="#cb28-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1233"><a href="#cb28-1233" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(clogkwHat[c],cdlogkwHat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1234"><a href="#cb28-1234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1235"><a href="#cb28-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1236"><a href="#cb28-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1237"><a href="#cb28-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xlogkwHat=</span>clogkwHat<span class="sc">+</span>cdlogkwHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1238"><a href="#cb28-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1239"><a href="#cb28-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1240"><a href="#cb28-1240" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1241"><a href="#cb28-1241" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1242"><a href="#cb28-1242" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1243"><a href="#cb28-1243" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1244"><a href="#cb28-1244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1245"><a href="#cb28-1245" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">logkwHat =</span> xlogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1246"><a href="#cb28-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"B"</span>)</span>
<span id="cb28-1247"><a href="#cb28-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1248"><a href="#cb28-1248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1249"><a href="#cb28-1249" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(Neutral_results, Acids_results, Basic_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1250"><a href="#cb28-1250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> logkwHat, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb28-1251"><a href="#cb28-1251" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span>  </span>
<span id="cb28-1252"><a href="#cb28-1252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"N"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F8766D"</span>, <span class="st">"#619CFF"</span>, <span class="st">"black"</span>))<span class="sc">+</span> </span>
<span id="cb28-1253"><a href="#cb28-1253" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">' '</span>) <span class="sc">+</span></span>
<span id="cb28-1254"><a href="#cb28-1254" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"Typical clogkw"</span>)</span>
<span id="cb28-1255"><a href="#cb28-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1256"><a href="#cb28-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1257"><a href="#cb28-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1258"><a href="#cb28-1258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-cS1}</span></span>
<span id="cb28-1259"><a href="#cb28-1259" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"S1mHat"</span>,<span class="st">"cS1mHat"</span>,<span class="st">"dS1mHat"</span>,<span class="st">"cdS1mHat"</span>,</span>
<span id="cb28-1260"><a href="#cb28-1260" aria-hidden="true" tabindex="-1"></a>                                                         <span class="st">"dS1Hat"</span>,<span class="st">"cdS1Hat"</span>,<span class="st">"ddS1Hat"</span>,<span class="st">"cddS1Hat"</span>))</span>
<span id="cb28-1261"><a href="#cb28-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1262"><a href="#cb28-1262" aria-hidden="true" tabindex="-1"></a>MeOH_Neutral_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1263"><a href="#cb28-1263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1264"><a href="#cb28-1264" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(S1mHat,cS1mHat[c]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1265"><a href="#cb28-1265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xS1mHat=</span>cS1mHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1266"><a href="#cb28-1266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1267"><a href="#cb28-1267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1268"><a href="#cb28-1268" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1269"><a href="#cb28-1269" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1270"><a href="#cb28-1270" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1271"><a href="#cb28-1271" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1272"><a href="#cb28-1272" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1273"><a href="#cb28-1273" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1274"><a href="#cb28-1274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"N"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1275"><a href="#cb28-1275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"MeOH"</span>)</span>
<span id="cb28-1276"><a href="#cb28-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1277"><a href="#cb28-1277" aria-hidden="true" tabindex="-1"></a>MeOH_Acids_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1278"><a href="#cb28-1278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1279"><a href="#cb28-1279" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(cS1mHat[c],cdS1mHat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1280"><a href="#cb28-1280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1281"><a href="#cb28-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1282"><a href="#cb28-1282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1283"><a href="#cb28-1283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xS1mHat=</span>cS1mHat<span class="sc">+</span>cdS1mHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1284"><a href="#cb28-1284" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1285"><a href="#cb28-1285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1286"><a href="#cb28-1286" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1287"><a href="#cb28-1287" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1288"><a href="#cb28-1288" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1289"><a href="#cb28-1289" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1290"><a href="#cb28-1290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1291"><a href="#cb28-1291" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1292"><a href="#cb28-1292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"A"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1293"><a href="#cb28-1293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"MeOH"</span>)</span>
<span id="cb28-1294"><a href="#cb28-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1295"><a href="#cb28-1295" aria-hidden="true" tabindex="-1"></a>MeOH_Basic_results  <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1296"><a href="#cb28-1296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1297"><a href="#cb28-1297" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(cS1mHat[c],cdS1mHat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1298"><a href="#cb28-1298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1299"><a href="#cb28-1299" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1300"><a href="#cb28-1300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1301"><a href="#cb28-1301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xS1mHat=</span>cS1mHat<span class="sc">+</span>cdS1mHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1302"><a href="#cb28-1302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1303"><a href="#cb28-1303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1304"><a href="#cb28-1304" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1305"><a href="#cb28-1305" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1306"><a href="#cb28-1306" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1307"><a href="#cb28-1307" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1308"><a href="#cb28-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1309"><a href="#cb28-1309" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1310"><a href="#cb28-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"B"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1311"><a href="#cb28-1311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"MeOH"</span>)</span>
<span id="cb28-1312"><a href="#cb28-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1313"><a href="#cb28-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1314"><a href="#cb28-1314" aria-hidden="true" tabindex="-1"></a>ACN_Neutral_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1315"><a href="#cb28-1315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1316"><a href="#cb28-1316" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(cS1mHat[c],cdS1Hat[c]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1317"><a href="#cb28-1317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xS1aHat=</span>cS1mHat<span class="sc">+</span>cdS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1318"><a href="#cb28-1318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1319"><a href="#cb28-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1320"><a href="#cb28-1320" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1321"><a href="#cb28-1321" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1322"><a href="#cb28-1322" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1323"><a href="#cb28-1323" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1324"><a href="#cb28-1324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1325"><a href="#cb28-1325" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1326"><a href="#cb28-1326" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"N"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1327"><a href="#cb28-1327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"ACN"</span>)</span>
<span id="cb28-1328"><a href="#cb28-1328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1329"><a href="#cb28-1329" aria-hidden="true" tabindex="-1"></a>ACN_Acids_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1330"><a href="#cb28-1330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1331"><a href="#cb28-1331" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(cS1mHat[c],cdS1Hat[c],cdS1mHat[c,r],cddS1Hat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1332"><a href="#cb28-1332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1333"><a href="#cb28-1333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1334"><a href="#cb28-1334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1335"><a href="#cb28-1335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xS1aHat=</span> cS1mHat <span class="sc">+</span>cdS1mHat <span class="sc">+</span>cdS1Hat <span class="sc">+</span> cddS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1336"><a href="#cb28-1336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1337"><a href="#cb28-1337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1338"><a href="#cb28-1338" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1339"><a href="#cb28-1339" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1340"><a href="#cb28-1340" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1341"><a href="#cb28-1341" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1342"><a href="#cb28-1342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1343"><a href="#cb28-1343" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1344"><a href="#cb28-1344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"A"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1345"><a href="#cb28-1345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"ACN"</span>)</span>
<span id="cb28-1346"><a href="#cb28-1346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1347"><a href="#cb28-1347" aria-hidden="true" tabindex="-1"></a>ACN_Basic_results  <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1348"><a href="#cb28-1348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1349"><a href="#cb28-1349" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(cS1mHat[c],cdS1Hat[c],cdS1mHat[c,r],cddS1Hat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1350"><a href="#cb28-1350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1351"><a href="#cb28-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1352"><a href="#cb28-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1353"><a href="#cb28-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xS1aHat=</span> cS1mHat<span class="sc">+</span>cdS1mHat<span class="sc">+</span>cdS1Hat <span class="sc">+</span> cddS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1354"><a href="#cb28-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1355"><a href="#cb28-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1356"><a href="#cb28-1356" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1357"><a href="#cb28-1357" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1358"><a href="#cb28-1358" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1359"><a href="#cb28-1359" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span>  </span>
<span id="cb28-1360"><a href="#cb28-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1361"><a href="#cb28-1361" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1362"><a href="#cb28-1362" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"B"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1363"><a href="#cb28-1363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"ACN"</span>)</span>
<span id="cb28-1364"><a href="#cb28-1364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1365"><a href="#cb28-1365" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(MeOH_Neutral_results, MeOH_Acids_results, MeOH_Basic_results,</span>
<span id="cb28-1366"><a href="#cb28-1366" aria-hidden="true" tabindex="-1"></a>             ACN_Neutral_results,ACN_Acids_results, ACN_Basic_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1367"><a href="#cb28-1367" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> S1Hat, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb28-1368"><a href="#cb28-1368" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span>  </span>
<span id="cb28-1369"><a href="#cb28-1369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"N"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F8766D"</span>, <span class="st">"#619CFF"</span>, <span class="st">"black"</span>))<span class="sc">+</span> </span>
<span id="cb28-1370"><a href="#cb28-1370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1371"><a href="#cb28-1371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Typical cS1"</span>)<span class="sc">+</span></span>
<span id="cb28-1372"><a href="#cb28-1372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Modifier)</span>
<span id="cb28-1373"><a href="#cb28-1373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1374"><a href="#cb28-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1375"><a href="#cb28-1375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-cbeta}</span></span>
<span id="cb28-1376"><a href="#cb28-1376" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"beta"</span>,<span class="st">"cbeta"</span>))</span>
<span id="cb28-1377"><a href="#cb28-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1378"><a href="#cb28-1378" aria-hidden="true" tabindex="-1"></a>logkw_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1379"><a href="#cb28-1379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1380"><a href="#cb28-1380" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(cbeta[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1381"><a href="#cb28-1381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1382"><a href="#cb28-1382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1383"><a href="#cb28-1383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1384"><a href="#cb28-1384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xbeta=</span>cbeta)<span class="sc">%&gt;%</span></span>
<span id="cb28-1385"><a href="#cb28-1385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1386"><a href="#cb28-1386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1387"><a href="#cb28-1387" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1388"><a href="#cb28-1388" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1389"><a href="#cb28-1389" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1390"><a href="#cb28-1390" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1391"><a href="#cb28-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1392"><a href="#cb28-1392" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">beta =</span> xbeta)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1393"><a href="#cb28-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"logkw"</span>)</span>
<span id="cb28-1394"><a href="#cb28-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1395"><a href="#cb28-1395" aria-hidden="true" tabindex="-1"></a>S1_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1396"><a href="#cb28-1396" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1397"><a href="#cb28-1397" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(cbeta[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1398"><a href="#cb28-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1399"><a href="#cb28-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1400"><a href="#cb28-1400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1401"><a href="#cb28-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xbeta=</span>cbeta)<span class="sc">%&gt;%</span></span>
<span id="cb28-1402"><a href="#cb28-1402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1403"><a href="#cb28-1403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1404"><a href="#cb28-1404" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1405"><a href="#cb28-1405" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1406"><a href="#cb28-1406" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1407"><a href="#cb28-1407" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1408"><a href="#cb28-1408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1409"><a href="#cb28-1409" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">beta =</span> xbeta)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1410"><a href="#cb28-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"S1"</span>)</span>
<span id="cb28-1411"><a href="#cb28-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1412"><a href="#cb28-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1413"><a href="#cb28-1413" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(logkw_results, S1_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1414"><a href="#cb28-1414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> beta, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Parameter)) <span class="sc">+</span></span>
<span id="cb28-1415"><a href="#cb28-1415" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb28-1416"><a href="#cb28-1416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"clogkw"</span>, <span class="st">"cS1"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"gray"</span>))<span class="sc">+</span></span>
<span id="cb28-1417"><a href="#cb28-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1418"><a href="#cb28-1418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"log P effect (c\u03b2)"</span>)</span>
<span id="cb28-1419"><a href="#cb28-1419" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1420"><a href="#cb28-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1421"><a href="#cb28-1421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-cpH}</span></span>
<span id="cb28-1422"><a href="#cb28-1422" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"apH"</span>,<span class="st">"capH"</span>))</span>
<span id="cb28-1423"><a href="#cb28-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1424"><a href="#cb28-1424" aria-hidden="true" tabindex="-1"></a>Acids_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1425"><a href="#cb28-1425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1426"><a href="#cb28-1426" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(capH[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1427"><a href="#cb28-1427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1428"><a href="#cb28-1428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1429"><a href="#cb28-1429" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1430"><a href="#cb28-1430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xapH=</span>capH)<span class="sc">%&gt;%</span></span>
<span id="cb28-1431"><a href="#cb28-1431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1432"><a href="#cb28-1432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1433"><a href="#cb28-1433" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1434"><a href="#cb28-1434" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1435"><a href="#cb28-1435" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1436"><a href="#cb28-1436" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1437"><a href="#cb28-1437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1438"><a href="#cb28-1438" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">apH =</span> xapH)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1439"><a href="#cb28-1439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">"A"</span>)</span>
<span id="cb28-1440"><a href="#cb28-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1441"><a href="#cb28-1441" aria-hidden="true" tabindex="-1"></a>Bases_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1442"><a href="#cb28-1442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1443"><a href="#cb28-1443" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(capH[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1444"><a href="#cb28-1444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1445"><a href="#cb28-1445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1446"><a href="#cb28-1446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1447"><a href="#cb28-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xapH=</span>capH)<span class="sc">%&gt;%</span></span>
<span id="cb28-1448"><a href="#cb28-1448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1449"><a href="#cb28-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1450"><a href="#cb28-1450" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1451"><a href="#cb28-1451" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1452"><a href="#cb28-1452" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1453"><a href="#cb28-1453" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1454"><a href="#cb28-1454" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1455"><a href="#cb28-1455" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">apH =</span> xapH)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1456"><a href="#cb28-1456" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">"B"</span>)</span>
<span id="cb28-1457"><a href="#cb28-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1458"><a href="#cb28-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1459"><a href="#cb28-1459" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(Acids_results, Bases_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1460"><a href="#cb28-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> apH, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb28-1461"><a href="#cb28-1461" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span>  </span>
<span id="cb28-1462"><a href="#cb28-1462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F8766D"</span>, <span class="st">"#619CFF"</span>))<span class="sc">+</span></span>
<span id="cb28-1463"><a href="#cb28-1463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1464"><a href="#cb28-1464" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"pH effects (capH)"</span>)</span>
<span id="cb28-1465"><a href="#cb28-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1466"><a href="#cb28-1466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1467"><a href="#cb28-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1468"><a href="#cb28-1468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-ctemp}</span></span>
<span id="cb28-1469"><a href="#cb28-1469" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"dlogkTHat"</span>,<span class="st">"cdlogkTHat"</span>))</span>
<span id="cb28-1470"><a href="#cb28-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1471"><a href="#cb28-1471" aria-hidden="true" tabindex="-1"></a>Results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1472"><a href="#cb28-1472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1473"><a href="#cb28-1473" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(cdlogkTHat[c]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1474"><a href="#cb28-1474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1475"><a href="#cb28-1475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xdlogkTHat=</span>cdlogkTHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1476"><a href="#cb28-1476" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1477"><a href="#cb28-1477" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1478"><a href="#cb28-1478" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1479"><a href="#cb28-1479" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1480"><a href="#cb28-1480" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1481"><a href="#cb28-1481" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1482"><a href="#cb28-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1483"><a href="#cb28-1483" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">dlogkTHat =</span> xdlogkTHat)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1484"><a href="#cb28-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"clogkw"</span>)</span>
<span id="cb28-1485"><a href="#cb28-1485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1486"><a href="#cb28-1486" aria-hidden="true" tabindex="-1"></a>p5<span class="ot">&lt;-</span>Results <span class="sc">%&gt;%</span></span>
<span id="cb28-1487"><a href="#cb28-1487" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> dlogkTHat, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Parameter)) <span class="sc">+</span></span>
<span id="cb28-1488"><a href="#cb28-1488" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb28-1489"><a href="#cb28-1489" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"clogkw"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb28-1490"><a href="#cb28-1490" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1491"><a href="#cb28-1491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Temp. effects (cdlogkT)"</span>)</span>
<span id="cb28-1492"><a href="#cb28-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1493"><a href="#cb28-1493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1494"><a href="#cb28-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1495"><a href="#cb28-1495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-column-effects-all}</span></span>
<span id="cb28-1496"><a href="#cb28-1496" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">grid.arrange</span>(p1<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>), </span>
<span id="cb28-1497"><a href="#cb28-1497" aria-hidden="true" tabindex="-1"></a>               p3<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>()), </span>
<span id="cb28-1498"><a href="#cb28-1498" aria-hidden="true" tabindex="-1"></a>               p4<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>),</span>
<span id="cb28-1499"><a href="#cb28-1499" aria-hidden="true" tabindex="-1"></a>               p5<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>()), </span>
<span id="cb28-1500"><a href="#cb28-1500" aria-hidden="true" tabindex="-1"></a>               p2, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">layout_matrix =</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>)))</span>
<span id="cb28-1501"><a href="#cb28-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1502"><a href="#cb28-1502" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">param</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"column-effects-all"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-1503"><a href="#cb28-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1504"><a href="#cb28-1504" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1505"><a href="#cb28-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1506"><a href="#cb28-1506" aria-hidden="true" tabindex="-1"></a>Parameters characterizing columns:</span>
<span id="cb28-1507"><a href="#cb28-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1508"><a href="#cb28-1508" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-logkw}</span></span>
<span id="cb28-1509"><a href="#cb28-1509" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"logkwHat"</span>,<span class="st">"clogkwHat"</span>,<span class="st">"dlogkwHat"</span>,<span class="st">"cdlogkwHat"</span>))</span>
<span id="cb28-1510"><a href="#cb28-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1511"><a href="#cb28-1511" aria-hidden="true" tabindex="-1"></a>Neutral_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1512"><a href="#cb28-1512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1513"><a href="#cb28-1513" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwHat,clogkwHat[c]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1514"><a href="#cb28-1514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1515"><a href="#cb28-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clogkwHat=</span>logkwHat<span class="sc">+</span>clogkwHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1516"><a href="#cb28-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,logkwHat,clogkwHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1517"><a href="#cb28-1517" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> clogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1518"><a href="#cb28-1518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>logkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1519"><a href="#cb28-1519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1520"><a href="#cb28-1520" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xlogkwHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1521"><a href="#cb28-1521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1522"><a href="#cb28-1522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1523"><a href="#cb28-1523" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1524"><a href="#cb28-1524" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1525"><a href="#cb28-1525" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1526"><a href="#cb28-1526" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1527"><a href="#cb28-1527" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1528"><a href="#cb28-1528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1529"><a href="#cb28-1529" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">logkwHat =</span> xlogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1530"><a href="#cb28-1530" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"N"</span>)</span>
<span id="cb28-1531"><a href="#cb28-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1532"><a href="#cb28-1532" aria-hidden="true" tabindex="-1"></a>Acids_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1533"><a href="#cb28-1533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1534"><a href="#cb28-1534" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwHat,clogkwHat[c],dlogkwHat[r],cdlogkwHat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1535"><a href="#cb28-1535" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1536"><a href="#cb28-1536" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1537"><a href="#cb28-1537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1538"><a href="#cb28-1538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1539"><a href="#cb28-1539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clogkwHat=</span>logkwHat<span class="sc">+</span>clogkwHat<span class="sc">+</span>dlogkwHat<span class="sc">+</span>cdlogkwHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1540"><a href="#cb28-1540" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logkwHat=</span>logkwHat<span class="sc">+</span>dlogkwHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1541"><a href="#cb28-1541" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,logkwHat,clogkwHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1542"><a href="#cb28-1542" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> clogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1543"><a href="#cb28-1543" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>logkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1544"><a href="#cb28-1544" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1545"><a href="#cb28-1545" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xlogkwHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1546"><a href="#cb28-1546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1547"><a href="#cb28-1547" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1548"><a href="#cb28-1548" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1549"><a href="#cb28-1549" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1550"><a href="#cb28-1550" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1551"><a href="#cb28-1551" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1552"><a href="#cb28-1552" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1553"><a href="#cb28-1553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1554"><a href="#cb28-1554" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">logkwHat =</span> xlogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1555"><a href="#cb28-1555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"A"</span>)</span>
<span id="cb28-1556"><a href="#cb28-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1557"><a href="#cb28-1557" aria-hidden="true" tabindex="-1"></a>Basic_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1558"><a href="#cb28-1558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1559"><a href="#cb28-1559" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwHat,clogkwHat[c],dlogkwHat[r],cdlogkwHat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1560"><a href="#cb28-1560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1561"><a href="#cb28-1561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1562"><a href="#cb28-1562" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1563"><a href="#cb28-1563" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1564"><a href="#cb28-1564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clogkwHat=</span>logkwHat<span class="sc">+</span>clogkwHat<span class="sc">+</span>dlogkwHat<span class="sc">+</span>cdlogkwHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1565"><a href="#cb28-1565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logkwHat=</span>logkwHat<span class="sc">+</span>dlogkwHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1566"><a href="#cb28-1566" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,logkwHat,clogkwHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1567"><a href="#cb28-1567" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> clogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1568"><a href="#cb28-1568" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>logkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1569"><a href="#cb28-1569" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1570"><a href="#cb28-1570" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xlogkwHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1571"><a href="#cb28-1571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1572"><a href="#cb28-1572" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1573"><a href="#cb28-1573" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1574"><a href="#cb28-1574" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1575"><a href="#cb28-1575" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1576"><a href="#cb28-1576" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1577"><a href="#cb28-1577" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1578"><a href="#cb28-1578" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1579"><a href="#cb28-1579" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">logkwHat =</span> xlogkwHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1580"><a href="#cb28-1580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"B"</span>)</span>
<span id="cb28-1581"><a href="#cb28-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1582"><a href="#cb28-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1583"><a href="#cb28-1583" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(Neutral_results, Acids_results, Basic_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1584"><a href="#cb28-1584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> logkwHat, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb28-1585"><a href="#cb28-1585" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span>  </span>
<span id="cb28-1586"><a href="#cb28-1586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"N"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F8766D"</span>, <span class="st">"#619CFF"</span>, <span class="st">"black"</span>))<span class="sc">+</span> </span>
<span id="cb28-1587"><a href="#cb28-1587" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylab</span>(<span class="st">' '</span>) <span class="sc">+</span></span>
<span id="cb28-1588"><a href="#cb28-1588" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"Typical logkw"</span>)</span>
<span id="cb28-1589"><a href="#cb28-1589" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1590"><a href="#cb28-1590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1591"><a href="#cb28-1591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-S1}</span></span>
<span id="cb28-1592"><a href="#cb28-1592" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"S1mHat"</span>,<span class="st">"cS1mHat"</span>,<span class="st">"dS1mHat"</span>,<span class="st">"cdS1mHat"</span>,</span>
<span id="cb28-1593"><a href="#cb28-1593" aria-hidden="true" tabindex="-1"></a>                                                         <span class="st">"dS1Hat"</span>,<span class="st">"cdS1Hat"</span>,<span class="st">"ddS1Hat"</span>,<span class="st">"cddS1Hat"</span>))</span>
<span id="cb28-1594"><a href="#cb28-1594" aria-hidden="true" tabindex="-1"></a>MeOH_Neutral_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1595"><a href="#cb28-1595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1596"><a href="#cb28-1596" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(S1mHat,cS1mHat[c]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1597"><a href="#cb28-1597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1598"><a href="#cb28-1598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cS1mHat=</span>S1mHat<span class="sc">+</span>cS1mHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1599"><a href="#cb28-1599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,S1mHat,cS1mHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1600"><a href="#cb28-1600" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1601"><a href="#cb28-1601" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>S1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1602"><a href="#cb28-1602" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1603"><a href="#cb28-1603" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xS1mHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1604"><a href="#cb28-1604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1605"><a href="#cb28-1605" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1606"><a href="#cb28-1606" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1607"><a href="#cb28-1607" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1608"><a href="#cb28-1608" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1609"><a href="#cb28-1609" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1610"><a href="#cb28-1610" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1611"><a href="#cb28-1611" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1612"><a href="#cb28-1612" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1613"><a href="#cb28-1613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"N"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1614"><a href="#cb28-1614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"MeOH"</span>)</span>
<span id="cb28-1615"><a href="#cb28-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1616"><a href="#cb28-1616" aria-hidden="true" tabindex="-1"></a>MeOH_Acids_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1617"><a href="#cb28-1617" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1618"><a href="#cb28-1618" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(S1mHat,cS1mHat[c],dS1mHat[r],cdS1mHat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1619"><a href="#cb28-1619" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1620"><a href="#cb28-1620" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1621"><a href="#cb28-1621" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1622"><a href="#cb28-1622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1623"><a href="#cb28-1623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cS1mHat=</span>S1mHat<span class="sc">+</span>cS1mHat<span class="sc">+</span>dS1mHat<span class="sc">+</span>cdS1mHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1624"><a href="#cb28-1624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">S1mHat=</span>S1mHat<span class="sc">+</span>dS1mHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1625"><a href="#cb28-1625" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,S1mHat,cS1mHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1626"><a href="#cb28-1626" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1627"><a href="#cb28-1627" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>S1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1628"><a href="#cb28-1628" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1629"><a href="#cb28-1629" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xS1mHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1630"><a href="#cb28-1630" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1631"><a href="#cb28-1631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1632"><a href="#cb28-1632" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1633"><a href="#cb28-1633" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1634"><a href="#cb28-1634" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1635"><a href="#cb28-1635" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1636"><a href="#cb28-1636" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1637"><a href="#cb28-1637" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1638"><a href="#cb28-1638" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1639"><a href="#cb28-1639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"A"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1640"><a href="#cb28-1640" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"MeOH"</span>)</span>
<span id="cb28-1641"><a href="#cb28-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1642"><a href="#cb28-1642" aria-hidden="true" tabindex="-1"></a>MeOH_Basic_results  <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1643"><a href="#cb28-1643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1644"><a href="#cb28-1644" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(S1mHat,cS1mHat[c],dS1mHat[r],cdS1mHat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1645"><a href="#cb28-1645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1646"><a href="#cb28-1646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1647"><a href="#cb28-1647" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1648"><a href="#cb28-1648" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1649"><a href="#cb28-1649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cS1mHat=</span>S1mHat<span class="sc">+</span>cS1mHat<span class="sc">+</span>dS1mHat<span class="sc">+</span>cdS1mHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1650"><a href="#cb28-1650" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">S1mHat=</span>S1mHat<span class="sc">+</span>dS1mHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1651"><a href="#cb28-1651" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,S1mHat,cS1mHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1652"><a href="#cb28-1652" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1653"><a href="#cb28-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>S1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1654"><a href="#cb28-1654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1655"><a href="#cb28-1655" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xS1mHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1656"><a href="#cb28-1656" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1657"><a href="#cb28-1657" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1658"><a href="#cb28-1658" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1659"><a href="#cb28-1659" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1660"><a href="#cb28-1660" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1661"><a href="#cb28-1661" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1662"><a href="#cb28-1662" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1663"><a href="#cb28-1663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1664"><a href="#cb28-1664" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1mHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1665"><a href="#cb28-1665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"B"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1666"><a href="#cb28-1666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"MeOH"</span>)</span>
<span id="cb28-1667"><a href="#cb28-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1668"><a href="#cb28-1668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1669"><a href="#cb28-1669" aria-hidden="true" tabindex="-1"></a>ACN_Neutral_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1670"><a href="#cb28-1670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1671"><a href="#cb28-1671" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(S1mHat,cS1mHat[c],dS1Hat,cdS1Hat[c]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1672"><a href="#cb28-1672" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1673"><a href="#cb28-1673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cS1aHat=</span>S1mHat<span class="sc">+</span>cS1mHat<span class="sc">+</span>dS1Hat<span class="sc">+</span>cdS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1674"><a href="#cb28-1674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">S1aHat =</span>S1mHat<span class="sc">+</span>dS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1675"><a href="#cb28-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,S1aHat,cS1aHat,c)<span class="sc">%&gt;%</span></span>
<span id="cb28-1676"><a href="#cb28-1676" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1677"><a href="#cb28-1677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>S1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1678"><a href="#cb28-1678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1679"><a href="#cb28-1679" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xS1aHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1680"><a href="#cb28-1680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1681"><a href="#cb28-1681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1682"><a href="#cb28-1682" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1683"><a href="#cb28-1683" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1684"><a href="#cb28-1684" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1685"><a href="#cb28-1685" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1686"><a href="#cb28-1686" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1687"><a href="#cb28-1687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1688"><a href="#cb28-1688" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1689"><a href="#cb28-1689" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"N"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1690"><a href="#cb28-1690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"ACN"</span>)</span>
<span id="cb28-1691"><a href="#cb28-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1692"><a href="#cb28-1692" aria-hidden="true" tabindex="-1"></a>ACN_Acids_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1693"><a href="#cb28-1693" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1694"><a href="#cb28-1694" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(S1mHat,cS1mHat[c],dS1Hat,cdS1Hat[c],dS1mHat[r],cdS1mHat[c,r],ddS1Hat[r],cddS1Hat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1695"><a href="#cb28-1695" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1696"><a href="#cb28-1696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1697"><a href="#cb28-1697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1698"><a href="#cb28-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1699"><a href="#cb28-1699" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cS1aHat=</span> S1mHat<span class="sc">+</span>cS1mHat <span class="sc">+</span> dS1mHat<span class="sc">+</span>cdS1mHat <span class="sc">+</span> dS1Hat<span class="sc">+</span>cdS1Hat <span class="sc">+</span> ddS1Hat<span class="sc">+</span> cddS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1700"><a href="#cb28-1700" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">S1aHat =</span> S1mHat<span class="sc">+</span>dS1mHat<span class="sc">+</span>dS1Hat<span class="sc">+</span>ddS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1701"><a href="#cb28-1701" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,S1aHat,cS1aHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1702"><a href="#cb28-1702" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1703"><a href="#cb28-1703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>S1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1704"><a href="#cb28-1704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1705"><a href="#cb28-1705" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xS1aHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1706"><a href="#cb28-1706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1707"><a href="#cb28-1707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1708"><a href="#cb28-1708" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1709"><a href="#cb28-1709" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1710"><a href="#cb28-1710" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1711"><a href="#cb28-1711" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1712"><a href="#cb28-1712" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1713"><a href="#cb28-1713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1714"><a href="#cb28-1714" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1715"><a href="#cb28-1715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"A"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1716"><a href="#cb28-1716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"ACN"</span>)</span>
<span id="cb28-1717"><a href="#cb28-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1718"><a href="#cb28-1718" aria-hidden="true" tabindex="-1"></a>ACN_Basic_results  <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1719"><a href="#cb28-1719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1720"><a href="#cb28-1720" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(S1mHat,cS1mHat[c],dS1Hat,cdS1Hat[c],dS1mHat[r],cdS1mHat[c,r],ddS1Hat[r],cddS1Hat[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1721"><a href="#cb28-1721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1722"><a href="#cb28-1722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1723"><a href="#cb28-1723" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1724"><a href="#cb28-1724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1725"><a href="#cb28-1725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cS1aHat=</span> S1mHat<span class="sc">+</span>cS1mHat <span class="sc">+</span> dS1mHat<span class="sc">+</span>cdS1mHat <span class="sc">+</span> dS1Hat<span class="sc">+</span>cdS1Hat <span class="sc">+</span> ddS1Hat<span class="sc">+</span>cddS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1726"><a href="#cb28-1726" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">S1aHat =</span> S1mHat<span class="sc">+</span>dS1mHat<span class="sc">+</span>dS1Hat<span class="sc">+</span>ddS1Hat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1727"><a href="#cb28-1727" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,S1aHat,cS1aHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1728"><a href="#cb28-1728" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1729"><a href="#cb28-1729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>S1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1730"><a href="#cb28-1730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1731"><a href="#cb28-1731" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xS1aHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1732"><a href="#cb28-1732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1733"><a href="#cb28-1733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1734"><a href="#cb28-1734" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1735"><a href="#cb28-1735" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1736"><a href="#cb28-1736" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1737"><a href="#cb28-1737" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1738"><a href="#cb28-1738" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1739"><a href="#cb28-1739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1740"><a href="#cb28-1740" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">S1Hat =</span> xS1aHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1741"><a href="#cb28-1741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type =</span> <span class="st">"B"</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1742"><a href="#cb28-1742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Modifier=</span><span class="st">"ACN"</span>)</span>
<span id="cb28-1743"><a href="#cb28-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1744"><a href="#cb28-1744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1745"><a href="#cb28-1745" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(MeOH_Neutral_results, MeOH_Acids_results, MeOH_Basic_results,</span>
<span id="cb28-1746"><a href="#cb28-1746" aria-hidden="true" tabindex="-1"></a>             ACN_Neutral_results,ACN_Acids_results, ACN_Basic_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1747"><a href="#cb28-1747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> S1Hat, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb28-1748"><a href="#cb28-1748" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span>  </span>
<span id="cb28-1749"><a href="#cb28-1749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"N"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F8766D"</span>, <span class="st">"#619CFF"</span>, <span class="st">"black"</span>))<span class="sc">+</span> </span>
<span id="cb28-1750"><a href="#cb28-1750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1751"><a href="#cb28-1751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Typical S1"</span>)<span class="sc">+</span></span>
<span id="cb28-1752"><a href="#cb28-1752" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Modifier)</span>
<span id="cb28-1753"><a href="#cb28-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1754"><a href="#cb28-1754" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1755"><a href="#cb28-1755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1756"><a href="#cb28-1756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-beta}</span></span>
<span id="cb28-1757"><a href="#cb28-1757" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"beta"</span>,<span class="st">"cbeta"</span>))</span>
<span id="cb28-1758"><a href="#cb28-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1759"><a href="#cb28-1759" aria-hidden="true" tabindex="-1"></a>logkw_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1760"><a href="#cb28-1760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1761"><a href="#cb28-1761" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(beta[r],cbeta[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1762"><a href="#cb28-1762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1763"><a href="#cb28-1763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1764"><a href="#cb28-1764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1765"><a href="#cb28-1765" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1766"><a href="#cb28-1766" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cbeta=</span>beta<span class="sc">+</span>cbeta)<span class="sc">%&gt;%</span></span>
<span id="cb28-1767"><a href="#cb28-1767" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,beta,cbeta,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1768"><a href="#cb28-1768" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cbeta) <span class="sc">%&gt;%</span></span>
<span id="cb28-1769"><a href="#cb28-1769" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>beta) <span class="sc">%&gt;%</span></span>
<span id="cb28-1770"><a href="#cb28-1770" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1771"><a href="#cb28-1771" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xbeta"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1772"><a href="#cb28-1772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1773"><a href="#cb28-1773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1774"><a href="#cb28-1774" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1775"><a href="#cb28-1775" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1776"><a href="#cb28-1776" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1777"><a href="#cb28-1777" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1778"><a href="#cb28-1778" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1779"><a href="#cb28-1779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1780"><a href="#cb28-1780" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">beta =</span> xbeta)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1781"><a href="#cb28-1781" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"logkw"</span>)</span>
<span id="cb28-1782"><a href="#cb28-1782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1783"><a href="#cb28-1783" aria-hidden="true" tabindex="-1"></a>S1_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1784"><a href="#cb28-1784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1785"><a href="#cb28-1785" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(beta[r],cbeta[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1786"><a href="#cb28-1786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1787"><a href="#cb28-1787" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1788"><a href="#cb28-1788" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1789"><a href="#cb28-1789" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1790"><a href="#cb28-1790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cbeta=</span>beta<span class="sc">+</span>cbeta)<span class="sc">%&gt;%</span></span>
<span id="cb28-1791"><a href="#cb28-1791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,beta,cbeta,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1792"><a href="#cb28-1792" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cbeta) <span class="sc">%&gt;%</span></span>
<span id="cb28-1793"><a href="#cb28-1793" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span>beta) <span class="sc">%&gt;%</span></span>
<span id="cb28-1794"><a href="#cb28-1794" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1795"><a href="#cb28-1795" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xbeta"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1796"><a href="#cb28-1796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1797"><a href="#cb28-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1798"><a href="#cb28-1798" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1799"><a href="#cb28-1799" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1800"><a href="#cb28-1800" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1801"><a href="#cb28-1801" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1802"><a href="#cb28-1802" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1803"><a href="#cb28-1803" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1804"><a href="#cb28-1804" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">beta =</span> xbeta)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1805"><a href="#cb28-1805" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"S1"</span>)</span>
<span id="cb28-1806"><a href="#cb28-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1807"><a href="#cb28-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1808"><a href="#cb28-1808" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(logkw_results, S1_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1809"><a href="#cb28-1809" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> beta, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Parameter)) <span class="sc">+</span></span>
<span id="cb28-1810"><a href="#cb28-1810" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb28-1811"><a href="#cb28-1811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"logkw"</span>, <span class="st">"S1"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"gray"</span>))<span class="sc">+</span></span>
<span id="cb28-1812"><a href="#cb28-1812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1813"><a href="#cb28-1813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"logP effects (\u03b2)"</span>)</span>
<span id="cb28-1814"><a href="#cb28-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1815"><a href="#cb28-1815" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1816"><a href="#cb28-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1817"><a href="#cb28-1817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-pH}</span></span>
<span id="cb28-1818"><a href="#cb28-1818" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"apH"</span>,<span class="st">"capH"</span>))</span>
<span id="cb28-1819"><a href="#cb28-1819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1820"><a href="#cb28-1820" aria-hidden="true" tabindex="-1"></a>Acids_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1821"><a href="#cb28-1821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1822"><a href="#cb28-1822" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(apH[r], capH[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1823"><a href="#cb28-1823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1824"><a href="#cb28-1824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1825"><a href="#cb28-1825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1826"><a href="#cb28-1826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1827"><a href="#cb28-1827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">capH=</span>apH<span class="sc">+</span>capH)<span class="sc">%&gt;%</span></span>
<span id="cb28-1828"><a href="#cb28-1828" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,apH,capH,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1829"><a href="#cb28-1829" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> capH) <span class="sc">%&gt;%</span></span>
<span id="cb28-1830"><a href="#cb28-1830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span> apH) <span class="sc">%&gt;%</span></span>
<span id="cb28-1831"><a href="#cb28-1831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1832"><a href="#cb28-1832" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xapH"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1833"><a href="#cb28-1833" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1834"><a href="#cb28-1834" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1835"><a href="#cb28-1835" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1836"><a href="#cb28-1836" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1837"><a href="#cb28-1837" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1838"><a href="#cb28-1838" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1839"><a href="#cb28-1839" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1840"><a href="#cb28-1840" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1841"><a href="#cb28-1841" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">apH =</span> xapH)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1842"><a href="#cb28-1842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">"A"</span>)</span>
<span id="cb28-1843"><a href="#cb28-1843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1844"><a href="#cb28-1844" aria-hidden="true" tabindex="-1"></a>Bases_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1845"><a href="#cb28-1845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1846"><a href="#cb28-1846" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(apH[r], capH[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1847"><a href="#cb28-1847" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">==</span><span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1848"><a href="#cb28-1848" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1849"><a href="#cb28-1849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>r) <span class="sc">%&gt;%</span></span>
<span id="cb28-1850"><a href="#cb28-1850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1851"><a href="#cb28-1851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">capH=</span>apH<span class="sc">+</span>capH)<span class="sc">%&gt;%</span></span>
<span id="cb28-1852"><a href="#cb28-1852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,apH,capH,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1853"><a href="#cb28-1853" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> capH) <span class="sc">%&gt;%</span></span>
<span id="cb28-1854"><a href="#cb28-1854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span> apH) <span class="sc">%&gt;%</span></span>
<span id="cb28-1855"><a href="#cb28-1855" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1856"><a href="#cb28-1856" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xapH"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1857"><a href="#cb28-1857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1858"><a href="#cb28-1858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1859"><a href="#cb28-1859" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1860"><a href="#cb28-1860" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1861"><a href="#cb28-1861" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1862"><a href="#cb28-1862" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1863"><a href="#cb28-1863" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1864"><a href="#cb28-1864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1865"><a href="#cb28-1865" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">apH =</span> xapH)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1866"><a href="#cb28-1866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Type=</span><span class="st">"B"</span>)</span>
<span id="cb28-1867"><a href="#cb28-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1868"><a href="#cb28-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1869"><a href="#cb28-1869" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(Acids_results, Bases_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1870"><a href="#cb28-1870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> apH, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Type)) <span class="sc">+</span></span>
<span id="cb28-1871"><a href="#cb28-1871" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span>  </span>
<span id="cb28-1872"><a href="#cb28-1872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F8766D"</span>, <span class="st">"#619CFF"</span>))<span class="sc">+</span></span>
<span id="cb28-1873"><a href="#cb28-1873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1874"><a href="#cb28-1874" aria-hidden="true" tabindex="-1"></a>   <span class="fu">xlab</span>(<span class="st">"pH effects (apH)"</span>)</span>
<span id="cb28-1875"><a href="#cb28-1875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1876"><a href="#cb28-1876" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1877"><a href="#cb28-1877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1878"><a href="#cb28-1878" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-temp}</span></span>
<span id="cb28-1879"><a href="#cb28-1879" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"dlogkTHat"</span>,<span class="st">"cdlogkTHat"</span>))</span>
<span id="cb28-1880"><a href="#cb28-1880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1881"><a href="#cb28-1881" aria-hidden="true" tabindex="-1"></a>Results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1882"><a href="#cb28-1882" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1883"><a href="#cb28-1883" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(dlogkTHat, cdlogkTHat[c]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1884"><a href="#cb28-1884" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1885"><a href="#cb28-1885" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">c=</span>c<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-1886"><a href="#cb28-1886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdlogkTHat=</span>dlogkTHat<span class="sc">+</span>cdlogkTHat)<span class="sc">%&gt;%</span></span>
<span id="cb28-1887"><a href="#cb28-1887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,dlogkTHat,cdlogkTHat,c) <span class="sc">%&gt;%</span></span>
<span id="cb28-1888"><a href="#cb28-1888" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> cdlogkTHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1889"><a href="#cb28-1889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">1</span><span class="st">`</span><span class="ot">=</span> dlogkTHat) <span class="sc">%&gt;%</span></span>
<span id="cb28-1890"><a href="#cb28-1890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>.draw)<span class="sc">%&gt;%</span></span>
<span id="cb28-1891"><a href="#cb28-1891" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>),<span class="at">names_to =</span> <span class="st">"ColumnNames"</span>, <span class="at">values_to =</span> <span class="st">"xdlogkTHat"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1892"><a href="#cb28-1892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1893"><a href="#cb28-1893" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(ColumnNames,</span>
<span id="cb28-1894"><a href="#cb28-1894" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XBridge Shield RP18'</span>,</span>
<span id="cb28-1895"><a href="#cb28-1895" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1896"><a href="#cb28-1896" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1897"><a href="#cb28-1897" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1898"><a href="#cb28-1898" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'5'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1899"><a href="#cb28-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1900"><a href="#cb28-1900" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">dlogkTHat =</span> xdlogkTHat)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1901"><a href="#cb28-1901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"logkw"</span>)</span>
<span id="cb28-1902"><a href="#cb28-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1903"><a href="#cb28-1903" aria-hidden="true" tabindex="-1"></a>p5<span class="ot">&lt;-</span>Results <span class="sc">%&gt;%</span></span>
<span id="cb28-1904"><a href="#cb28-1904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> dlogkTHat, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper,<span class="at">color =</span> Parameter)) <span class="sc">+</span></span>
<span id="cb28-1905"><a href="#cb28-1905" aria-hidden="true" tabindex="-1"></a>   tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb28-1906"><a href="#cb28-1906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"logkw"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb28-1907"><a href="#cb28-1907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1908"><a href="#cb28-1908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Temp. effects (dlogkT)"</span>)</span>
<span id="cb28-1909"><a href="#cb28-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1910"><a href="#cb28-1910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1911"><a href="#cb28-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1912"><a href="#cb28-1912" aria-hidden="true" tabindex="-1"></a><span class="in">```{r column-parameters-all}</span></span>
<span id="cb28-1913"><a href="#cb28-1913" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">grid.arrange</span>(p1<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>), </span>
<span id="cb28-1914"><a href="#cb28-1914" aria-hidden="true" tabindex="-1"></a>               p3<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>()), </span>
<span id="cb28-1915"><a href="#cb28-1915" aria-hidden="true" tabindex="-1"></a>               p4<span class="sc">+</span> <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>),</span>
<span id="cb28-1916"><a href="#cb28-1916" aria-hidden="true" tabindex="-1"></a>               p5<span class="sc">+</span><span class="fu">theme</span>(<span class="at">axis.text.y=</span><span class="fu">element_blank</span>()), </span>
<span id="cb28-1917"><a href="#cb28-1917" aria-hidden="true" tabindex="-1"></a>               p2, <span class="at">ncol=</span><span class="dv">2</span>, <span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), <span class="at">layout_matrix =</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>)))</span>
<span id="cb28-1918"><a href="#cb28-1918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1919"><a href="#cb28-1919" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">param</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"column-parameters-all"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-1920"><a href="#cb28-1920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1921"><a href="#cb28-1921" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1922"><a href="#cb28-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1923"><a href="#cb28-1923" aria-hidden="true" tabindex="-1"></a>Standard deviations:</span>
<span id="cb28-1924"><a href="#cb28-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1925"><a href="#cb28-1925" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sd-column-effects-all}</span></span>
<span id="cb28-1926"><a href="#cb28-1926" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">"comega"</span>,<span class="st">"ckappa"</span>,<span class="st">"crho"</span>))</span>
<span id="cb28-1927"><a href="#cb28-1927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1928"><a href="#cb28-1928" aria-hidden="true" tabindex="-1"></a>comega_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1929"><a href="#cb28-1929" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1930"><a href="#cb28-1930" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(comega[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1931"><a href="#cb28-1931" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1932"><a href="#cb28-1932" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xparam=</span>comega)<span class="sc">%&gt;%</span></span>
<span id="cb28-1933"><a href="#cb28-1933" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1934"><a href="#cb28-1934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1935"><a href="#cb28-1935" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1936"><a href="#cb28-1936" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1937"><a href="#cb28-1937" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1938"><a href="#cb28-1938" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1939"><a href="#cb28-1939" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ParamNames=</span><span class="fu">recode</span>(r,</span>
<span id="cb28-1940"><a href="#cb28-1940" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'clogkw'</span>,</span>
<span id="cb28-1941"><a href="#cb28-1941" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'cS1m'</span>,</span>
<span id="cb28-1942"><a href="#cb28-1942" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'cdS1'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1943"><a href="#cb28-1943" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames,ParamNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1944"><a href="#cb28-1944" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">param =</span> xparam)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1945"><a href="#cb28-1945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"comega"</span>)</span>
<span id="cb28-1946"><a href="#cb28-1946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1947"><a href="#cb28-1947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1948"><a href="#cb28-1948" aria-hidden="true" tabindex="-1"></a>ckappa_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1949"><a href="#cb28-1949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1950"><a href="#cb28-1950" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(ckappa[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1951"><a href="#cb28-1951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1952"><a href="#cb28-1952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">xparam=</span>ckappa)<span class="sc">%&gt;%</span></span>
<span id="cb28-1953"><a href="#cb28-1953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span> </span>
<span id="cb28-1954"><a href="#cb28-1954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ColumnNames=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1955"><a href="#cb28-1955" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1956"><a href="#cb28-1956" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1957"><a href="#cb28-1957" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1958"><a href="#cb28-1958" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1959"><a href="#cb28-1959" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ParamNames=</span><span class="fu">recode</span>(r,</span>
<span id="cb28-1960"><a href="#cb28-1960" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'clogkw'</span>,</span>
<span id="cb28-1961"><a href="#cb28-1961" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'cS1m'</span>,</span>
<span id="cb28-1962"><a href="#cb28-1962" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'cdS1'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1963"><a href="#cb28-1963" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ColumnNames,ParamNames)<span class="sc">%&gt;%</span></span>
<span id="cb28-1964"><a href="#cb28-1964" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">param =</span> xparam)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1965"><a href="#cb28-1965" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"ckappa"</span>)</span>
<span id="cb28-1966"><a href="#cb28-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1967"><a href="#cb28-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1968"><a href="#cb28-1968" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">bind_rows</span>(comega_results, ckappa_results) <span class="sc">%&gt;%</span></span>
<span id="cb28-1969"><a href="#cb28-1969" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ParamNames=</span><span class="fu">factor</span>(ParamNames,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"clogkw"</span>,<span class="st">"cS1m"</span>,<span class="st">"cdS1"</span>)))<span class="sc">%&gt;%</span></span>
<span id="cb28-1970"><a href="#cb28-1970" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> ColumnNames, <span class="at">x =</span> param, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper, <span class="at">color=</span>ParamNames)) <span class="sc">+</span></span>
<span id="cb28-1971"><a href="#cb28-1971" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb28-1972"><a href="#cb28-1972" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">" "</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">"clogkw"</span> <span class="ot">=</span> <span class="st">"#F8766D"</span>,<span class="st">"cS1m"</span> <span class="ot">=</span> <span class="st">"#619CFF"</span>,<span class="st">"cdS1"</span> <span class="ot">=</span> <span class="st">"#00BA38"</span>)) <span class="sc">+</span></span>
<span id="cb28-1973"><a href="#cb28-1973" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span><span class="fu">factor</span>(Parameter,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">"comega"</span>,<span class="st">"ckappa"</span>),<span class="at">labels=</span><span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"c"</span>,omega)),<span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"c"</span>,kappa)))),<span class="at">labeller =</span> label_parsed)<span class="sc">+</span></span>
<span id="cb28-1974"><a href="#cb28-1974" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-1975"><a href="#cb28-1975" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"standard deviations"</span>)</span>
<span id="cb28-1976"><a href="#cb28-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1977"><a href="#cb28-1977" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-1978"><a href="#cb28-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1979"><a href="#cb28-1979" aria-hidden="true" tabindex="-1"></a>crho_results <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-1980"><a href="#cb28-1980" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-1981"><a href="#cb28-1981" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(crho[c,r]) <span class="sc">%&gt;%</span></span>
<span id="cb28-1982"><a href="#cb28-1982" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-1983"><a href="#cb28-1983" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">columnnames1=</span><span class="fu">recode</span>(c,</span>
<span id="cb28-1984"><a href="#cb28-1984" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1985"><a href="#cb28-1985" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1986"><a href="#cb28-1986" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1987"><a href="#cb28-1987" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1988"><a href="#cb28-1988" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">columnnames2=</span><span class="fu">recode</span>(r,</span>
<span id="cb28-1989"><a href="#cb28-1989" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'1'</span> <span class="ot">=</span> <span class="st">'XTerra MS C18'</span>,</span>
<span id="cb28-1990"><a href="#cb28-1990" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'2'</span> <span class="ot">=</span> <span class="st">'XBridge Phenyl'</span>,</span>
<span id="cb28-1991"><a href="#cb28-1991" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'3'</span> <span class="ot">=</span> <span class="st">'XBridge C8'</span>,</span>
<span id="cb28-1992"><a href="#cb28-1992" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'4'</span> <span class="ot">=</span> <span class="st">'Xterra MS C8'</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb28-1993"><a href="#cb28-1993" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">namelong=</span><span class="fu">paste0</span>(<span class="st">"crho"</span>,<span class="st">"("</span>, columnnames1,<span class="st">","</span>, columnnames2, <span class="st">")"</span> )) <span class="sc">%&gt;%</span></span>
<span id="cb28-1994"><a href="#cb28-1994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name=</span><span class="fu">paste0</span>(c,r))<span class="sc">%&gt;%</span></span>
<span id="cb28-1995"><a href="#cb28-1995" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.character,as.factor) <span class="sc">%&gt;%</span></span>
<span id="cb28-1996"><a href="#cb28-1996" aria-hidden="true" tabindex="-1"></a>  <span class="fu">subset</span>(name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">21</span>,<span class="dv">31</span>,<span class="dv">32</span>,<span class="dv">41</span>,<span class="dv">42</span>,<span class="dv">43</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-1997"><a href="#cb28-1997" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(namelong)<span class="sc">%&gt;%</span></span>
<span id="cb28-1998"><a href="#cb28-1998" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">median_qi</span>(<span class="at">param =</span> crho)<span class="sc">%&gt;%</span> </span>
<span id="cb28-1999"><a href="#cb28-1999" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Parameter=</span><span class="st">"crho"</span>)</span>
<span id="cb28-2000"><a href="#cb28-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2001"><a href="#cb28-2001" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">ggplot</span>(crho_results,<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">as.factor</span>(namelong), <span class="at">x =</span> param, <span class="at">xmin =</span> .lower, <span class="at">xmax =</span> .upper), <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb28-2002"><a href="#cb28-2002" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">geom_pointinterval</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> .<span class="dv">3</span>)) <span class="sc">+</span> </span>
<span id="cb28-2003"><a href="#cb28-2003" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">' '</span>)<span class="sc">+</span></span>
<span id="cb28-2004"><a href="#cb28-2004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"crho"</span>)<span class="sc">+</span></span>
<span id="cb28-2005"><a href="#cb28-2005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">'none'</span>)<span class="sc">+</span></span>
<span id="cb28-2006"><a href="#cb28-2006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">position =</span> <span class="st">"right"</span>)</span>
<span id="cb28-2007"><a href="#cb28-2007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2008"><a href="#cb28-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2009"><a href="#cb28-2009" aria-hidden="true" tabindex="-1"></a>p<span class="ot">=</span><span class="fu">grid.arrange</span>(p1, </span>
<span id="cb28-2010"><a href="#cb28-2010" aria-hidden="true" tabindex="-1"></a>               p2, <span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb28-2011"><a href="#cb28-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2012"><a href="#cb28-2012" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">param</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"sd-column-effects-all"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">10</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2013"><a href="#cb28-2013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2014"><a href="#cb28-2014" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2015"><a href="#cb28-2015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2016"><a href="#cb28-2016" aria-hidden="true" tabindex="-1"></a><span class="fu">## Isocratic predictions</span></span>
<span id="cb28-2017"><a href="#cb28-2017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2018"><a href="#cb28-2018" aria-hidden="true" tabindex="-1"></a>To better asses the impact of parameters on retention we created graphs presenting the isocratic logarithm of retention factor vs. $\varphi$ for selected analytes. Separate graphs are shown for each dissociation form (r=1,r=2,r=3). Here the individual predictions (given all the data) are shown:</span>
<span id="cb28-2019"><a href="#cb28-2019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2020"><a href="#cb28-2020" aria-hidden="true" tabindex="-1"></a><span class="in">```{r izo-pred-individual}</span></span>
<span id="cb28-2021"><a href="#cb28-2021" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-2022"><a href="#cb28-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2023"><a href="#cb28-2023" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-2024"><a href="#cb28-2024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2025"><a href="#cb28-2025" aria-hidden="true" tabindex="-1"></a>idx_analyte <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID)<span class="sc">==</span>analyte_ID_sample[i])</span>
<span id="cb28-2026"><a href="#cb28-2026" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(</span>
<span id="cb28-2027"><a href="#cb28-2027" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2028"><a href="#cb28-2028" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2029"><a href="#cb28-2029" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2030"><a href="#cb28-2030" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2031"><a href="#cb28-2031" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,2]"</span>,idx_analyte),</span>
<span id="cb28-2032"><a href="#cb28-2032" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,3]"</span>,idx_analyte),</span>
<span id="cb28-2033"><a href="#cb28-2033" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2034"><a href="#cb28-2034" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,2]"</span>,idx_analyte),</span>
<span id="cb28-2035"><a href="#cb28-2035" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,3]"</span>,idx_analyte),</span>
<span id="cb28-2036"><a href="#cb28-2036" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2037"><a href="#cb28-2037" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,2]"</span>,idx_analyte),</span>
<span id="cb28-2038"><a href="#cb28-2038" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,3]"</span>,idx_analyte),</span>
<span id="cb28-2039"><a href="#cb28-2039" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2040"><a href="#cb28-2040" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,2]"</span>,idx_analyte),</span>
<span id="cb28-2041"><a href="#cb28-2041" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,3]"</span>,idx_analyte),</span>
<span id="cb28-2042"><a href="#cb28-2042" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2043"><a href="#cb28-2043" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2044"><a href="#cb28-2044" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2045"><a href="#cb28-2045" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2046"><a href="#cb28-2046" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2047"><a href="#cb28-2047" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2048"><a href="#cb28-2048" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2049"><a href="#cb28-2049" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,2]"</span>,idx_analyte), </span>
<span id="cb28-2050"><a href="#cb28-2050" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,3]"</span>,idx_analyte), </span>
<span id="cb28-2051"><a href="#cb28-2051" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2052"><a href="#cb28-2052" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,2]"</span>,idx_analyte), </span>
<span id="cb28-2053"><a href="#cb28-2053" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,3]"</span>,idx_analyte),</span>
<span id="cb28-2054"><a href="#cb28-2054" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2055"><a href="#cb28-2055" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,2]"</span>,idx_analyte), </span>
<span id="cb28-2056"><a href="#cb28-2056" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,3]"</span>,idx_analyte), </span>
<span id="cb28-2057"><a href="#cb28-2057" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2058"><a href="#cb28-2058" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,2]"</span>,idx_analyte), </span>
<span id="cb28-2059"><a href="#cb28-2059" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,3]"</span>,idx_analyte),</span>
<span id="cb28-2060"><a href="#cb28-2060" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2061"><a href="#cb28-2061" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,2]"</span>,idx_analyte), </span>
<span id="cb28-2062"><a href="#cb28-2062" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,3]"</span>,idx_analyte), </span>
<span id="cb28-2063"><a href="#cb28-2063" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2064"><a href="#cb28-2064" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,2]"</span>,idx_analyte), </span>
<span id="cb28-2065"><a href="#cb28-2065" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,3]"</span>,idx_analyte),</span>
<span id="cb28-2066"><a href="#cb28-2066" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2067"><a href="#cb28-2067" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,2]"</span>,idx_analyte), </span>
<span id="cb28-2068"><a href="#cb28-2068" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,3]"</span>,idx_analyte), </span>
<span id="cb28-2069"><a href="#cb28-2069" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2070"><a href="#cb28-2070" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,2]"</span>,idx_analyte), </span>
<span id="cb28-2071"><a href="#cb28-2071" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,3]"</span>,idx_analyte),</span>
<span id="cb28-2072"><a href="#cb28-2072" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2x[1,1]"</span>, </span>
<span id="cb28-2073"><a href="#cb28-2073" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2x[2,1]"</span>))</span>
<span id="cb28-2074"><a href="#cb28-2074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2075"><a href="#cb28-2075" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-2076"><a href="#cb28-2076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-2077"><a href="#cb28-2077" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwx[, c, r], S1x[, m, c, r], S2x[m, ]) <span class="sc">%&gt;%</span></span>
<span id="cb28-2078"><a href="#cb28-2078" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">&lt;=</span>R[idx_analyte]<span class="sc">+</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb28-2079"><a href="#cb28-2079" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">fi =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2080"><a href="#cb28-2080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logk =</span> logkwx<span class="sc">-</span>S1x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>S2x)<span class="sc">*</span>fi<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>S2x<span class="sc">*</span>fi)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2081"><a href="#cb28-2081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fi, <span class="at">y =</span> logk, <span class="at">color =</span> <span class="fu">as.factor</span>(c), <span class="at">fill =</span> <span class="fu">as.factor</span>(c))) <span class="sc">+</span></span>
<span id="cb28-2082"><a href="#cb28-2082" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-2083"><a href="#cb28-2083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(m<span class="sc">~</span>r, <span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">m=</span>mod.labs,<span class="at">r=</span>diss.labs))<span class="sc">+</span></span>
<span id="cb28-2084"><a href="#cb28-2084" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]),<span class="at">color=</span> <span class="st">" "</span>,<span class="at">fill=</span> <span class="st">" "</span>, <span class="at">x=</span><span class="st">"\u03C6"</span>, <span class="at">y=</span><span class="st">"logk (individual)"</span>)<span class="sc">+</span></span>
<span id="cb28-2085"><a href="#cb28-2085" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)) <span class="sc">+</span></span>
<span id="cb28-2086"><a href="#cb28-2086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>))<span class="sc">+</span></span>
<span id="cb28-2087"><a href="#cb28-2087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">color=</span><span class="st">"gray"</span>)  <span class="sc">+</span> </span>
<span id="cb28-2088"><a href="#cb28-2088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb28-2089"><a href="#cb28-2089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2090"><a href="#cb28-2090" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-2091"><a href="#cb28-2091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2092"><a href="#cb28-2092" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">izoparam</span><span class="sc">\\</span><span class="st">isopred</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".individual"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2093"><a href="#cb28-2093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2094"><a href="#cb28-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2095"><a href="#cb28-2095" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2096"><a href="#cb28-2096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2097"><a href="#cb28-2097" aria-hidden="true" tabindex="-1"></a><span class="co"># AGG as the graphic backend of RStudio. (Tools -&gt; Global Options -&gt; General -&gt; Graphics)</span></span>
<span id="cb28-2098"><a href="#cb28-2098" aria-hidden="true" tabindex="-1"></a><span class="co"># https://github.com/tidyverse/ggplot2/issues/4661</span></span>
<span id="cb28-2099"><a href="#cb28-2099" aria-hidden="true" tabindex="-1"></a><span class="co"># otherwise coord_cartesian does not work</span></span>
<span id="cb28-2100"><a href="#cb28-2100" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2101"><a href="#cb28-2101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2102"><a href="#cb28-2102" aria-hidden="true" tabindex="-1"></a>Similarly we can quantify the column effects (between column differences in logk using XBridge Shield RP18 as a reference column):</span>
<span id="cb28-2103"><a href="#cb28-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2104"><a href="#cb28-2104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r izo-diff-individual}</span></span>
<span id="cb28-2105"><a href="#cb28-2105" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-2106"><a href="#cb28-2106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2107"><a href="#cb28-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2108"><a href="#cb28-2108" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-2109"><a href="#cb28-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2110"><a href="#cb28-2110" aria-hidden="true" tabindex="-1"></a>idx_analyte <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID)<span class="sc">==</span>analyte_ID_sample[i])</span>
<span id="cb28-2111"><a href="#cb28-2111" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(</span>
<span id="cb28-2112"><a href="#cb28-2112" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2113"><a href="#cb28-2113" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2114"><a href="#cb28-2114" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2115"><a href="#cb28-2115" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2116"><a href="#cb28-2116" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,2]"</span>,idx_analyte),</span>
<span id="cb28-2117"><a href="#cb28-2117" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,3]"</span>,idx_analyte),</span>
<span id="cb28-2118"><a href="#cb28-2118" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2119"><a href="#cb28-2119" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,2]"</span>,idx_analyte),</span>
<span id="cb28-2120"><a href="#cb28-2120" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,3]"</span>,idx_analyte),</span>
<span id="cb28-2121"><a href="#cb28-2121" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2122"><a href="#cb28-2122" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,2]"</span>,idx_analyte),</span>
<span id="cb28-2123"><a href="#cb28-2123" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,3]"</span>,idx_analyte),</span>
<span id="cb28-2124"><a href="#cb28-2124" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2125"><a href="#cb28-2125" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,2]"</span>,idx_analyte),</span>
<span id="cb28-2126"><a href="#cb28-2126" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,3]"</span>,idx_analyte),</span>
<span id="cb28-2127"><a href="#cb28-2127" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2128"><a href="#cb28-2128" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2129"><a href="#cb28-2129" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2130"><a href="#cb28-2130" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2131"><a href="#cb28-2131" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2132"><a href="#cb28-2132" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2133"><a href="#cb28-2133" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2134"><a href="#cb28-2134" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,2]"</span>,idx_analyte), </span>
<span id="cb28-2135"><a href="#cb28-2135" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,3]"</span>,idx_analyte), </span>
<span id="cb28-2136"><a href="#cb28-2136" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2137"><a href="#cb28-2137" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,2]"</span>,idx_analyte), </span>
<span id="cb28-2138"><a href="#cb28-2138" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,3]"</span>,idx_analyte),</span>
<span id="cb28-2139"><a href="#cb28-2139" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2140"><a href="#cb28-2140" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,2]"</span>,idx_analyte), </span>
<span id="cb28-2141"><a href="#cb28-2141" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,3]"</span>,idx_analyte), </span>
<span id="cb28-2142"><a href="#cb28-2142" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2143"><a href="#cb28-2143" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,2]"</span>,idx_analyte), </span>
<span id="cb28-2144"><a href="#cb28-2144" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,3]"</span>,idx_analyte),</span>
<span id="cb28-2145"><a href="#cb28-2145" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2146"><a href="#cb28-2146" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,2]"</span>,idx_analyte), </span>
<span id="cb28-2147"><a href="#cb28-2147" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,3]"</span>,idx_analyte), </span>
<span id="cb28-2148"><a href="#cb28-2148" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2149"><a href="#cb28-2149" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,2]"</span>,idx_analyte), </span>
<span id="cb28-2150"><a href="#cb28-2150" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,3]"</span>,idx_analyte),</span>
<span id="cb28-2151"><a href="#cb28-2151" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2152"><a href="#cb28-2152" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,2]"</span>,idx_analyte), </span>
<span id="cb28-2153"><a href="#cb28-2153" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,3]"</span>,idx_analyte), </span>
<span id="cb28-2154"><a href="#cb28-2154" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2155"><a href="#cb28-2155" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,2]"</span>,idx_analyte), </span>
<span id="cb28-2156"><a href="#cb28-2156" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,3]"</span>,idx_analyte),</span>
<span id="cb28-2157"><a href="#cb28-2157" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2x[1,1]"</span>, </span>
<span id="cb28-2158"><a href="#cb28-2158" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2x[2,1]"</span>))</span>
<span id="cb28-2159"><a href="#cb28-2159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2160"><a href="#cb28-2160" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-2161"><a href="#cb28-2161" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-2162"><a href="#cb28-2162" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwx[, c, r], S1x[, m, c, r], S2x[m, ]) <span class="sc">%&gt;%</span></span>
<span id="cb28-2163"><a href="#cb28-2163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">&lt;=</span>R[idx_analyte]<span class="sc">+</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-2164"><a href="#cb28-2164" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">fi =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2165"><a href="#cb28-2165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">k =</span> (logkwx<span class="sc">-</span>S1x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>S2x)<span class="sc">*</span>fi<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>S2x<span class="sc">*</span>fi))) <span class="sc">%&gt;%</span></span>
<span id="cb28-2166"><a href="#cb28-2166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,c,r,m,k,fi) <span class="sc">%&gt;%</span></span>
<span id="cb28-2167"><a href="#cb28-2167" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> k) <span class="sc">%&gt;%</span></span>
<span id="cb28-2168"><a href="#cb28-2168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdk2 =</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">1</span><span class="st">`</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb28-2169"><a href="#cb28-2169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdk3 =</span> <span class="st">`</span><span class="at">3</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">1</span><span class="st">`</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb28-2170"><a href="#cb28-2170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdk4 =</span> <span class="st">`</span><span class="at">4</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">1</span><span class="st">`</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb28-2171"><a href="#cb28-2171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdk5 =</span> <span class="st">`</span><span class="at">5</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">1</span><span class="st">`</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb28-2172"><a href="#cb28-2172" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(cdk2<span class="sc">:</span>cdk5,<span class="at">names_to =</span> <span class="st">"names_cdk"</span>, <span class="at">values_to =</span> <span class="st">"cdk"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-2173"><a href="#cb28-2173" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fi, <span class="at">y =</span> cdk, <span class="at">color =</span> <span class="fu">as.factor</span>(names_cdk), <span class="at">fill =</span> <span class="fu">as.factor</span>(names_cdk))) <span class="sc">+</span></span>
<span id="cb28-2174"><a href="#cb28-2174" aria-hidden="true" tabindex="-1"></a>   ggdist<span class="sc">::</span><span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-2175"><a href="#cb28-2175" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(m<span class="sc">~</span>r, <span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">m=</span>mod.labs,<span class="at">r=</span>diss.labs))<span class="sc">+</span></span>
<span id="cb28-2176"><a href="#cb28-2176" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Between column difference in logk (individual)"</span>, <span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]),<span class="at">color=</span> <span class="st">" "</span>,<span class="at">fill=</span> <span class="st">" "</span>, <span class="at">x=</span><span class="st">"\u03C6"</span>)<span class="sc">+</span></span>
<span id="cb28-2177"><a href="#cb28-2177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)) <span class="sc">+</span></span>
<span id="cb28-2178"><a href="#cb28-2178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>))<span class="sc">+</span></span>
<span id="cb28-2179"><a href="#cb28-2179" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept=</span> <span class="fu">c</span>(<span class="dv">0</span>), <span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">color=</span><span class="st">"gray"</span>) <span class="sc">+</span> </span>
<span id="cb28-2180"><a href="#cb28-2180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb28-2181"><a href="#cb28-2181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2182"><a href="#cb28-2182" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(p)</span>
<span id="cb28-2183"><a href="#cb28-2183" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb28-2184"><a href="#cb28-2184" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">izoparam</span><span class="sc">\\</span><span class="st">diff</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".individual"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2185"><a href="#cb28-2185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2186"><a href="#cb28-2186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2187"><a href="#cb28-2187" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2188"><a href="#cb28-2188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2189"><a href="#cb28-2189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2190"><a href="#cb28-2190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2191"><a href="#cb28-2191" aria-hidden="true" tabindex="-1"></a>or predict the organic modifier content leading to logk of 1:</span>
<span id="cb28-2192"><a href="#cb28-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2193"><a href="#cb28-2193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r izo-logk1-individual}</span></span>
<span id="cb28-2194"><a href="#cb28-2194" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-2195"><a href="#cb28-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2196"><a href="#cb28-2196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2197"><a href="#cb28-2197" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-2198"><a href="#cb28-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2199"><a href="#cb28-2199" aria-hidden="true" tabindex="-1"></a>idx_analyte <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID)<span class="sc">==</span>analyte_ID_sample[i])</span>
<span id="cb28-2200"><a href="#cb28-2200" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>, <span class="at">variable =</span> <span class="fu">c</span>(</span>
<span id="cb28-2201"><a href="#cb28-2201" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2202"><a href="#cb28-2202" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2203"><a href="#cb28-2203" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2204"><a href="#cb28-2204" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2205"><a href="#cb28-2205" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,2]"</span>,idx_analyte),</span>
<span id="cb28-2206"><a href="#cb28-2206" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,2,3]"</span>,idx_analyte),</span>
<span id="cb28-2207"><a href="#cb28-2207" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2208"><a href="#cb28-2208" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,2]"</span>,idx_analyte),</span>
<span id="cb28-2209"><a href="#cb28-2209" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,3,3]"</span>,idx_analyte),</span>
<span id="cb28-2210"><a href="#cb28-2210" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2211"><a href="#cb28-2211" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,2]"</span>,idx_analyte),</span>
<span id="cb28-2212"><a href="#cb28-2212" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,4,3]"</span>,idx_analyte),</span>
<span id="cb28-2213"><a href="#cb28-2213" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2214"><a href="#cb28-2214" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,2]"</span>,idx_analyte),</span>
<span id="cb28-2215"><a href="#cb28-2215" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwx[%s,5,3]"</span>,idx_analyte),</span>
<span id="cb28-2216"><a href="#cb28-2216" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2217"><a href="#cb28-2217" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2218"><a href="#cb28-2218" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2219"><a href="#cb28-2219" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,1]"</span>,idx_analyte), </span>
<span id="cb28-2220"><a href="#cb28-2220" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,2]"</span>,idx_analyte), </span>
<span id="cb28-2221"><a href="#cb28-2221" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,1,3]"</span>,idx_analyte),</span>
<span id="cb28-2222"><a href="#cb28-2222" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2223"><a href="#cb28-2223" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,2]"</span>,idx_analyte), </span>
<span id="cb28-2224"><a href="#cb28-2224" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,2,3]"</span>,idx_analyte), </span>
<span id="cb28-2225"><a href="#cb28-2225" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,1]"</span>,idx_analyte), </span>
<span id="cb28-2226"><a href="#cb28-2226" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,2]"</span>,idx_analyte), </span>
<span id="cb28-2227"><a href="#cb28-2227" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,2,3]"</span>,idx_analyte),</span>
<span id="cb28-2228"><a href="#cb28-2228" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2229"><a href="#cb28-2229" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,2]"</span>,idx_analyte), </span>
<span id="cb28-2230"><a href="#cb28-2230" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,3,3]"</span>,idx_analyte), </span>
<span id="cb28-2231"><a href="#cb28-2231" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,1]"</span>,idx_analyte), </span>
<span id="cb28-2232"><a href="#cb28-2232" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,2]"</span>,idx_analyte), </span>
<span id="cb28-2233"><a href="#cb28-2233" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,3,3]"</span>,idx_analyte),</span>
<span id="cb28-2234"><a href="#cb28-2234" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2235"><a href="#cb28-2235" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,2]"</span>,idx_analyte), </span>
<span id="cb28-2236"><a href="#cb28-2236" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,4,3]"</span>,idx_analyte), </span>
<span id="cb28-2237"><a href="#cb28-2237" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,1]"</span>,idx_analyte), </span>
<span id="cb28-2238"><a href="#cb28-2238" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,2]"</span>,idx_analyte), </span>
<span id="cb28-2239"><a href="#cb28-2239" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,4,3]"</span>,idx_analyte),</span>
<span id="cb28-2240"><a href="#cb28-2240" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2241"><a href="#cb28-2241" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,2]"</span>,idx_analyte), </span>
<span id="cb28-2242"><a href="#cb28-2242" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,1,5,3]"</span>,idx_analyte), </span>
<span id="cb28-2243"><a href="#cb28-2243" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,1]"</span>,idx_analyte), </span>
<span id="cb28-2244"><a href="#cb28-2244" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,2]"</span>,idx_analyte), </span>
<span id="cb28-2245"><a href="#cb28-2245" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1x[%s,2,5,3]"</span>,idx_analyte),</span>
<span id="cb28-2246"><a href="#cb28-2246" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2x[1,1]"</span>, </span>
<span id="cb28-2247"><a href="#cb28-2247" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2x[2,1]"</span>))</span>
<span id="cb28-2248"><a href="#cb28-2248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2249"><a href="#cb28-2249" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-2250"><a href="#cb28-2250" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-2251"><a href="#cb28-2251" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwx[, c, r], S1x[, m, c, r], S2x[m, ]) <span class="sc">%&gt;%</span></span>
<span id="cb28-2252"><a href="#cb28-2252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">&lt;=</span>R[idx_analyte]<span class="sc">+</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span> </span>
<span id="cb28-2253"><a href="#cb28-2253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">foo =</span> (logkwx<span class="dv">-1</span>)<span class="sc">/</span>S1x<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>S2x)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2254"><a href="#cb28-2254" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fix =</span> foo<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>S2x<span class="sc">*</span>foo)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2255"><a href="#cb28-2255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fix, <span class="at">color =</span> <span class="fu">as.factor</span>(c), <span class="at">fill =</span> <span class="fu">as.factor</span>(c))) <span class="sc">+</span></span>
<span id="cb28-2256"><a href="#cb28-2256" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-2257"><a href="#cb28-2257" aria-hidden="true" tabindex="-1"></a>  <span class="co">#coord_cartesian(xlim=c(0,1))+</span></span>
<span id="cb28-2258"><a href="#cb28-2258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(m<span class="sc">~</span>r, <span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">m=</span>mod.labs,<span class="at">r=</span>diss.labs))<span class="sc">+</span></span>
<span id="cb28-2259"><a href="#cb28-2259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]),</span>
<span id="cb28-2260"><a href="#cb28-2260" aria-hidden="true" tabindex="-1"></a>       <span class="at">color=</span> <span class="st">" "</span>,</span>
<span id="cb28-2261"><a href="#cb28-2261" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill=</span> <span class="st">" "</span>,</span>
<span id="cb28-2262"><a href="#cb28-2262" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"\u03C6 leading to logk=1 (individual)"</span>)<span class="sc">+</span></span>
<span id="cb28-2263"><a href="#cb28-2263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)) <span class="sc">+</span></span>
<span id="cb28-2264"><a href="#cb28-2264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>))<span class="sc">+</span></span>
<span id="cb28-2265"><a href="#cb28-2265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(m<span class="sc">~</span>r, <span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">m=</span>mod.labs,<span class="at">r=</span>diss.labs))</span>
<span id="cb28-2266"><a href="#cb28-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2267"><a href="#cb28-2267" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-2268"><a href="#cb28-2268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2269"><a href="#cb28-2269" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">izoparam</span><span class="sc">\\</span><span class="st">filogk1</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".individual"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2270"><a href="#cb28-2270" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2271"><a href="#cb28-2271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2272"><a href="#cb28-2272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2273"><a href="#cb28-2273" aria-hidden="true" tabindex="-1"></a><span class="fu">## Individual Parameters</span></span>
<span id="cb28-2274"><a href="#cb28-2274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2275"><a href="#cb28-2275" aria-hidden="true" tabindex="-1"></a>Individual parameter are the analyte-specific parameters estimated by the model. The following plots allow to assess the correlations between these parameters.</span>
<span id="cb28-2276"><a href="#cb28-2276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2277"><a href="#cb28-2277" aria-hidden="true" tabindex="-1"></a><span class="fu">### Neutral Form</span></span>
<span id="cb28-2278"><a href="#cb28-2278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2279"><a href="#cb28-2279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r draws_df}</span></span>
<span id="cb28-2280"><a href="#cb28-2280" aria-hidden="true" tabindex="-1"></a><span class="co">#Extract sample for plots</span></span>
<span id="cb28-2281"><a href="#cb28-2281" aria-hidden="true" tabindex="-1"></a>draws_df <span class="ot">&lt;-</span> fit<span class="sc">$</span><span class="fu">draws</span>(<span class="at">format =</span> <span class="st">"df"</span>)</span>
<span id="cb28-2282"><a href="#cb28-2282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2283"><a href="#cb28-2283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2284"><a href="#cb28-2284" aria-hidden="true" tabindex="-1"></a>Individual parameters for the reference column (XBridge Shield RP18):</span>
<span id="cb28-2285"><a href="#cb28-2285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2286"><a href="#cb28-2286" aria-hidden="true" tabindex="-1"></a><span class="in">```{r iparam-column-neutral}</span></span>
<span id="cb28-2287"><a href="#cb28-2287" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^param"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2288"><a href="#cb28-2288" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">melt</span>(param)</span>
<span id="cb28-2289"><a href="#cb28-2289" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> param[<span class="dv">1</span><span class="sc">:</span>nAnalytes,]</span>
<span id="cb28-2290"><a href="#cb28-2290" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> param[(nAnalytes<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span><span class="sc">*</span>nAnalytes),]</span>
<span id="cb28-2291"><a href="#cb28-2291" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dS1N"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2292"><a href="#cb28-2292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2293"><a href="#cb28-2293" aria-hidden="true" tabindex="-1"></a>data_to_plot_param <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dataACD<span class="sc">$</span>logP[<span class="fu">which</span>(dataACD<span class="sc">$</span>METID <span class="sc">%in%</span> data<span class="sc">$</span>METID)],param1,param2,param3)</span>
<span id="cb28-2294"><a href="#cb28-2294" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot_param) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'logP'</span>[i]),<span class="fu">expression</span>(<span class="st">'logkwN'</span>[i]),<span class="fu">expression</span>(<span class="st">'S1mN'</span>[i]),<span class="fu">expression</span>(<span class="st">'dS1N'</span>[i]))</span>
<span id="cb28-2295"><a href="#cb28-2295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2296"><a href="#cb28-2296" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(<span class="fu">as.data.frame</span>(data_to_plot_param), <span class="at">columnLabels =</span> <span class="fu">colnames</span>(data_to_plot_param) ,</span>
<span id="cb28-2297"><a href="#cb28-2297" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,<span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))</span>
<span id="cb28-2298"><a href="#cb28-2298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2299"><a href="#cb28-2299" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"XBridgeShieldRP18.neutral"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2300"><a href="#cb28-2300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2301"><a href="#cb28-2301" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-2302"><a href="#cb28-2302" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2303"><a href="#cb28-2303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2304"><a href="#cb28-2304" aria-hidden="true" tabindex="-1"></a>Individual parameters for column effects:</span>
<span id="cb28-2305"><a href="#cb28-2305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2306"><a href="#cb28-2306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r iparam-columneffects-neutral}</span></span>
<span id="cb28-2307"><a href="#cb28-2307" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^clogkwN"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2308"><a href="#cb28-2308" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">melt</span>(param)</span>
<span id="cb28-2309"><a href="#cb28-2309" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">matrix</span>(param<span class="sc">$</span>value, <span class="at">nrow =</span> nAnalytes, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2310"><a href="#cb28-2310" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> param[,<span class="dv">1</span>]</span>
<span id="cb28-2311"><a href="#cb28-2311" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> param[,<span class="dv">2</span>]</span>
<span id="cb28-2312"><a href="#cb28-2312" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> param[,<span class="dv">3</span>]</span>
<span id="cb28-2313"><a href="#cb28-2313" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> param[,<span class="dv">4</span>]</span>
<span id="cb28-2314"><a href="#cb28-2314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2315"><a href="#cb28-2315" aria-hidden="true" tabindex="-1"></a>data_to_plot_param <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dataACD<span class="sc">$</span>logP[<span class="fu">which</span>(dataACD<span class="sc">$</span>METID <span class="sc">%in%</span> data<span class="sc">$</span>METID)],param1,param2,param3,param4)</span>
<span id="cb28-2316"><a href="#cb28-2316" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot_param) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'logP'</span>[i]),<span class="fu">expression</span>(<span class="st">'clogkwN1'</span>[i]),<span class="fu">expression</span>(<span class="st">'clogkwN2'</span>[i]),<span class="fu">expression</span>(<span class="st">'clogkwN3'</span>[i]),<span class="fu">expression</span>(<span class="st">'clogkwN4'</span>[i]))</span>
<span id="cb28-2317"><a href="#cb28-2317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2318"><a href="#cb28-2318" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(<span class="fu">as.data.frame</span>(data_to_plot_param), <span class="at">columnLabels =</span> <span class="fu">colnames</span>(data_to_plot_param) ,</span>
<span id="cb28-2319"><a href="#cb28-2319" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,<span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))</span>
<span id="cb28-2320"><a href="#cb28-2320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2321"><a href="#cb28-2321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2322"><a href="#cb28-2322" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^cS1mN"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2323"><a href="#cb28-2323" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">melt</span>(param)</span>
<span id="cb28-2324"><a href="#cb28-2324" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">matrix</span>(param<span class="sc">$</span>value,<span class="at">nrow =</span> nAnalytes, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2325"><a href="#cb28-2325" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> param[,<span class="dv">1</span>]</span>
<span id="cb28-2326"><a href="#cb28-2326" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> param[,<span class="dv">2</span>]</span>
<span id="cb28-2327"><a href="#cb28-2327" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> param[,<span class="dv">3</span>]</span>
<span id="cb28-2328"><a href="#cb28-2328" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> param[,<span class="dv">4</span>]</span>
<span id="cb28-2329"><a href="#cb28-2329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2330"><a href="#cb28-2330" aria-hidden="true" tabindex="-1"></a>data_to_plot_param <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dataACD<span class="sc">$</span>logP[<span class="fu">which</span>(dataACD<span class="sc">$</span>METID <span class="sc">%in%</span> data<span class="sc">$</span>METID)],param1,param2,param3,param4)</span>
<span id="cb28-2331"><a href="#cb28-2331" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot_param) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'logP'</span>[i]),<span class="fu">expression</span>(<span class="st">'cS1mN1'</span>[i]),<span class="fu">expression</span>(<span class="st">'cS1mN2'</span>[i]),<span class="fu">expression</span>(<span class="st">'cS1mN3'</span>[i]),<span class="fu">expression</span>(<span class="st">'cS1mN4'</span>[i]))</span>
<span id="cb28-2332"><a href="#cb28-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2333"><a href="#cb28-2333" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(<span class="fu">as.data.frame</span>(data_to_plot_param), <span class="at">columnLabels =</span> <span class="fu">colnames</span>(data_to_plot_param) ,</span>
<span id="cb28-2334"><a href="#cb28-2334" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,<span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))</span>
<span id="cb28-2335"><a href="#cb28-2335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2336"><a href="#cb28-2336" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^cdS1N"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2337"><a href="#cb28-2337" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">melt</span>(param)</span>
<span id="cb28-2338"><a href="#cb28-2338" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">matrix</span>(param<span class="sc">$</span>value,<span class="at">nrow =</span> nAnalytes, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2339"><a href="#cb28-2339" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> param[,<span class="dv">1</span>]</span>
<span id="cb28-2340"><a href="#cb28-2340" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> param[,<span class="dv">2</span>]</span>
<span id="cb28-2341"><a href="#cb28-2341" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> param[,<span class="dv">3</span>]</span>
<span id="cb28-2342"><a href="#cb28-2342" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> param[,<span class="dv">4</span>]</span>
<span id="cb28-2343"><a href="#cb28-2343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2344"><a href="#cb28-2344" aria-hidden="true" tabindex="-1"></a>data_to_plot_param <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dataACD<span class="sc">$</span>logP[<span class="fu">which</span>(dataACD<span class="sc">$</span>METID <span class="sc">%in%</span> data<span class="sc">$</span>METID)],param1,param2,param3,param4)</span>
<span id="cb28-2345"><a href="#cb28-2345" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot_param) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'logP'</span>[i]),<span class="fu">expression</span>(<span class="st">'cdS1N1'</span>[i]),<span class="fu">expression</span>(<span class="st">'cdS1N2'</span>[i]),<span class="fu">expression</span>(<span class="st">'cdS1N3'</span>[i]),<span class="fu">expression</span>(<span class="st">'cdS1N4'</span>[i]))</span>
<span id="cb28-2346"><a href="#cb28-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2347"><a href="#cb28-2347" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(<span class="fu">as.data.frame</span>(data_to_plot_param), <span class="at">columnLabels =</span> <span class="fu">colnames</span>(data_to_plot_param) ,</span>
<span id="cb28-2348"><a href="#cb28-2348" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,<span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))</span>
<span id="cb28-2349"><a href="#cb28-2349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2350"><a href="#cb28-2350" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"columneffects.neutral.clogkwN"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2351"><a href="#cb28-2351" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"columneffects.neutral.cS1mN"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p2, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2352"><a href="#cb28-2352" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"columneffects.neutral.cdS1N"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p3, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2353"><a href="#cb28-2353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2354"><a href="#cb28-2354" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-2355"><a href="#cb28-2355" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb28-2356"><a href="#cb28-2356" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span>
<span id="cb28-2357"><a href="#cb28-2357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2358"><a href="#cb28-2358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2359"><a href="#cb28-2359" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effects of dissociation</span></span>
<span id="cb28-2360"><a href="#cb28-2360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2361"><a href="#cb28-2361" aria-hidden="true" tabindex="-1"></a>Individual parameters for the reference column (XBridge Shield RP18)</span>
<span id="cb28-2362"><a href="#cb28-2362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2363"><a href="#cb28-2363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r iparam-column-dissociated}</span></span>
<span id="cb28-2364"><a href="#cb28-2364" aria-hidden="true" tabindex="-1"></a>dlogkwA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dlogkwA"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2365"><a href="#cb28-2365" aria-hidden="true" tabindex="-1"></a>dlogkwA <span class="ot">&lt;-</span> <span class="fu">melt</span>(dlogkwA)[,<span class="dv">1</span>]</span>
<span id="cb28-2366"><a href="#cb28-2366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2367"><a href="#cb28-2367" aria-hidden="true" tabindex="-1"></a>dlogkwB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dlogkwB"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2368"><a href="#cb28-2368" aria-hidden="true" tabindex="-1"></a>dlogkwB <span class="ot">&lt;-</span> <span class="fu">melt</span>(dlogkwB)[,<span class="dv">1</span>]</span>
<span id="cb28-2369"><a href="#cb28-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2370"><a href="#cb28-2370" aria-hidden="true" tabindex="-1"></a>dlogkw <span class="ot">&lt;-</span> <span class="fu">c</span>(dlogkwA,dlogkwB)</span>
<span id="cb28-2371"><a href="#cb28-2371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2372"><a href="#cb28-2372" aria-hidden="true" tabindex="-1"></a>dS1mA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dS1mA"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2373"><a href="#cb28-2373" aria-hidden="true" tabindex="-1"></a>dS1mA <span class="ot">&lt;-</span> <span class="fu">melt</span>(dS1mA)[,<span class="dv">1</span>]</span>
<span id="cb28-2374"><a href="#cb28-2374" aria-hidden="true" tabindex="-1"></a>dS1mB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dS1mB"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2375"><a href="#cb28-2375" aria-hidden="true" tabindex="-1"></a>dS1mB <span class="ot">&lt;-</span> <span class="fu">melt</span>(dS1mB)[,<span class="dv">1</span>]</span>
<span id="cb28-2376"><a href="#cb28-2376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2377"><a href="#cb28-2377" aria-hidden="true" tabindex="-1"></a>dS1m <span class="ot">&lt;-</span> <span class="fu">c</span>(dS1mA,dS1mB)</span>
<span id="cb28-2378"><a href="#cb28-2378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2379"><a href="#cb28-2379" aria-hidden="true" tabindex="-1"></a>dS1A <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dS1A"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2380"><a href="#cb28-2380" aria-hidden="true" tabindex="-1"></a>dS1A <span class="ot">&lt;-</span> <span class="fu">melt</span>(dS1A)[,<span class="dv">1</span>]</span>
<span id="cb28-2381"><a href="#cb28-2381" aria-hidden="true" tabindex="-1"></a>dS1B <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dS1B"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2382"><a href="#cb28-2382" aria-hidden="true" tabindex="-1"></a>dS1B <span class="ot">&lt;-</span> <span class="fu">melt</span>(dS1B)[,<span class="dv">1</span>]</span>
<span id="cb28-2383"><a href="#cb28-2383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2384"><a href="#cb28-2384" aria-hidden="true" tabindex="-1"></a>dS1 <span class="ot">&lt;-</span> <span class="fu">c</span>(dS1A,dS1B)</span>
<span id="cb28-2385"><a href="#cb28-2385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2386"><a href="#cb28-2386" aria-hidden="true" tabindex="-1"></a>GroupType <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Acids"</span>, <span class="fu">length</span>(dlogkwA)),<span class="fu">rep</span>(<span class="st">"Bases"</span>, <span class="fu">length</span>(dlogkwB)))</span>
<span id="cb28-2387"><a href="#cb28-2387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2388"><a href="#cb28-2388" aria-hidden="true" tabindex="-1"></a>data_to_plot_diss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dlogkw, dS1m,dS1,GroupType)</span>
<span id="cb28-2389"><a href="#cb28-2389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2390"><a href="#cb28-2390" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(data_to_plot_diss,<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">columnLabels =</span> <span class="fu">c</span>(<span class="st">"dlogkw"</span>,<span class="st">"dS1m"</span>,<span class="st">"ddS1"</span>),</span>
<span id="cb28-2391"><a href="#cb28-2391" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,</span>
<span id="cb28-2392"><a href="#cb28-2392" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span><span class="dv">1</span>,</span>
<span id="cb28-2393"><a href="#cb28-2393" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> GroupType, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-2394"><a href="#cb28-2394" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))<span class="sc">+</span></span>
<span id="cb28-2395"><a href="#cb28-2395" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb28-2396"><a href="#cb28-2396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2397"><a href="#cb28-2397" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-2398"><a href="#cb28-2398" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"XBridgeShieldRP18.dissociated"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2399"><a href="#cb28-2399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2400"><a href="#cb28-2400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2401"><a href="#cb28-2401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2402"><a href="#cb28-2402" aria-hidden="true" tabindex="-1"></a>Individual parameters for the particular column (1-4) relative to XBridge Shield RP18</span>
<span id="cb28-2403"><a href="#cb28-2403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2404"><a href="#cb28-2404" aria-hidden="true" tabindex="-1"></a><span class="in">```{r iparam-columneffects-dissociated}</span></span>
<span id="cb28-2405"><a href="#cb28-2405" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^cdlogkwA"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2406"><a href="#cb28-2406" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramA)</span>
<span id="cb28-2407"><a href="#cb28-2407" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramA<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsA, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2408"><a href="#cb28-2408" aria-hidden="true" tabindex="-1"></a>paramA1 <span class="ot">&lt;-</span> paramA[,<span class="dv">1</span>]</span>
<span id="cb28-2409"><a href="#cb28-2409" aria-hidden="true" tabindex="-1"></a>paramA2 <span class="ot">&lt;-</span> paramA[,<span class="dv">2</span>]</span>
<span id="cb28-2410"><a href="#cb28-2410" aria-hidden="true" tabindex="-1"></a>paramA3 <span class="ot">&lt;-</span> paramA[,<span class="dv">3</span>]</span>
<span id="cb28-2411"><a href="#cb28-2411" aria-hidden="true" tabindex="-1"></a>paramA4 <span class="ot">&lt;-</span> paramA[,<span class="dv">4</span>]</span>
<span id="cb28-2412"><a href="#cb28-2412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2413"><a href="#cb28-2413" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^cdlogkwB"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2414"><a href="#cb28-2414" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramB)</span>
<span id="cb28-2415"><a href="#cb28-2415" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramB<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsB, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2416"><a href="#cb28-2416" aria-hidden="true" tabindex="-1"></a>paramB1 <span class="ot">&lt;-</span> paramB[,<span class="dv">1</span>]</span>
<span id="cb28-2417"><a href="#cb28-2417" aria-hidden="true" tabindex="-1"></a>paramB2 <span class="ot">&lt;-</span> paramB[,<span class="dv">2</span>]</span>
<span id="cb28-2418"><a href="#cb28-2418" aria-hidden="true" tabindex="-1"></a>paramB3 <span class="ot">&lt;-</span> paramB[,<span class="dv">3</span>]</span>
<span id="cb28-2419"><a href="#cb28-2419" aria-hidden="true" tabindex="-1"></a>paramB4 <span class="ot">&lt;-</span> paramB[,<span class="dv">4</span>]</span>
<span id="cb28-2420"><a href="#cb28-2420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2421"><a href="#cb28-2421" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA1,paramB1)</span>
<span id="cb28-2422"><a href="#cb28-2422" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA2,paramB2)</span>
<span id="cb28-2423"><a href="#cb28-2423" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA3,paramB3)</span>
<span id="cb28-2424"><a href="#cb28-2424" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA4,paramB4)</span>
<span id="cb28-2425"><a href="#cb28-2425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2426"><a href="#cb28-2426" aria-hidden="true" tabindex="-1"></a>GroupType <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Acids"</span>, <span class="fu">length</span>(paramA1)),<span class="fu">rep</span>(<span class="st">"Bases"</span>, <span class="fu">length</span>(paramB1)))</span>
<span id="cb28-2427"><a href="#cb28-2427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2428"><a href="#cb28-2428" aria-hidden="true" tabindex="-1"></a>data_to_plot_diss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(param1,param2,param3,param4,GroupType)</span>
<span id="cb28-2429"><a href="#cb28-2429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2430"><a href="#cb28-2430" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(data_to_plot_diss,<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">columnLabels =</span> <span class="fu">c</span>(<span class="st">"cdlogkw1"</span>,<span class="st">"cdlogkw2"</span>,<span class="st">"cdlogkw3"</span>,<span class="st">"cdlogkw4"</span>),</span>
<span id="cb28-2431"><a href="#cb28-2431" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,</span>
<span id="cb28-2432"><a href="#cb28-2432" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span><span class="dv">1</span>,</span>
<span id="cb28-2433"><a href="#cb28-2433" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> GroupType, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-2434"><a href="#cb28-2434" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))<span class="sc">+</span></span>
<span id="cb28-2435"><a href="#cb28-2435" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb28-2436"><a href="#cb28-2436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2437"><a href="#cb28-2437" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^cdS1mA"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2438"><a href="#cb28-2438" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramA)</span>
<span id="cb28-2439"><a href="#cb28-2439" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramA<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsA, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2440"><a href="#cb28-2440" aria-hidden="true" tabindex="-1"></a>paramA1 <span class="ot">&lt;-</span> paramA[,<span class="dv">1</span>]</span>
<span id="cb28-2441"><a href="#cb28-2441" aria-hidden="true" tabindex="-1"></a>paramA2 <span class="ot">&lt;-</span> paramA[,<span class="dv">2</span>]</span>
<span id="cb28-2442"><a href="#cb28-2442" aria-hidden="true" tabindex="-1"></a>paramA3 <span class="ot">&lt;-</span> paramA[,<span class="dv">3</span>]</span>
<span id="cb28-2443"><a href="#cb28-2443" aria-hidden="true" tabindex="-1"></a>paramA4 <span class="ot">&lt;-</span> paramA[,<span class="dv">4</span>]</span>
<span id="cb28-2444"><a href="#cb28-2444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2445"><a href="#cb28-2445" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^cdS1mB"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2446"><a href="#cb28-2446" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramB)</span>
<span id="cb28-2447"><a href="#cb28-2447" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramB<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsB, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2448"><a href="#cb28-2448" aria-hidden="true" tabindex="-1"></a>paramB1 <span class="ot">&lt;-</span> paramB[,<span class="dv">1</span>]</span>
<span id="cb28-2449"><a href="#cb28-2449" aria-hidden="true" tabindex="-1"></a>paramB2 <span class="ot">&lt;-</span> paramB[,<span class="dv">2</span>]</span>
<span id="cb28-2450"><a href="#cb28-2450" aria-hidden="true" tabindex="-1"></a>paramB3 <span class="ot">&lt;-</span> paramB[,<span class="dv">3</span>]</span>
<span id="cb28-2451"><a href="#cb28-2451" aria-hidden="true" tabindex="-1"></a>paramB4 <span class="ot">&lt;-</span> paramB[,<span class="dv">4</span>]</span>
<span id="cb28-2452"><a href="#cb28-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2453"><a href="#cb28-2453" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA1,paramB1)</span>
<span id="cb28-2454"><a href="#cb28-2454" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA2,paramB2)</span>
<span id="cb28-2455"><a href="#cb28-2455" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA3,paramB3)</span>
<span id="cb28-2456"><a href="#cb28-2456" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA4,paramB4)</span>
<span id="cb28-2457"><a href="#cb28-2457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2458"><a href="#cb28-2458" aria-hidden="true" tabindex="-1"></a>GroupType <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Acids"</span>, <span class="fu">length</span>(paramA1)),<span class="fu">rep</span>(<span class="st">"Bases"</span>, <span class="fu">length</span>(paramB1)))</span>
<span id="cb28-2459"><a href="#cb28-2459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2460"><a href="#cb28-2460" aria-hidden="true" tabindex="-1"></a>data_to_plot_diss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(param1,param2,param3,param4,GroupType)</span>
<span id="cb28-2461"><a href="#cb28-2461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2462"><a href="#cb28-2462" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(data_to_plot_diss,<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">columnLabels =</span> <span class="fu">c</span>(<span class="st">"cdS1m1"</span>,<span class="st">"cdS1m2"</span>,<span class="st">"cdS1m3"</span>,<span class="st">"cdS1m4"</span>),</span>
<span id="cb28-2463"><a href="#cb28-2463" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,</span>
<span id="cb28-2464"><a href="#cb28-2464" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span><span class="dv">1</span>,</span>
<span id="cb28-2465"><a href="#cb28-2465" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> GroupType, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-2466"><a href="#cb28-2466" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))<span class="sc">+</span></span>
<span id="cb28-2467"><a href="#cb28-2467" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb28-2468"><a href="#cb28-2468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2469"><a href="#cb28-2469" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^cdS1A"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2470"><a href="#cb28-2470" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramA)</span>
<span id="cb28-2471"><a href="#cb28-2471" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramA<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsA, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2472"><a href="#cb28-2472" aria-hidden="true" tabindex="-1"></a>paramA1 <span class="ot">&lt;-</span> paramA[,<span class="dv">1</span>]</span>
<span id="cb28-2473"><a href="#cb28-2473" aria-hidden="true" tabindex="-1"></a>paramA2 <span class="ot">&lt;-</span> paramA[,<span class="dv">2</span>]</span>
<span id="cb28-2474"><a href="#cb28-2474" aria-hidden="true" tabindex="-1"></a>paramA3 <span class="ot">&lt;-</span> paramA[,<span class="dv">3</span>]</span>
<span id="cb28-2475"><a href="#cb28-2475" aria-hidden="true" tabindex="-1"></a>paramA4 <span class="ot">&lt;-</span> paramA[,<span class="dv">4</span>]</span>
<span id="cb28-2476"><a href="#cb28-2476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2477"><a href="#cb28-2477" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^cdS1B"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2478"><a href="#cb28-2478" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramB)</span>
<span id="cb28-2479"><a href="#cb28-2479" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramB<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsB, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2480"><a href="#cb28-2480" aria-hidden="true" tabindex="-1"></a>paramB1 <span class="ot">&lt;-</span> paramB[,<span class="dv">1</span>]</span>
<span id="cb28-2481"><a href="#cb28-2481" aria-hidden="true" tabindex="-1"></a>paramB2 <span class="ot">&lt;-</span> paramB[,<span class="dv">2</span>]</span>
<span id="cb28-2482"><a href="#cb28-2482" aria-hidden="true" tabindex="-1"></a>paramB3 <span class="ot">&lt;-</span> paramB[,<span class="dv">3</span>]</span>
<span id="cb28-2483"><a href="#cb28-2483" aria-hidden="true" tabindex="-1"></a>paramB4 <span class="ot">&lt;-</span> paramB[,<span class="dv">4</span>]</span>
<span id="cb28-2484"><a href="#cb28-2484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2485"><a href="#cb28-2485" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA1,paramB1)</span>
<span id="cb28-2486"><a href="#cb28-2486" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA2,paramB2)</span>
<span id="cb28-2487"><a href="#cb28-2487" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA3,paramB3)</span>
<span id="cb28-2488"><a href="#cb28-2488" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA4,paramB4)</span>
<span id="cb28-2489"><a href="#cb28-2489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2490"><a href="#cb28-2490" aria-hidden="true" tabindex="-1"></a>GroupType <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Acids"</span>, <span class="fu">length</span>(paramA1)),<span class="fu">rep</span>(<span class="st">"Bases"</span>, <span class="fu">length</span>(paramB1)))</span>
<span id="cb28-2491"><a href="#cb28-2491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2492"><a href="#cb28-2492" aria-hidden="true" tabindex="-1"></a>data_to_plot_diss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(param1,param2,param3,param4,GroupType)</span>
<span id="cb28-2493"><a href="#cb28-2493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2494"><a href="#cb28-2494" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(data_to_plot_diss,<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">columnLabels =</span> <span class="fu">c</span>(<span class="st">"cdS11"</span>,<span class="st">"cdS12"</span>,<span class="st">"cdS13"</span>,<span class="st">"cdS14"</span>),</span>
<span id="cb28-2495"><a href="#cb28-2495" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,</span>
<span id="cb28-2496"><a href="#cb28-2496" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span><span class="dv">1</span>,</span>
<span id="cb28-2497"><a href="#cb28-2497" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> GroupType, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-2498"><a href="#cb28-2498" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))<span class="sc">+</span></span>
<span id="cb28-2499"><a href="#cb28-2499" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb28-2500"><a href="#cb28-2500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2501"><a href="#cb28-2501" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-2502"><a href="#cb28-2502" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb28-2503"><a href="#cb28-2503" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span>
<span id="cb28-2504"><a href="#cb28-2504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2505"><a href="#cb28-2505" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"coleffects.diss.cdlogkw"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2506"><a href="#cb28-2506" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"coleffects.diss.cdS1m"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p2, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2507"><a href="#cb28-2507" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"coleffects.diss.cdS1"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p3, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2508"><a href="#cb28-2508" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2509"><a href="#cb28-2509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2510"><a href="#cb28-2510" aria-hidden="true" tabindex="-1"></a><span class="fu">### pKa-related paraemters</span></span>
<span id="cb28-2511"><a href="#cb28-2511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2512"><a href="#cb28-2512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r iparam-pKas}</span></span>
<span id="cb28-2513"><a href="#cb28-2513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2514"><a href="#cb28-2514" aria-hidden="true" tabindex="-1"></a>pKawA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^pKawA"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2515"><a href="#cb28-2515" aria-hidden="true" tabindex="-1"></a>pKawA <span class="ot">&lt;-</span> <span class="fu">melt</span>(pKawA)[,<span class="dv">1</span>]</span>
<span id="cb28-2516"><a href="#cb28-2516" aria-hidden="true" tabindex="-1"></a>pKawB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^pKawB"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2517"><a href="#cb28-2517" aria-hidden="true" tabindex="-1"></a>pKawB <span class="ot">&lt;-</span> <span class="fu">melt</span>(pKawB)[,<span class="dv">1</span>]</span>
<span id="cb28-2518"><a href="#cb28-2518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2519"><a href="#cb28-2519" aria-hidden="true" tabindex="-1"></a>alphamA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^alphamA"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2520"><a href="#cb28-2520" aria-hidden="true" tabindex="-1"></a>alphamA <span class="ot">&lt;-</span> <span class="fu">melt</span>(alphamA)[,<span class="dv">1</span>]</span>
<span id="cb28-2521"><a href="#cb28-2521" aria-hidden="true" tabindex="-1"></a>alphamB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^alphamB"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2522"><a href="#cb28-2522" aria-hidden="true" tabindex="-1"></a>alphamB <span class="ot">&lt;-</span> <span class="fu">melt</span>(alphamB)[,<span class="dv">1</span>]</span>
<span id="cb28-2523"><a href="#cb28-2523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2524"><a href="#cb28-2524" aria-hidden="true" tabindex="-1"></a>dalphaA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dalphaA"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2525"><a href="#cb28-2525" aria-hidden="true" tabindex="-1"></a>dalphaA <span class="ot">&lt;-</span> <span class="fu">melt</span>(dalphaA)[,<span class="dv">1</span>]</span>
<span id="cb28-2526"><a href="#cb28-2526" aria-hidden="true" tabindex="-1"></a>dalphaB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^dalphaB"</span>, <span class="fu">names</span>(draws_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2527"><a href="#cb28-2527" aria-hidden="true" tabindex="-1"></a>dalphaB <span class="ot">&lt;-</span> <span class="fu">melt</span>(dalphaB)[,<span class="dv">1</span>]</span>
<span id="cb28-2528"><a href="#cb28-2528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2529"><a href="#cb28-2529" aria-hidden="true" tabindex="-1"></a>pKapred <span class="ot">&lt;-</span> <span class="fu">c</span>(pKawA, pKawB)</span>
<span id="cb28-2530"><a href="#cb28-2530" aria-hidden="true" tabindex="-1"></a>pKaslit <span class="ot">&lt;-</span> <span class="fu">c</span>(pKaslitA, pKaslitB)</span>
<span id="cb28-2531"><a href="#cb28-2531" aria-hidden="true" tabindex="-1"></a>alpham <span class="ot">&lt;-</span> <span class="fu">c</span>(alphamA, alphamB)</span>
<span id="cb28-2532"><a href="#cb28-2532" aria-hidden="true" tabindex="-1"></a>dalpha <span class="ot">&lt;-</span> <span class="fu">c</span>(dalphaA, dalphaB)</span>
<span id="cb28-2533"><a href="#cb28-2533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2534"><a href="#cb28-2534" aria-hidden="true" tabindex="-1"></a>GroupType <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Acids"</span>, <span class="fu">length</span>(alphamA)),<span class="fu">rep</span>(<span class="st">"Bases"</span>, <span class="fu">length</span>(alphamB)))</span>
<span id="cb28-2535"><a href="#cb28-2535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2536"><a href="#cb28-2536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2537"><a href="#cb28-2537" aria-hidden="true" tabindex="-1"></a>data_to_plot_param <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(pKapred, pKaslit, alpham, dalpha, GroupType)</span>
<span id="cb28-2538"><a href="#cb28-2538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2539"><a href="#cb28-2539" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(data_to_plot_param,<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">columnLabels =</span> <span class="fu">c</span>(<span class="st">"pKalit"</span>, <span class="st">"pKapred"</span>, <span class="st">"alpham"</span>, <span class="st">"dalpha"</span>),</span>
<span id="cb28-2540"><a href="#cb28-2540" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,</span>
<span id="cb28-2541"><a href="#cb28-2541" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span><span class="dv">1</span>,</span>
<span id="cb28-2542"><a href="#cb28-2542" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> GroupType, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-2543"><a href="#cb28-2543" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))<span class="sc">+</span></span>
<span id="cb28-2544"><a href="#cb28-2544" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb28-2545"><a href="#cb28-2545" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-2546"><a href="#cb28-2546" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">iparam</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"pKas"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2547"><a href="#cb28-2547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2548"><a href="#cb28-2548" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2549"><a href="#cb28-2549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2550"><a href="#cb28-2550" aria-hidden="true" tabindex="-1"></a><span class="fu">## Eta plots</span></span>
<span id="cb28-2551"><a href="#cb28-2551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2552"><a href="#cb28-2552" aria-hidden="true" tabindex="-1"></a>Eta plots shows the centered and standardized individual parameters (e.g. $\eta_{logkwN,i} = (logkwN_i-(\hat{logkwN} + \beta_1 \cdot \log P_i))/\omega_1$). They allow to visualize the unexplained between-analyte variability of chromatographic parameters.</span>
<span id="cb28-2553"><a href="#cb28-2553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2554"><a href="#cb28-2554" aria-hidden="true" tabindex="-1"></a><span class="in">```{r etaqq, eval = FALSE}</span></span>
<span id="cb28-2555"><a href="#cb28-2555" aria-hidden="true" tabindex="-1"></a>model_etas <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-etas.stan"</span>)</span>
<span id="cb28-2556"><a href="#cb28-2556" aria-hidden="true" tabindex="-1"></a>fit_etas  <span class="ot">&lt;-</span> model_etas<span class="sc">$</span><span class="fu">generate_quantities</span>(fit,</span>
<span id="cb28-2557"><a href="#cb28-2557" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data =</span> datastruct,</span>
<span id="cb28-2558"><a href="#cb28-2558" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb28-2559"><a href="#cb28-2559" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-2560"><a href="#cb28-2560" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>)</span>
<span id="cb28-2561"><a href="#cb28-2561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2562"><a href="#cb28-2562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2563"><a href="#cb28-2563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r etaload}</span></span>
<span id="cb28-2564"><a href="#cb28-2564" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">read_cmdstan_csv</span>(<span class="fu">c</span>(</span>
<span id="cb28-2565"><a href="#cb28-2565" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-etas-202308231335-1-45bb77.csv'</span>,</span>
<span id="cb28-2566"><a href="#cb28-2566" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-etas-202308231335-2-45bb77.csv'</span>,</span>
<span id="cb28-2567"><a href="#cb28-2567" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-etas-202308231335-3-45bb77.csv'</span>,</span>
<span id="cb28-2568"><a href="#cb28-2568" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-etas-202308231335-4-45bb77.csv'</span></span>
<span id="cb28-2569"><a href="#cb28-2569" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-2570"><a href="#cb28-2570" aria-hidden="true" tabindex="-1"></a>draws_etas_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span>generated_quantities)</span>
<span id="cb28-2571"><a href="#cb28-2571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2572"><a href="#cb28-2572" aria-hidden="true" tabindex="-1"></a><span class="co"># draws_etas_df &lt;- fit_etas$draws(format = "df")</span></span>
<span id="cb28-2573"><a href="#cb28-2573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2574"><a href="#cb28-2574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2575"><a href="#cb28-2575" aria-hidden="true" tabindex="-1"></a><span class="fu">### Neutral Forms</span></span>
<span id="cb28-2576"><a href="#cb28-2576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2577"><a href="#cb28-2577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r etaplots-neutral}</span></span>
<span id="cb28-2578"><a href="#cb28-2578" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etalogkwN"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2579"><a href="#cb28-2579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2580"><a href="#cb28-2580" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etaclogkwNc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2581"><a href="#cb28-2581" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">melt</span>(cparam)</span>
<span id="cb28-2582"><a href="#cb28-2582" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">matrix</span>(cparam<span class="sc">$</span>value,<span class="at">nrow =</span> nAnalytes, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2583"><a href="#cb28-2583" aria-hidden="true" tabindex="-1"></a>cparam1 <span class="ot">&lt;-</span> cparam[,<span class="dv">1</span>]</span>
<span id="cb28-2584"><a href="#cb28-2584" aria-hidden="true" tabindex="-1"></a>cparam2 <span class="ot">&lt;-</span> cparam[,<span class="dv">2</span>]</span>
<span id="cb28-2585"><a href="#cb28-2585" aria-hidden="true" tabindex="-1"></a>cparam3 <span class="ot">&lt;-</span> cparam[,<span class="dv">3</span>]</span>
<span id="cb28-2586"><a href="#cb28-2586" aria-hidden="true" tabindex="-1"></a>cparam4 <span class="ot">&lt;-</span> cparam[,<span class="dv">4</span>]</span>
<span id="cb28-2587"><a href="#cb28-2587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2588"><a href="#cb28-2588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2589"><a href="#cb28-2589" aria-hidden="true" tabindex="-1"></a>data_to_plot_param <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dataACD<span class="sc">$</span>logP[<span class="fu">which</span>(dataACD<span class="sc">$</span>METID <span class="sc">%in%</span> data<span class="sc">$</span>METID)],param1,cparam1,cparam2,cparam3,cparam4)</span>
<span id="cb28-2590"><a href="#cb28-2590" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot_param) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'logP'</span>[i]),<span class="fu">expression</span>(<span class="st">'etalogkwN'</span>),<span class="fu">expression</span>(<span class="st">'etaclogkwN_1'</span>),<span class="fu">expression</span>(<span class="st">'etaclogkwN_2'</span>), <span class="fu">expression</span>(<span class="st">'etaclogkwN_3'</span>),<span class="fu">expression</span>(<span class="st">'etaclogkwN_4'</span>))</span>
<span id="cb28-2591"><a href="#cb28-2591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2592"><a href="#cb28-2592" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(<span class="fu">as.data.frame</span>(data_to_plot_param), <span class="at">columnLabels =</span> <span class="fu">colnames</span>(data_to_plot_param) ,</span>
<span id="cb28-2593"><a href="#cb28-2593" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,<span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))</span>
<span id="cb28-2594"><a href="#cb28-2594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2595"><a href="#cb28-2595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2596"><a href="#cb28-2596" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etaS1mN"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2597"><a href="#cb28-2597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2598"><a href="#cb28-2598" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etacS1mNc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2599"><a href="#cb28-2599" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">melt</span>(cparam)</span>
<span id="cb28-2600"><a href="#cb28-2600" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">matrix</span>(cparam<span class="sc">$</span>value,<span class="at">nrow =</span> nAnalytes, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2601"><a href="#cb28-2601" aria-hidden="true" tabindex="-1"></a>cparam1 <span class="ot">&lt;-</span> cparam[,<span class="dv">1</span>]</span>
<span id="cb28-2602"><a href="#cb28-2602" aria-hidden="true" tabindex="-1"></a>cparam2 <span class="ot">&lt;-</span> cparam[,<span class="dv">2</span>]</span>
<span id="cb28-2603"><a href="#cb28-2603" aria-hidden="true" tabindex="-1"></a>cparam3 <span class="ot">&lt;-</span> cparam[,<span class="dv">3</span>]</span>
<span id="cb28-2604"><a href="#cb28-2604" aria-hidden="true" tabindex="-1"></a>cparam4 <span class="ot">&lt;-</span> cparam[,<span class="dv">4</span>]</span>
<span id="cb28-2605"><a href="#cb28-2605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2606"><a href="#cb28-2606" aria-hidden="true" tabindex="-1"></a>data_to_plot_param <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dataACD<span class="sc">$</span>logP[<span class="fu">which</span>(dataACD<span class="sc">$</span>METID <span class="sc">%in%</span> data<span class="sc">$</span>METID)],param1,cparam1,cparam2,cparam3,cparam4)</span>
<span id="cb28-2607"><a href="#cb28-2607" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot_param) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'logP'</span>[i]),<span class="fu">expression</span>(<span class="st">'etaS1mN'</span>),<span class="fu">expression</span>(<span class="st">'etacS1mN_1'</span>),<span class="fu">expression</span>(<span class="st">'etacS1mN_2'</span>), <span class="fu">expression</span>(<span class="st">'etacS1mN_3'</span>),<span class="fu">expression</span>(<span class="st">'etacS1mN_4'</span>))</span>
<span id="cb28-2608"><a href="#cb28-2608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2609"><a href="#cb28-2609" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(<span class="fu">as.data.frame</span>(data_to_plot_param), <span class="at">columnLabels =</span> <span class="fu">colnames</span>(data_to_plot_param) ,</span>
<span id="cb28-2610"><a href="#cb28-2610" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,<span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))</span>
<span id="cb28-2611"><a href="#cb28-2611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2612"><a href="#cb28-2612" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etadS1N"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2613"><a href="#cb28-2613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2614"><a href="#cb28-2614" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etacdS1Nc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2615"><a href="#cb28-2615" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">melt</span>(cparam)</span>
<span id="cb28-2616"><a href="#cb28-2616" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">matrix</span>(cparam<span class="sc">$</span>value,<span class="at">nrow =</span> nAnalytes, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2617"><a href="#cb28-2617" aria-hidden="true" tabindex="-1"></a>cparam1 <span class="ot">&lt;-</span> cparam[,<span class="dv">1</span>]</span>
<span id="cb28-2618"><a href="#cb28-2618" aria-hidden="true" tabindex="-1"></a>cparam2 <span class="ot">&lt;-</span> cparam[,<span class="dv">2</span>]</span>
<span id="cb28-2619"><a href="#cb28-2619" aria-hidden="true" tabindex="-1"></a>cparam3 <span class="ot">&lt;-</span> cparam[,<span class="dv">3</span>]</span>
<span id="cb28-2620"><a href="#cb28-2620" aria-hidden="true" tabindex="-1"></a>cparam4 <span class="ot">&lt;-</span> cparam[,<span class="dv">4</span>]</span>
<span id="cb28-2621"><a href="#cb28-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2622"><a href="#cb28-2622" aria-hidden="true" tabindex="-1"></a>data_to_plot_param <span class="ot">&lt;-</span> <span class="fu">cbind</span>(dataACD<span class="sc">$</span>logP[<span class="fu">which</span>(dataACD<span class="sc">$</span>METID <span class="sc">%in%</span> data<span class="sc">$</span>METID)],param1,cparam1,cparam2,cparam3,cparam4)</span>
<span id="cb28-2623"><a href="#cb28-2623" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot_param) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="st">'logP'</span>[i]),<span class="fu">expression</span>(<span class="st">'etadS1N'</span>),<span class="fu">expression</span>(<span class="st">'etacdS1N_1'</span>),<span class="fu">expression</span>(<span class="st">'etacdS1N_2'</span>), <span class="fu">expression</span>(<span class="st">'etacdS1N_3'</span>),<span class="fu">expression</span>(<span class="st">'etacdS1N_4'</span>))</span>
<span id="cb28-2624"><a href="#cb28-2624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2625"><a href="#cb28-2625" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(<span class="fu">as.data.frame</span>(data_to_plot_param), <span class="at">columnLabels =</span> <span class="fu">colnames</span>(data_to_plot_param) ,</span>
<span id="cb28-2626"><a href="#cb28-2626" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,<span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))</span>
<span id="cb28-2627"><a href="#cb28-2627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2628"><a href="#cb28-2628" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">etaplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"neutral.logkwN"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2629"><a href="#cb28-2629" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">etaplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"neutral.S1mN"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p2, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2630"><a href="#cb28-2630" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">etaplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"neutral.dS1N"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p3, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2631"><a href="#cb28-2631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2632"><a href="#cb28-2632" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-2633"><a href="#cb28-2633" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb28-2634"><a href="#cb28-2634" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span>
<span id="cb28-2635"><a href="#cb28-2635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2636"><a href="#cb28-2636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2637"><a href="#cb28-2637" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effect of dissociation</span></span>
<span id="cb28-2638"><a href="#cb28-2638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2639"><a href="#cb28-2639" aria-hidden="true" tabindex="-1"></a><span class="in">```{r etaplots-dissociated}</span></span>
<span id="cb28-2640"><a href="#cb28-2640" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etacdlogkwAc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2641"><a href="#cb28-2641" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramA)</span>
<span id="cb28-2642"><a href="#cb28-2642" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramA<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsA, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2643"><a href="#cb28-2643" aria-hidden="true" tabindex="-1"></a>paramA1 <span class="ot">&lt;-</span> paramA[,<span class="dv">1</span>]</span>
<span id="cb28-2644"><a href="#cb28-2644" aria-hidden="true" tabindex="-1"></a>paramA2 <span class="ot">&lt;-</span> paramA[,<span class="dv">2</span>]</span>
<span id="cb28-2645"><a href="#cb28-2645" aria-hidden="true" tabindex="-1"></a>paramA3 <span class="ot">&lt;-</span> paramA[,<span class="dv">3</span>]</span>
<span id="cb28-2646"><a href="#cb28-2646" aria-hidden="true" tabindex="-1"></a>paramA4 <span class="ot">&lt;-</span> paramA[,<span class="dv">4</span>]</span>
<span id="cb28-2647"><a href="#cb28-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2648"><a href="#cb28-2648" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etacdlogkwBc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2649"><a href="#cb28-2649" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramB)</span>
<span id="cb28-2650"><a href="#cb28-2650" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramB<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsB, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2651"><a href="#cb28-2651" aria-hidden="true" tabindex="-1"></a>paramB1 <span class="ot">&lt;-</span> paramB[,<span class="dv">1</span>]</span>
<span id="cb28-2652"><a href="#cb28-2652" aria-hidden="true" tabindex="-1"></a>paramB2 <span class="ot">&lt;-</span> paramB[,<span class="dv">2</span>]</span>
<span id="cb28-2653"><a href="#cb28-2653" aria-hidden="true" tabindex="-1"></a>paramB3 <span class="ot">&lt;-</span> paramB[,<span class="dv">3</span>]</span>
<span id="cb28-2654"><a href="#cb28-2654" aria-hidden="true" tabindex="-1"></a>paramB4 <span class="ot">&lt;-</span> paramB[,<span class="dv">4</span>]</span>
<span id="cb28-2655"><a href="#cb28-2655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2656"><a href="#cb28-2656" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA1,paramB1)</span>
<span id="cb28-2657"><a href="#cb28-2657" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA2,paramB2)</span>
<span id="cb28-2658"><a href="#cb28-2658" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA3,paramB3)</span>
<span id="cb28-2659"><a href="#cb28-2659" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA4,paramB4)</span>
<span id="cb28-2660"><a href="#cb28-2660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2661"><a href="#cb28-2661" aria-hidden="true" tabindex="-1"></a>GroupType <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Acids"</span>, <span class="fu">length</span>(paramA1)),<span class="fu">rep</span>(<span class="st">"Bases"</span>, <span class="fu">length</span>(paramB1)))</span>
<span id="cb28-2662"><a href="#cb28-2662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2663"><a href="#cb28-2663" aria-hidden="true" tabindex="-1"></a>data_to_plot_diss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(param1,param2,param3,param4,GroupType)</span>
<span id="cb28-2664"><a href="#cb28-2664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2665"><a href="#cb28-2665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2666"><a href="#cb28-2666" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(data_to_plot_diss,<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">columnLabels =</span> <span class="fu">c</span>(<span class="st">"etadlogkw1"</span>,<span class="st">"etadlogkw2"</span>,<span class="st">"etadlogkw3"</span>, <span class="st">"etadlogkw4"</span>),</span>
<span id="cb28-2667"><a href="#cb28-2667" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,</span>
<span id="cb28-2668"><a href="#cb28-2668" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span><span class="dv">1</span>,</span>
<span id="cb28-2669"><a href="#cb28-2669" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> GroupType, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-2670"><a href="#cb28-2670" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))<span class="sc">+</span></span>
<span id="cb28-2671"><a href="#cb28-2671" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb28-2672"><a href="#cb28-2672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2673"><a href="#cb28-2673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2674"><a href="#cb28-2674" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etacdS1mAc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2675"><a href="#cb28-2675" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramA)</span>
<span id="cb28-2676"><a href="#cb28-2676" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramA<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsA, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2677"><a href="#cb28-2677" aria-hidden="true" tabindex="-1"></a>paramA1 <span class="ot">&lt;-</span> paramA[,<span class="dv">1</span>]</span>
<span id="cb28-2678"><a href="#cb28-2678" aria-hidden="true" tabindex="-1"></a>paramA2 <span class="ot">&lt;-</span> paramA[,<span class="dv">2</span>]</span>
<span id="cb28-2679"><a href="#cb28-2679" aria-hidden="true" tabindex="-1"></a>paramA3 <span class="ot">&lt;-</span> paramA[,<span class="dv">3</span>]</span>
<span id="cb28-2680"><a href="#cb28-2680" aria-hidden="true" tabindex="-1"></a>paramA4 <span class="ot">&lt;-</span> paramA[,<span class="dv">4</span>]</span>
<span id="cb28-2681"><a href="#cb28-2681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2682"><a href="#cb28-2682" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etacdS1mBc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2683"><a href="#cb28-2683" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramB)</span>
<span id="cb28-2684"><a href="#cb28-2684" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramB<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsB, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2685"><a href="#cb28-2685" aria-hidden="true" tabindex="-1"></a>paramB1 <span class="ot">&lt;-</span> paramB[,<span class="dv">1</span>]</span>
<span id="cb28-2686"><a href="#cb28-2686" aria-hidden="true" tabindex="-1"></a>paramB2 <span class="ot">&lt;-</span> paramB[,<span class="dv">2</span>]</span>
<span id="cb28-2687"><a href="#cb28-2687" aria-hidden="true" tabindex="-1"></a>paramB3 <span class="ot">&lt;-</span> paramB[,<span class="dv">3</span>]</span>
<span id="cb28-2688"><a href="#cb28-2688" aria-hidden="true" tabindex="-1"></a>paramB4 <span class="ot">&lt;-</span> paramB[,<span class="dv">4</span>]</span>
<span id="cb28-2689"><a href="#cb28-2689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2690"><a href="#cb28-2690" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA1,paramB1)</span>
<span id="cb28-2691"><a href="#cb28-2691" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA2,paramB2)</span>
<span id="cb28-2692"><a href="#cb28-2692" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA3,paramB3)</span>
<span id="cb28-2693"><a href="#cb28-2693" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA4,paramB4)</span>
<span id="cb28-2694"><a href="#cb28-2694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2695"><a href="#cb28-2695" aria-hidden="true" tabindex="-1"></a>GroupType <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Acids"</span>, <span class="fu">length</span>(paramA1)),<span class="fu">rep</span>(<span class="st">"Bases"</span>, <span class="fu">length</span>(paramB1)))</span>
<span id="cb28-2696"><a href="#cb28-2696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2697"><a href="#cb28-2697" aria-hidden="true" tabindex="-1"></a>data_to_plot_diss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(param1,param2,param3,param4,GroupType)</span>
<span id="cb28-2698"><a href="#cb28-2698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2699"><a href="#cb28-2699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2700"><a href="#cb28-2700" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(data_to_plot_diss,<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">columnLabels =</span> <span class="fu">c</span>(<span class="st">"etacdS1m1"</span>,<span class="st">"etacdS1m2"</span>,<span class="st">"etacdS1m3"</span>, <span class="st">"etacdS1m4"</span>),</span>
<span id="cb28-2701"><a href="#cb28-2701" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,</span>
<span id="cb28-2702"><a href="#cb28-2702" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span><span class="dv">1</span>,</span>
<span id="cb28-2703"><a href="#cb28-2703" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> GroupType, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-2704"><a href="#cb28-2704" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))<span class="sc">+</span></span>
<span id="cb28-2705"><a href="#cb28-2705" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb28-2706"><a href="#cb28-2706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2707"><a href="#cb28-2707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2708"><a href="#cb28-2708" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etacdS1Ac"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2709"><a href="#cb28-2709" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramA)</span>
<span id="cb28-2710"><a href="#cb28-2710" aria-hidden="true" tabindex="-1"></a>paramA <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramA<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsA, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2711"><a href="#cb28-2711" aria-hidden="true" tabindex="-1"></a>paramA1 <span class="ot">&lt;-</span> paramA[,<span class="dv">1</span>]</span>
<span id="cb28-2712"><a href="#cb28-2712" aria-hidden="true" tabindex="-1"></a>paramA2 <span class="ot">&lt;-</span> paramA[,<span class="dv">2</span>]</span>
<span id="cb28-2713"><a href="#cb28-2713" aria-hidden="true" tabindex="-1"></a>paramA3 <span class="ot">&lt;-</span> paramA[,<span class="dv">3</span>]</span>
<span id="cb28-2714"><a href="#cb28-2714" aria-hidden="true" tabindex="-1"></a>paramA4 <span class="ot">&lt;-</span> paramA[,<span class="dv">4</span>]</span>
<span id="cb28-2715"><a href="#cb28-2715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2716"><a href="#cb28-2716" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etacdS1Bc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2717"><a href="#cb28-2717" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">melt</span>(paramB)</span>
<span id="cb28-2718"><a href="#cb28-2718" aria-hidden="true" tabindex="-1"></a>paramB <span class="ot">&lt;-</span> <span class="fu">matrix</span>(paramB<span class="sc">$</span>value,<span class="at">nrow =</span> datastruct<span class="sc">$</span>nGroupsB, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2719"><a href="#cb28-2719" aria-hidden="true" tabindex="-1"></a>paramB1 <span class="ot">&lt;-</span> paramB[,<span class="dv">1</span>]</span>
<span id="cb28-2720"><a href="#cb28-2720" aria-hidden="true" tabindex="-1"></a>paramB2 <span class="ot">&lt;-</span> paramB[,<span class="dv">2</span>]</span>
<span id="cb28-2721"><a href="#cb28-2721" aria-hidden="true" tabindex="-1"></a>paramB3 <span class="ot">&lt;-</span> paramB[,<span class="dv">3</span>]</span>
<span id="cb28-2722"><a href="#cb28-2722" aria-hidden="true" tabindex="-1"></a>paramB4 <span class="ot">&lt;-</span> paramB[,<span class="dv">4</span>]</span>
<span id="cb28-2723"><a href="#cb28-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2724"><a href="#cb28-2724" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA1,paramB1)</span>
<span id="cb28-2725"><a href="#cb28-2725" aria-hidden="true" tabindex="-1"></a>param2 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA2,paramB2)</span>
<span id="cb28-2726"><a href="#cb28-2726" aria-hidden="true" tabindex="-1"></a>param3 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA3,paramB3)</span>
<span id="cb28-2727"><a href="#cb28-2727" aria-hidden="true" tabindex="-1"></a>param4 <span class="ot">&lt;-</span> <span class="fu">c</span>(paramA4,paramB4)</span>
<span id="cb28-2728"><a href="#cb28-2728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2729"><a href="#cb28-2729" aria-hidden="true" tabindex="-1"></a>GroupType <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Acids"</span>, <span class="fu">length</span>(paramA1)),<span class="fu">rep</span>(<span class="st">"Bases"</span>, <span class="fu">length</span>(paramB1)))</span>
<span id="cb28-2730"><a href="#cb28-2730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2731"><a href="#cb28-2731" aria-hidden="true" tabindex="-1"></a>data_to_plot_diss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(param1,param2,param3,param4,GroupType)</span>
<span id="cb28-2732"><a href="#cb28-2732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2733"><a href="#cb28-2733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2734"><a href="#cb28-2734" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">&lt;-</span><span class="fu">ggpairs</span>(data_to_plot_diss,<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">columnLabels =</span> <span class="fu">c</span>(<span class="st">"etacdS11"</span>,<span class="st">"etacdS12"</span>,<span class="st">"etacdS13"</span>, <span class="st">"etacdS14"</span>),</span>
<span id="cb28-2735"><a href="#cb28-2735" aria-hidden="true" tabindex="-1"></a>        <span class="at">labeller =</span> <span class="st">"label_parsed"</span>,</span>
<span id="cb28-2736"><a href="#cb28-2736" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend =</span><span class="dv">1</span>,</span>
<span id="cb28-2737"><a href="#cb28-2737" aria-hidden="true" tabindex="-1"></a>        <span class="fu">aes</span>(<span class="at">color =</span> GroupType, <span class="at">alpha =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-2738"><a href="#cb28-2738" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">"points"</span>))<span class="sc">+</span></span>
<span id="cb28-2739"><a href="#cb28-2739" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_alpha</span>(<span class="at">guide =</span> <span class="st">"none"</span>)</span>
<span id="cb28-2740"><a href="#cb28-2740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2741"><a href="#cb28-2741" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-2742"><a href="#cb28-2742" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb28-2743"><a href="#cb28-2743" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span>
<span id="cb28-2744"><a href="#cb28-2744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2745"><a href="#cb28-2745" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">etaplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"dissociated.dlogkw"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2746"><a href="#cb28-2746" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">etaplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"dissociated.dS1m"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p2, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2747"><a href="#cb28-2747" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">etaplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"dissociated.dS1"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p3, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2748"><a href="#cb28-2748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2749"><a href="#cb28-2749" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2750"><a href="#cb28-2750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2751"><a href="#cb28-2751" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effect of functional groups (exploratory)</span></span>
<span id="cb28-2752"><a href="#cb28-2752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2753"><a href="#cb28-2753" aria-hidden="true" tabindex="-1"></a>The following ETA plots present the relationship between individual eta values for logkwN and number of functional groups. This part is exploratory. Graphs are shown if there are at least 10 functional groups present in the dataset.</span>
<span id="cb28-2754"><a href="#cb28-2754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2755"><a href="#cb28-2755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r functionalgroupseffects}</span></span>
<span id="cb28-2756"><a href="#cb28-2756" aria-hidden="true" tabindex="-1"></a>param1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etalogkwN"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2757"><a href="#cb28-2757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2758"><a href="#cb28-2758" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_etas_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_etas_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^etaclogkwNc"</span>, <span class="fu">names</span>(draws_etas_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-2759"><a href="#cb28-2759" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">melt</span>(cparam)</span>
<span id="cb28-2760"><a href="#cb28-2760" aria-hidden="true" tabindex="-1"></a>cparam <span class="ot">&lt;-</span> <span class="fu">matrix</span>(cparam<span class="sc">$</span>value,<span class="at">nrow =</span> nAnalytes, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-2761"><a href="#cb28-2761" aria-hidden="true" tabindex="-1"></a>cparam1 <span class="ot">&lt;-</span> cparam[,<span class="dv">1</span>]</span>
<span id="cb28-2762"><a href="#cb28-2762" aria-hidden="true" tabindex="-1"></a>cparam2 <span class="ot">&lt;-</span> cparam[,<span class="dv">2</span>]</span>
<span id="cb28-2763"><a href="#cb28-2763" aria-hidden="true" tabindex="-1"></a>cparam3 <span class="ot">&lt;-</span> cparam[,<span class="dv">3</span>]</span>
<span id="cb28-2764"><a href="#cb28-2764" aria-hidden="true" tabindex="-1"></a>cparam4 <span class="ot">&lt;-</span> cparam[,<span class="dv">4</span>]</span>
<span id="cb28-2765"><a href="#cb28-2765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2766"><a href="#cb28-2766" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">which</span>(totalnrgroups<span class="sc">&gt;</span><span class="dv">10</span>)){</span>
<span id="cb28-2767"><a href="#cb28-2767" aria-hidden="true" tabindex="-1"></a>nrgroups <span class="ot">=</span> <span class="fu">as.factor</span>(nrfungroups[,i])</span>
<span id="cb28-2768"><a href="#cb28-2768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2769"><a href="#cb28-2769" aria-hidden="true" tabindex="-1"></a>data_to_plot_fungr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(param1,cparam1,cparam2,cparam3,cparam4, nrgroups)</span>
<span id="cb28-2770"><a href="#cb28-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2771"><a href="#cb28-2771" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">&lt;-</span>data_to_plot_fungr <span class="sc">%&gt;%</span> tidyr<span class="sc">::</span><span class="fu">gather</span>(<span class="st">"name"</span>, <span class="st">"count"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb28-2772"><a href="#cb28-2772" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>(<span class="at">etaname =</span> <span class="fu">case_when</span>(name <span class="sc">==</span> <span class="st">"param1"</span> <span class="sc">~</span> <span class="st">"etalogkwN"</span>,</span>
<span id="cb28-2773"><a href="#cb28-2773" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"cparam1"</span> <span class="sc">~</span> <span class="st">"etaclogkwN_1"</span>,</span>
<span id="cb28-2774"><a href="#cb28-2774" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"cparam2"</span> <span class="sc">~</span> <span class="st">"etaclogkwN_2"</span>,</span>
<span id="cb28-2775"><a href="#cb28-2775" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"cparam3"</span> <span class="sc">~</span> <span class="st">"etaclogkwN_3"</span>,</span>
<span id="cb28-2776"><a href="#cb28-2776" aria-hidden="true" tabindex="-1"></a>                        name <span class="sc">==</span> <span class="st">"cparam4"</span> <span class="sc">~</span> <span class="st">"etaclogkwN_4"</span></span>
<span id="cb28-2777"><a href="#cb28-2777" aria-hidden="true" tabindex="-1"></a>                        ))  <span class="sc">%&gt;%</span></span>
<span id="cb28-2778"><a href="#cb28-2778" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(., <span class="fu">aes</span>(<span class="at">y=</span>count, <span class="at">x=</span>nrgroups))<span class="sc">+</span></span>
<span id="cb28-2779"><a href="#cb28-2779" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb28-2780"><a href="#cb28-2780" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(.<span class="sc">~</span>etaname)<span class="sc">+</span></span>
<span id="cb28-2781"><a href="#cb28-2781" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(functionalgroupsnames[i,<span class="dv">2</span>]), <span class="at">x=</span><span class="st">"Nr of functional groups"</span>, <span class="at">y=</span><span class="st">"eta"</span>)</span>
<span id="cb28-2782"><a href="#cb28-2782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2783"><a href="#cb28-2783" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-2784"><a href="#cb28-2784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2785"><a href="#cb28-2785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2786"><a href="#cb28-2786" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">etaplots</span><span class="sc">\\</span><span class="st">functionalgroupseffects</span><span class="sc">\\</span><span class="st">"</span>, functionalgroupsnames[i,<span class="dv">2</span>], <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2787"><a href="#cb28-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2788"><a href="#cb28-2788" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2789"><a href="#cb28-2789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2790"><a href="#cb28-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2791"><a href="#cb28-2791" aria-hidden="true" tabindex="-1"></a><span class="fu"># Comparison of observed and model predicted retention times</span></span>
<span id="cb28-2792"><a href="#cb28-2792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2793"><a href="#cb28-2793" aria-hidden="true" tabindex="-1"></a>The individual and population model predictions were simulated using a more dense design. The individual predictions are based on population-level parameters, predictors, and all of the observed retention time measurements. The population predictions are based on population-level parameters and predictors.</span>
<span id="cb28-2794"><a href="#cb28-2794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2795"><a href="#cb28-2795" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-fitsim}</span></span>
<span id="cb28-2796"><a href="#cb28-2796" aria-hidden="true" tabindex="-1"></a>fitsim <span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">as_cmdstan_fit</span>(<span class="fu">c</span>(</span>
<span id="cb28-2797"><a href="#cb28-2797" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#  'stanfiles/output_1.csv',</span></span>
<span id="cb28-2798"><a href="#cb28-2798" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#  'stanfiles/output_2.csv',</span></span>
<span id="cb28-2799"><a href="#cb28-2799" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#  'stanfiles/output_3.csv',</span></span>
<span id="cb28-2800"><a href="#cb28-2800" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#  'stanfiles/output_4.csv',</span></span>
<span id="cb28-2801"><a href="#cb28-2801" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#  'stanfiles/output_5.csv',</span></span>
<span id="cb28-2802"><a href="#cb28-2802" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#  'stanfiles/output_6.csv',</span></span>
<span id="cb28-2803"><a href="#cb28-2803" aria-hidden="true" tabindex="-1"></a>                                 <span class="co">#  'stanfiles/output_7.csv',</span></span>
<span id="cb28-2804"><a href="#cb28-2804" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">'stanfiles/output_8.csv'</span></span>
<span id="cb28-2805"><a href="#cb28-2805" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-2806"><a href="#cb28-2806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2807"><a href="#cb28-2807" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2808"><a href="#cb28-2808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2809"><a href="#cb28-2809" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-design}</span></span>
<span id="cb28-2810"><a href="#cb28-2810" aria-hidden="true" tabindex="-1"></a>design <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data/hplcparam_design.csv'</span>)</span>
<span id="cb28-2811"><a href="#cb28-2811" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>Mod  <span class="ot">=</span> <span class="fu">as.character</span>(design<span class="sc">$</span>Mod)</span>
<span id="cb28-2812"><a href="#cb28-2812" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>Mod2 <span class="ot">=</span> <span class="fu">ifelse</span>(design<span class="sc">$</span>Mod<span class="sc">==</span><span class="st">"MeOH"</span>,<span class="dv">1</span>,<span class="dv">2</span>) <span class="co"># MeOH = 1, ACN = 2</span></span>
<span id="cb28-2813"><a href="#cb28-2813" aria-hidden="true" tabindex="-1"></a>design<span class="sc">$</span>expid <span class="ot">=</span> <span class="fu">match</span>(design<span class="sc">$</span>expid, <span class="fu">unique</span>(design<span class="sc">$</span>expid))</span>
<span id="cb28-2814"><a href="#cb28-2814" aria-hidden="true" tabindex="-1"></a>nAnalytes <span class="ot">&lt;-</span> datastruct<span class="sc">$</span>nAnalytes</span>
<span id="cb28-2815"><a href="#cb28-2815" aria-hidden="true" tabindex="-1"></a>nColumns <span class="ot">&lt;-</span> datastruct<span class="sc">$</span>nColumns</span>
<span id="cb28-2816"><a href="#cb28-2816" aria-hidden="true" tabindex="-1"></a>nExp <span class="ot">&lt;-</span> <span class="fu">nrow</span>(design);</span>
<span id="cb28-2817"><a href="#cb28-2817" aria-hidden="true" tabindex="-1"></a>datasim <span class="ot">&lt;-</span> design <span class="sc">%&gt;%</span></span>
<span id="cb28-2818"><a href="#cb28-2818" aria-hidden="true" tabindex="-1"></a>           <span class="fu">slice</span>(<span class="fu">rep</span>(<span class="fu">row_number</span>(), nAnalytes<span class="sc">*</span>nColumns)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2819"><a href="#cb28-2819" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mutate</span>(<span class="at">Column =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="at">each =</span> nExp<span class="sc">*</span>nAnalytes)) <span class="sc">%&gt;%</span></span>
<span id="cb28-2820"><a href="#cb28-2820" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mutate</span>(<span class="at">METID =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID),<span class="at">each=</span>nExp),nColumns))</span>
<span id="cb28-2821"><a href="#cb28-2821" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>expid <span class="ot">=</span> datasim<span class="sc">$</span>expid<span class="sc">*</span>(<span class="dv">2</span><span class="sc">-</span>datasim<span class="sc">$</span>Colum) <span class="sc">+</span> (<span class="fu">length</span>(<span class="fu">unique</span>(datasim<span class="sc">$</span>expid))<span class="sc">+</span>datasim<span class="sc">$</span>expid) <span class="sc">*</span>(datasim<span class="sc">$</span>Colum<span class="dv">-1</span>)</span>
<span id="cb28-2822"><a href="#cb28-2822" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>ColumnName <span class="ot">=</span> <span class="fu">ifelse</span>(datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">1</span>,<span class="st">"XBridge Shield RP18"</span>,</span>
<span id="cb28-2823"><a href="#cb28-2823" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">2</span>,<span class="st">"XTerra MS C18"</span>,</span>
<span id="cb28-2824"><a href="#cb28-2824" aria-hidden="true" tabindex="-1"></a>                                   <span class="fu">ifelse</span>(datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">3</span>,<span class="st">"XBridge Phenyl"</span>,</span>
<span id="cb28-2825"><a href="#cb28-2825" aria-hidden="true" tabindex="-1"></a>                                          <span class="fu">ifelse</span>(datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">4</span>,<span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>))))</span>
<span id="cb28-2826"><a href="#cb28-2826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2827"><a href="#cb28-2827" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>to[datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">1</span>] <span class="ot">=</span> <span class="fl">0.532</span></span>
<span id="cb28-2828"><a href="#cb28-2828" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>to[datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">2</span>] <span class="ot">=</span> <span class="fl">0.542</span></span>
<span id="cb28-2829"><a href="#cb28-2829" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>to[datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">3</span>] <span class="ot">=</span> <span class="fl">0.542</span></span>
<span id="cb28-2830"><a href="#cb28-2830" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>to[datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">4</span>] <span class="ot">=</span> <span class="fl">0.552</span></span>
<span id="cb28-2831"><a href="#cb28-2831" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>to[datasim<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">5</span>] <span class="ot">=</span> <span class="fl">0.566</span></span>
<span id="cb28-2832"><a href="#cb28-2832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2833"><a href="#cb28-2833" aria-hidden="true" tabindex="-1"></a>datastructsim <span class="ot">&lt;-</span>datastruct</span>
<span id="cb28-2834"><a href="#cb28-2834" aria-hidden="true" tabindex="-1"></a>datastructsim<span class="sc">$</span>nObs<span class="ot">=</span><span class="fu">length</span>(datasim<span class="sc">$</span>METID)</span>
<span id="cb28-2835"><a href="#cb28-2835" aria-hidden="true" tabindex="-1"></a>datastructsim<span class="sc">$</span>analyte<span class="ot">=</span><span class="fu">match</span>(datasim<span class="sc">$</span>METID, <span class="fu">unique</span>(datasim<span class="sc">$</span>METID))</span>
<span id="cb28-2836"><a href="#cb28-2836" aria-hidden="true" tabindex="-1"></a>datastructsim<span class="sc">$</span>modifier<span class="ot">=</span><span class="fu">match</span>(datasim<span class="sc">$</span>Mod2, <span class="fu">sort</span>(<span class="fu">unique</span>(datasim<span class="sc">$</span>Mod2)))</span>
<span id="cb28-2837"><a href="#cb28-2837" aria-hidden="true" tabindex="-1"></a>datastructsim<span class="sc">$</span>steps<span class="ot">=</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">-</span>datasim<span class="sc">$</span>Mod2) <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>(datasim<span class="sc">$</span>Mod2<span class="dv">-1</span>)</span>
<span id="cb28-2838"><a href="#cb28-2838" aria-hidden="true" tabindex="-1"></a>datastructsim<span class="sc">$</span>column<span class="ot">=</span><span class="fu">match</span>(datasim<span class="sc">$</span>Column, <span class="fu">unique</span>(datasim<span class="sc">$</span>Column))</span>
<span id="cb28-2839"><a href="#cb28-2839" aria-hidden="true" tabindex="-1"></a>datastructsim<span class="sc">$</span>hplcparam<span class="ot">=</span><span class="fu">cbind</span>(datasim<span class="sc">$</span>tg,datasim<span class="sc">$</span>td,datasim<span class="sc">$</span>to,datasim<span class="sc">$</span>te,</span>
<span id="cb28-2840"><a href="#cb28-2840" aria-hidden="true" tabindex="-1"></a>                              datasim<span class="sc">$</span>fio,datasim<span class="sc">$</span>fik,datasim<span class="sc">$</span>Mod2<span class="dv">-1</span>,datasim<span class="sc">$</span>pHo,</span>
<span id="cb28-2841"><a href="#cb28-2841" aria-hidden="true" tabindex="-1"></a>                              datasim<span class="sc">$</span>alpha1,datasim<span class="sc">$</span>alpha2,(datasim<span class="sc">$</span>Temp<span class="dv">-25</span>)<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb28-2842"><a href="#cb28-2842" aria-hidden="true" tabindex="-1"></a>                              datasim<span class="sc">$</span>Column<span class="dv">-1</span>)</span>
<span id="cb28-2843"><a href="#cb28-2843" aria-hidden="true" tabindex="-1"></a>datastructsim<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,datastructsim<span class="sc">$</span>nObs)</span>
<span id="cb28-2844"><a href="#cb28-2844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2845"><a href="#cb28-2845" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2846"><a href="#cb28-2846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2847"><a href="#cb28-2847" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sim-gg, eval = FALSE}</span></span>
<span id="cb28-2848"><a href="#cb28-2848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2849"><a href="#cb28-2849" aria-hidden="true" tabindex="-1"></a>model_sim <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-sim.stan"</span>)</span>
<span id="cb28-2850"><a href="#cb28-2850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2851"><a href="#cb28-2851" aria-hidden="true" tabindex="-1"></a>fit_sim  <span class="ot">&lt;-</span> model_sim<span class="sc">$</span><span class="fu">generate_quantities</span>(fitsim,</span>
<span id="cb28-2852"><a href="#cb28-2852" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data =</span> datastructsim,</span>
<span id="cb28-2853"><a href="#cb28-2853" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb28-2854"><a href="#cb28-2854" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-2855"><a href="#cb28-2855" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>)</span>
<span id="cb28-2856"><a href="#cb28-2856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2857"><a href="#cb28-2857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2858"><a href="#cb28-2858" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sim-load}</span></span>
<span id="cb28-2859"><a href="#cb28-2859" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">read_cmdstan_csv</span>(<span class="fu">c</span>(</span>
<span id="cb28-2860"><a href="#cb28-2860" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-sim-202308240900-1-3a5236.csv'</span></span>
<span id="cb28-2861"><a href="#cb28-2861" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-2862"><a href="#cb28-2862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2863"><a href="#cb28-2863" aria-hidden="true" tabindex="-1"></a>draws_sim_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span>generated_quantities)</span>
<span id="cb28-2864"><a href="#cb28-2864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2865"><a href="#cb28-2865" aria-hidden="true" tabindex="-1"></a><span class="co"># draws_sim_df &lt;- fit_sim$draws(format = "df")</span></span>
<span id="cb28-2866"><a href="#cb28-2866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2867"><a href="#cb28-2867" aria-hidden="true" tabindex="-1"></a>tr_sim_Cond <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_sim_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^trCond"</span>, <span class="fu">names</span>(draws_sim_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-2868"><a href="#cb28-2868" aria-hidden="true" tabindex="-1"></a>tr_sim_Pred <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_sim_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^trPred"</span>, <span class="fu">names</span>(draws_sim_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-2869"><a href="#cb28-2869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2870"><a href="#cb28-2870" aria-hidden="true" tabindex="-1"></a>tr_sim_Cond<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(tr_sim_Cond))</span>
<span id="cb28-2871"><a href="#cb28-2871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2872"><a href="#cb28-2872" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>trCond_l<span class="ot">=</span>tr_sim_Cond<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-2873"><a href="#cb28-2873" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>trCond_m<span class="ot">=</span>tr_sim_Cond<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-2874"><a href="#cb28-2874" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>trCond_h<span class="ot">=</span>tr_sim_Cond<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-2875"><a href="#cb28-2875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2876"><a href="#cb28-2876" aria-hidden="true" tabindex="-1"></a>tr_sim_Pred<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(tr_sim_Pred))</span>
<span id="cb28-2877"><a href="#cb28-2877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2878"><a href="#cb28-2878" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>trPred_l<span class="ot">=</span>tr_sim_Pred<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-2879"><a href="#cb28-2879" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>trPred_m<span class="ot">=</span>tr_sim_Pred<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-2880"><a href="#cb28-2880" aria-hidden="true" tabindex="-1"></a>datasim<span class="sc">$</span>trPred_h<span class="ot">=</span>tr_sim_Pred<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-2881"><a href="#cb28-2881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2882"><a href="#cb28-2882" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2883"><a href="#cb28-2883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2884"><a href="#cb28-2884" aria-hidden="true" tabindex="-1"></a><span class="fu">## Individual predictions:</span></span>
<span id="cb28-2885"><a href="#cb28-2885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2886"><a href="#cb28-2886" aria-hidden="true" tabindex="-1"></a><span class="in">```{r individualpred}</span></span>
<span id="cb28-2887"><a href="#cb28-2887" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-2888"><a href="#cb28-2888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2889"><a href="#cb28-2889" aria-hidden="true" tabindex="-1"></a><span class="co">#analyte_ID_sample &lt;-unique(data$METID)</span></span>
<span id="cb28-2890"><a href="#cb28-2890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2891"><a href="#cb28-2891" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-2892"><a href="#cb28-2892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2893"><a href="#cb28-2893" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-2894"><a href="#cb28-2894" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>(<span class="at">data=</span>data[<span class="fu">which</span>(data<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),],</span>
<span id="cb28-2895"><a href="#cb28-2895" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> RT, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-2896"><a href="#cb28-2896" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">data=</span>datasim[<span class="fu">which</span>(datasim<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),],</span>
<span id="cb28-2897"><a href="#cb28-2897" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> trCond_m, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-2898"><a href="#cb28-2898" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="at">data=</span>datasim[<span class="fu">which</span>(datasim<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),],</span>
<span id="cb28-2899"><a href="#cb28-2899" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">ymin =</span> trCond_l, <span class="at">ymax =</span> trCond_h, <span class="at">fill =</span> <span class="fu">as.factor</span>(tg)), <span class="at">alpha =</span> <span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb28-2900"><a href="#cb28-2900" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="dv">2</span>,<span class="dv">11</span>)<span class="sc">+</span></span>
<span id="cb28-2901"><a href="#cb28-2901" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-2902"><a href="#cb28-2902" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]),</span>
<span id="cb28-2903"><a href="#cb28-2903" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-2904"><a href="#cb28-2904" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">"Retention time (individual), min"</span>,</span>
<span id="cb28-2905"><a href="#cb28-2905" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-2906"><a href="#cb28-2906" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">"tg, min"</span>)</span>
<span id="cb28-2907"><a href="#cb28-2907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2908"><a href="#cb28-2908" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">concordanceplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".individual"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2909"><a href="#cb28-2909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2910"><a href="#cb28-2910" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-2911"><a href="#cb28-2911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2912"><a href="#cb28-2912" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2913"><a href="#cb28-2913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2914"><a href="#cb28-2914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2915"><a href="#cb28-2915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2916"><a href="#cb28-2916" aria-hidden="true" tabindex="-1"></a><span class="fu">## Population predictions:</span></span>
<span id="cb28-2917"><a href="#cb28-2917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2918"><a href="#cb28-2918" aria-hidden="true" tabindex="-1"></a><span class="in">```{r populationrped}</span></span>
<span id="cb28-2919"><a href="#cb28-2919" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-2920"><a href="#cb28-2920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2921"><a href="#cb28-2921" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-2922"><a href="#cb28-2922" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-2923"><a href="#cb28-2923" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_point</span>(<span class="at">data=</span>data[<span class="fu">which</span>(data<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),],</span>
<span id="cb28-2924"><a href="#cb28-2924" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> RT, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-2925"><a href="#cb28-2925" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">data=</span>datasim[<span class="fu">which</span>(datasim<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),],</span>
<span id="cb28-2926"><a href="#cb28-2926" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> trPred_m, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-2927"><a href="#cb28-2927" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="at">data=</span>datasim[<span class="fu">which</span>(datasim<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),],</span>
<span id="cb28-2928"><a href="#cb28-2928" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">ymin =</span> trPred_l, <span class="at">ymax =</span> trPred_h, <span class="at">fill =</span> <span class="fu">as.factor</span>(tg)), <span class="at">alpha =</span> <span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb28-2929"><a href="#cb28-2929" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="dv">2</span>,<span class="dv">11</span>)<span class="sc">+</span></span>
<span id="cb28-2930"><a href="#cb28-2930" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-2931"><a href="#cb28-2931" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]),</span>
<span id="cb28-2932"><a href="#cb28-2932" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-2933"><a href="#cb28-2933" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">"Retention time (population), min"</span>,</span>
<span id="cb28-2934"><a href="#cb28-2934" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-2935"><a href="#cb28-2935" aria-hidden="true" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">"tg, min"</span>)</span>
<span id="cb28-2936"><a href="#cb28-2936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2937"><a href="#cb28-2937" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">concordanceplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".population"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-2938"><a href="#cb28-2938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2939"><a href="#cb28-2939" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-2940"><a href="#cb28-2940" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2941"><a href="#cb28-2941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2942"><a href="#cb28-2942" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2943"><a href="#cb28-2943" aria-hidden="true" tabindex="-1"></a><span class="fu"># Uncertainity chromatogram</span></span>
<span id="cb28-2944"><a href="#cb28-2944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2945"><a href="#cb28-2945" aria-hidden="true" tabindex="-1"></a>Below is the example of an uncertainty chromatogram expected for tg = 90 min, pH = 4.9, Temp = $25^oC$ in MeOH. The individual and population predictions are shown.</span>
<span id="cb28-2946"><a href="#cb28-2946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2947"><a href="#cb28-2947" aria-hidden="true" tabindex="-1"></a><span class="in">```{r epred-gq, eval = FALSE}</span></span>
<span id="cb28-2948"><a href="#cb28-2948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2949"><a href="#cb28-2949" aria-hidden="true" tabindex="-1"></a>model_epred <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-epred.stan"</span>)</span>
<span id="cb28-2950"><a href="#cb28-2950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2951"><a href="#cb28-2951" aria-hidden="true" tabindex="-1"></a>fit_epred  <span class="ot">&lt;-</span> model_epred<span class="sc">$</span><span class="fu">generate_quantities</span>(fitsim,</span>
<span id="cb28-2952"><a href="#cb28-2952" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data =</span> datastructsim,</span>
<span id="cb28-2953"><a href="#cb28-2953" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb28-2954"><a href="#cb28-2954" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-2955"><a href="#cb28-2955" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>)</span>
<span id="cb28-2956"><a href="#cb28-2956" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2957"><a href="#cb28-2957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2958"><a href="#cb28-2958" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-epred-gq}</span></span>
<span id="cb28-2959"><a href="#cb28-2959" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">read_cmdstan_csv</span>(<span class="fu">c</span>(</span>
<span id="cb28-2960"><a href="#cb28-2960" aria-hidden="true" tabindex="-1"></a>                                <span class="st">'stanfiles/hplc-gra-fivecolumns-epred-202308240927-1-1ff2c7.csv'</span></span>
<span id="cb28-2961"><a href="#cb28-2961" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-2962"><a href="#cb28-2962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2963"><a href="#cb28-2963" aria-hidden="true" tabindex="-1"></a>draws_epred_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span>generated_quantities)</span>
<span id="cb28-2964"><a href="#cb28-2964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-2965"><a href="#cb28-2965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2966"><a href="#cb28-2966" aria-hidden="true" tabindex="-1"></a><span class="in">```{r uncertainitychromatogram}</span></span>
<span id="cb28-2967"><a href="#cb28-2967" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-2968"><a href="#cb28-2968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2969"><a href="#cb28-2969" aria-hidden="true" tabindex="-1"></a>col.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)</span>
<span id="cb28-2970"><a href="#cb28-2970" aria-hidden="true" tabindex="-1"></a>wpCond<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb28-2971"><a href="#cb28-2971" aria-hidden="true" tabindex="-1"></a>wpPred<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb28-2972"><a href="#cb28-2972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2973"><a href="#cb28-2973" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb28-2974"><a href="#cb28-2974" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-2975"><a href="#cb28-2975" aria-hidden="true" tabindex="-1"></a>               datasim<span class="sc">$</span>tg<span class="sc">==</span><span class="dv">90</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-2976"><a href="#cb28-2976" aria-hidden="true" tabindex="-1"></a>               datasim<span class="sc">$</span>pH<span class="sc">==</span> <span class="dv">4</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-2977"><a href="#cb28-2977" aria-hidden="true" tabindex="-1"></a>               datasim<span class="sc">$</span>Column<span class="sc">==</span>i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-2978"><a href="#cb28-2978" aria-hidden="true" tabindex="-1"></a>               datasim<span class="sc">$</span>Mod2<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-2979"><a href="#cb28-2979" aria-hidden="true" tabindex="-1"></a>               datasim<span class="sc">$</span>Temp<span class="sc">==</span><span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-2980"><a href="#cb28-2980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2981"><a href="#cb28-2981" aria-hidden="true" tabindex="-1"></a>data_to_plot <span class="ot">&lt;-</span> draws_epred_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_epred_df) <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"trHatCond["</span>,idx,<span class="st">"]"</span>))]</span>
<span id="cb28-2982"><a href="#cb28-2982" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample])</span>
<span id="cb28-2983"><a href="#cb28-2983" aria-hidden="true" tabindex="-1"></a>wpCond1 <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_to_plot)</span>
<span id="cb28-2984"><a href="#cb28-2984" aria-hidden="true" tabindex="-1"></a>wpCond1<span class="sc">$</span>Column <span class="ot">&lt;-</span> <span class="fu">unname</span>(col.labs[i])</span>
<span id="cb28-2985"><a href="#cb28-2985" aria-hidden="true" tabindex="-1"></a>data_to_plot <span class="ot">&lt;-</span> draws_epred_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_epred_df) <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"trHatPred["</span>,idx,<span class="st">"]"</span>))]</span>
<span id="cb28-2986"><a href="#cb28-2986" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample])</span>
<span id="cb28-2987"><a href="#cb28-2987" aria-hidden="true" tabindex="-1"></a>wpPred1 <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_to_plot)</span>
<span id="cb28-2988"><a href="#cb28-2988" aria-hidden="true" tabindex="-1"></a>wpPred1<span class="sc">$</span>Column <span class="ot">&lt;-</span> <span class="fu">unname</span>(col.labs[i])</span>
<span id="cb28-2989"><a href="#cb28-2989" aria-hidden="true" tabindex="-1"></a>wpCond<span class="ot">=</span> <span class="fu">rbind</span>(wpCond,wpCond1)</span>
<span id="cb28-2990"><a href="#cb28-2990" aria-hidden="true" tabindex="-1"></a>wpPred<span class="ot">=</span> <span class="fu">rbind</span>(wpPred,wpPred1)</span>
<span id="cb28-2991"><a href="#cb28-2991" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-2992"><a href="#cb28-2992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2993"><a href="#cb28-2993" aria-hidden="true" tabindex="-1"></a>wpCond<span class="sc">$</span>Column<span class="ot">=</span><span class="fu">as.factor</span>(wpCond<span class="sc">$</span>Column)</span>
<span id="cb28-2994"><a href="#cb28-2994" aria-hidden="true" tabindex="-1"></a>wpPred<span class="sc">$</span>Column<span class="ot">=</span><span class="fu">as.factor</span>(wpPred<span class="sc">$</span>Column)</span>
<span id="cb28-2995"><a href="#cb28-2995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2996"><a href="#cb28-2996" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wpCond)<span class="sc">+</span></span>
<span id="cb28-2997"><a href="#cb28-2997" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">colour=</span>variable)) <span class="sc">+</span></span>
<span id="cb28-2998"><a href="#cb28-2998" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"uncertainty chromatogram (individual predictions)"</span>,</span>
<span id="cb28-2999"><a href="#cb28-2999" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span><span class="st">"Retention Time, min"</span>,</span>
<span id="cb28-3000"><a href="#cb28-3000" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"pdf"</span>,</span>
<span id="cb28-3001"><a href="#cb28-3001" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"Analyte"</span>)<span class="sc">+</span></span>
<span id="cb28-3002"><a href="#cb28-3002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3003"><a href="#cb28-3003" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb28-3004"><a href="#cb28-3004" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Column, <span class="at">nrow=</span><span class="dv">3</span>,<span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb28-3005"><a href="#cb28-3005" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb28-3006"><a href="#cb28-3006" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb28-3007"><a href="#cb28-3007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3008"><a href="#cb28-3008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3009"><a href="#cb28-3009" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wpPred)<span class="sc">+</span></span>
<span id="cb28-3010"><a href="#cb28-3010" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">colour=</span>variable)) <span class="sc">+</span></span>
<span id="cb28-3011"><a href="#cb28-3011" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"uncertainty chromatogram (population predicitons)"</span>,</span>
<span id="cb28-3012"><a href="#cb28-3012" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span><span class="st">"Retention Time, min"</span>,</span>
<span id="cb28-3013"><a href="#cb28-3013" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"pdf"</span>,</span>
<span id="cb28-3014"><a href="#cb28-3014" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"Analyte"</span>)<span class="sc">+</span></span>
<span id="cb28-3015"><a href="#cb28-3015" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb28-3016"><a href="#cb28-3016" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Column, <span class="at">nrow=</span><span class="dv">3</span>,<span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb28-3017"><a href="#cb28-3017" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb28-3018"><a href="#cb28-3018" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb28-3019"><a href="#cb28-3019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3020"><a href="#cb28-3020" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">concordanceplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"uncertainitychromatogram.individual"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3021"><a href="#cb28-3021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3022"><a href="#cb28-3022" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">concordanceplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"uncertainitychromatogram.population"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p2, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3023"><a href="#cb28-3023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3024"><a href="#cb28-3024" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-3025"><a href="#cb28-3025" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb28-3026"><a href="#cb28-3026" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3027"><a href="#cb28-3027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3028"><a href="#cb28-3028" aria-hidden="true" tabindex="-1"></a><span class="fu">## Isocratic predictions (population predictions)</span></span>
<span id="cb28-3029"><a href="#cb28-3029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3030"><a href="#cb28-3030" aria-hidden="true" tabindex="-1"></a>To better asses the impact of parameters on retention we created graphs presenting the isocratic logarithm of retention factor vs. $\small \varphi$ for selected analytes. Separate graphs are shown for each dissociation form (r=1, r=2, r=3). Here the population predictions are shown:</span>
<span id="cb28-3031"><a href="#cb28-3031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3032"><a href="#cb28-3032" aria-hidden="true" tabindex="-1"></a><span class="in">```{r izo-pred-population}</span></span>
<span id="cb28-3033"><a href="#cb28-3033" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-3034"><a href="#cb28-3034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3035"><a href="#cb28-3035" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-3036"><a href="#cb28-3036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3037"><a href="#cb28-3037" aria-hidden="true" tabindex="-1"></a>idx_analyte <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID)<span class="sc">==</span>analyte_ID_sample[i])</span>
<span id="cb28-3038"><a href="#cb28-3038" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> draws_epred_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_epred_df) <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb28-3039"><a href="#cb28-3039" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3040"><a href="#cb28-3040" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3041"><a href="#cb28-3041" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3042"><a href="#cb28-3042" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3043"><a href="#cb28-3043" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3044"><a href="#cb28-3044" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3045"><a href="#cb28-3045" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3046"><a href="#cb28-3046" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3047"><a href="#cb28-3047" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3048"><a href="#cb28-3048" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3049"><a href="#cb28-3049" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3050"><a href="#cb28-3050" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3051"><a href="#cb28-3051" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3052"><a href="#cb28-3052" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3053"><a href="#cb28-3053" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3054"><a href="#cb28-3054" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3055"><a href="#cb28-3055" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3056"><a href="#cb28-3056" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3057"><a href="#cb28-3057" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3058"><a href="#cb28-3058" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3059"><a href="#cb28-3059" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3060"><a href="#cb28-3060" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3061"><a href="#cb28-3061" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3062"><a href="#cb28-3062" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3063"><a href="#cb28-3063" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3064"><a href="#cb28-3064" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3065"><a href="#cb28-3065" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3066"><a href="#cb28-3066" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3067"><a href="#cb28-3067" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3068"><a href="#cb28-3068" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3069"><a href="#cb28-3069" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3070"><a href="#cb28-3070" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3071"><a href="#cb28-3071" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3072"><a href="#cb28-3072" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3073"><a href="#cb28-3073" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3074"><a href="#cb28-3074" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3075"><a href="#cb28-3075" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3076"><a href="#cb28-3076" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3077"><a href="#cb28-3077" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3078"><a href="#cb28-3078" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3079"><a href="#cb28-3079" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3080"><a href="#cb28-3080" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3081"><a href="#cb28-3081" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3082"><a href="#cb28-3082" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3083"><a href="#cb28-3083" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3084"><a href="#cb28-3084" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2xPred[1,1]"</span>,</span>
<span id="cb28-3085"><a href="#cb28-3085" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2xPred[2,1]"</span>,</span>
<span id="cb28-3086"><a href="#cb28-3086" aria-hidden="true" tabindex="-1"></a>                <span class="st">".draw"</span>,<span class="st">".iteration"</span>,<span class="st">".chain"</span>))]</span>
<span id="cb28-3087"><a href="#cb28-3087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3088"><a href="#cb28-3088" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-3089"><a href="#cb28-3089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3090"><a href="#cb28-3090" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwxPred[, c, r], S1xPred[, m, c, r], S2xPred[m, ]) <span class="sc">%&gt;%</span></span>
<span id="cb28-3091"><a href="#cb28-3091" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">&lt;=</span>R[idx_analyte]<span class="sc">+</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb28-3092"><a href="#cb28-3092" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">fi =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3093"><a href="#cb28-3093" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logkPred =</span> logkwxPred<span class="sc">-</span>S1xPred<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>S2xPred)<span class="sc">*</span>fi<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>S2xPred<span class="sc">*</span>fi)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3094"><a href="#cb28-3094" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fi, <span class="at">y =</span> logkPred, <span class="at">color =</span> <span class="fu">as.factor</span>(c), <span class="at">fill =</span> <span class="fu">as.factor</span>(c))) <span class="sc">+</span></span>
<span id="cb28-3095"><a href="#cb28-3095" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-3096"><a href="#cb28-3096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(m<span class="sc">~</span>r, <span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">m=</span>mod.labs,<span class="at">r=</span>diss.labs))<span class="sc">+</span></span>
<span id="cb28-3097"><a href="#cb28-3097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]),<span class="at">color=</span> <span class="st">" "</span>,<span class="at">fill=</span> <span class="st">" "</span>, <span class="at">y =</span> <span class="st">"logk (population)"</span>, <span class="at">x=</span><span class="st">"\u03C6"</span>)<span class="sc">+</span></span>
<span id="cb28-3098"><a href="#cb28-3098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)) <span class="sc">+</span></span>
<span id="cb28-3099"><a href="#cb28-3099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>))<span class="sc">+</span></span>
<span id="cb28-3100"><a href="#cb28-3100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">color=</span><span class="st">"gray"</span>)</span>
<span id="cb28-3101"><a href="#cb28-3101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3102"><a href="#cb28-3102" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">izoparam</span><span class="sc">\\</span><span class="st">isopred</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".population"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3103"><a href="#cb28-3103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3104"><a href="#cb28-3104" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-3105"><a href="#cb28-3105" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3106"><a href="#cb28-3106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3107"><a href="#cb28-3107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3108"><a href="#cb28-3108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3109"><a href="#cb28-3109" aria-hidden="true" tabindex="-1"></a>Similarly we can quantify the column effects (between column differences in logk using XBridge Shield RP18 as a reference column):</span>
<span id="cb28-3110"><a href="#cb28-3110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3111"><a href="#cb28-3111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r izo-diff-population}</span></span>
<span id="cb28-3112"><a href="#cb28-3112" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-3113"><a href="#cb28-3113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3114"><a href="#cb28-3114" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-3115"><a href="#cb28-3115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3116"><a href="#cb28-3116" aria-hidden="true" tabindex="-1"></a>idx_analyte <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID)<span class="sc">==</span>analyte_ID_sample[i])</span>
<span id="cb28-3117"><a href="#cb28-3117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3118"><a href="#cb28-3118" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> draws_epred_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_epred_df) <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb28-3119"><a href="#cb28-3119" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3120"><a href="#cb28-3120" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3121"><a href="#cb28-3121" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3122"><a href="#cb28-3122" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3123"><a href="#cb28-3123" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3124"><a href="#cb28-3124" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3125"><a href="#cb28-3125" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3126"><a href="#cb28-3126" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3127"><a href="#cb28-3127" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3128"><a href="#cb28-3128" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3129"><a href="#cb28-3129" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3130"><a href="#cb28-3130" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3131"><a href="#cb28-3131" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3132"><a href="#cb28-3132" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3133"><a href="#cb28-3133" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3134"><a href="#cb28-3134" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3135"><a href="#cb28-3135" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3136"><a href="#cb28-3136" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3137"><a href="#cb28-3137" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3138"><a href="#cb28-3138" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3139"><a href="#cb28-3139" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3140"><a href="#cb28-3140" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3141"><a href="#cb28-3141" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3142"><a href="#cb28-3142" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3143"><a href="#cb28-3143" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3144"><a href="#cb28-3144" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3145"><a href="#cb28-3145" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3146"><a href="#cb28-3146" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3147"><a href="#cb28-3147" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3148"><a href="#cb28-3148" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3149"><a href="#cb28-3149" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3150"><a href="#cb28-3150" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3151"><a href="#cb28-3151" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3152"><a href="#cb28-3152" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3153"><a href="#cb28-3153" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3154"><a href="#cb28-3154" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3155"><a href="#cb28-3155" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3156"><a href="#cb28-3156" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3157"><a href="#cb28-3157" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3158"><a href="#cb28-3158" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3159"><a href="#cb28-3159" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3160"><a href="#cb28-3160" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3161"><a href="#cb28-3161" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3162"><a href="#cb28-3162" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3163"><a href="#cb28-3163" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3164"><a href="#cb28-3164" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2xPred[1,1]"</span>,</span>
<span id="cb28-3165"><a href="#cb28-3165" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2xPred[2,1]"</span>,</span>
<span id="cb28-3166"><a href="#cb28-3166" aria-hidden="true" tabindex="-1"></a>                <span class="st">".draw"</span>,<span class="st">".iteration"</span>,<span class="st">".chain"</span>))]</span>
<span id="cb28-3167"><a href="#cb28-3167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3168"><a href="#cb28-3168" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-3169"><a href="#cb28-3169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3170"><a href="#cb28-3170" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwxPred[, c, r], S1xPred[, m, c, r], S2xPred[m, ]) <span class="sc">%&gt;%</span></span>
<span id="cb28-3171"><a href="#cb28-3171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">&lt;=</span>R[idx_analyte]<span class="sc">+</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3172"><a href="#cb28-3172" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">fi =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.05</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3173"><a href="#cb28-3173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logkPred =</span> logkwxPred<span class="sc">-</span>S1xPred<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>S2xPred)<span class="sc">*</span>fi<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>S2xPred<span class="sc">*</span>fi)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3174"><a href="#cb28-3174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.draw,c,r,m,logkPred,fi) <span class="sc">%&gt;%</span></span>
<span id="cb28-3175"><a href="#cb28-3175" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> c, <span class="at">values_from =</span> logkPred) <span class="sc">%&gt;%</span></span>
<span id="cb28-3176"><a href="#cb28-3176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdk2 =</span> <span class="st">`</span><span class="at">2</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">1</span><span class="st">`</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb28-3177"><a href="#cb28-3177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdk3 =</span> <span class="st">`</span><span class="at">3</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">1</span><span class="st">`</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb28-3178"><a href="#cb28-3178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdk4 =</span> <span class="st">`</span><span class="at">4</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">1</span><span class="st">`</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb28-3179"><a href="#cb28-3179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cdk5 =</span> <span class="st">`</span><span class="at">5</span><span class="st">`</span><span class="sc">-</span><span class="st">`</span><span class="at">1</span><span class="st">`</span> ) <span class="sc">%&gt;%</span></span>
<span id="cb28-3180"><a href="#cb28-3180" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(cdk2<span class="sc">:</span>cdk5,<span class="at">names_to =</span> <span class="st">"names_cdk"</span>, <span class="at">values_to =</span> <span class="st">"cdk"</span>)<span class="sc">%&gt;%</span></span>
<span id="cb28-3181"><a href="#cb28-3181" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fi, <span class="at">y =</span> cdk, <span class="at">color =</span> <span class="fu">as.factor</span>(names_cdk), <span class="at">fill =</span> <span class="fu">as.factor</span>(names_cdk))) <span class="sc">+</span></span>
<span id="cb28-3182"><a href="#cb28-3182" aria-hidden="true" tabindex="-1"></a>   ggdist<span class="sc">::</span><span class="fu">stat_lineribbon</span>(<span class="at">.width =</span> <span class="fu">c</span>(.<span class="dv">90</span>), <span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb28-3183"><a href="#cb28-3183" aria-hidden="true" tabindex="-1"></a>   <span class="fu">facet_wrap</span>(m<span class="sc">~</span>r, <span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">m=</span>mod.labs,<span class="at">r=</span>diss.labs))<span class="sc">+</span></span>
<span id="cb28-3184"><a href="#cb28-3184" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Between column difference in logk (population)"</span>, <span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]),<span class="at">color=</span> <span class="st">" "</span>,<span class="at">fill=</span> <span class="st">" "</span>, <span class="at">x=</span><span class="st">"\u03C6"</span>)<span class="sc">+</span></span>
<span id="cb28-3185"><a href="#cb28-3185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)) <span class="sc">+</span></span>
<span id="cb28-3186"><a href="#cb28-3186" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>))<span class="sc">+</span></span>
<span id="cb28-3187"><a href="#cb28-3187" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_hline</span>(<span class="at">yintercept=</span> <span class="fu">c</span>(<span class="dv">0</span>), <span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">color=</span><span class="st">"gray"</span>) <span class="sc">+</span></span>
<span id="cb28-3188"><a href="#cb28-3188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb28-3189"><a href="#cb28-3189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3190"><a href="#cb28-3190" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">izoparam</span><span class="sc">\\</span><span class="st">diff</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".population"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3191"><a href="#cb28-3191" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb28-3192"><a href="#cb28-3192" aria-hidden="true" tabindex="-1"></a> <span class="fu">print</span>(p)</span>
<span id="cb28-3193"><a href="#cb28-3193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3194"><a href="#cb28-3194" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3195"><a href="#cb28-3195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3196"><a href="#cb28-3196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3197"><a href="#cb28-3197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3198"><a href="#cb28-3198" aria-hidden="true" tabindex="-1"></a>or predict the organic modifier content leading to logk of 1:</span>
<span id="cb28-3199"><a href="#cb28-3199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3200"><a href="#cb28-3200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r izo-logk1-population}</span></span>
<span id="cb28-3201"><a href="#cb28-3201" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-3202"><a href="#cb28-3202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3203"><a href="#cb28-3203" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-3204"><a href="#cb28-3204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3205"><a href="#cb28-3205" aria-hidden="true" tabindex="-1"></a>idx_analyte <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">unique</span>(data<span class="sc">$</span>METID)<span class="sc">==</span>analyte_ID_sample[i])</span>
<span id="cb28-3206"><a href="#cb28-3206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3207"><a href="#cb28-3207" aria-hidden="true" tabindex="-1"></a>draws_df_subset <span class="ot">&lt;-</span> draws_epred_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_epred_df) <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb28-3208"><a href="#cb28-3208" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3209"><a href="#cb28-3209" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3210"><a href="#cb28-3210" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3211"><a href="#cb28-3211" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3212"><a href="#cb28-3212" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3213"><a href="#cb28-3213" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3214"><a href="#cb28-3214" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3215"><a href="#cb28-3215" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3216"><a href="#cb28-3216" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3217"><a href="#cb28-3217" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3218"><a href="#cb28-3218" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3219"><a href="#cb28-3219" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3220"><a href="#cb28-3220" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3221"><a href="#cb28-3221" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3222"><a href="#cb28-3222" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3223"><a href="#cb28-3223" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3224"><a href="#cb28-3224" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3225"><a href="#cb28-3225" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3226"><a href="#cb28-3226" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3227"><a href="#cb28-3227" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3228"><a href="#cb28-3228" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3229"><a href="#cb28-3229" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3230"><a href="#cb28-3230" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3231"><a href="#cb28-3231" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3232"><a href="#cb28-3232" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3233"><a href="#cb28-3233" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3234"><a href="#cb28-3234" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3235"><a href="#cb28-3235" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3236"><a href="#cb28-3236" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3237"><a href="#cb28-3237" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3238"><a href="#cb28-3238" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3239"><a href="#cb28-3239" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3240"><a href="#cb28-3240" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3241"><a href="#cb28-3241" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3242"><a href="#cb28-3242" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3243"><a href="#cb28-3243" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3244"><a href="#cb28-3244" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3245"><a href="#cb28-3245" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3246"><a href="#cb28-3246" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3247"><a href="#cb28-3247" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3248"><a href="#cb28-3248" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3249"><a href="#cb28-3249" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3250"><a href="#cb28-3250" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3251"><a href="#cb28-3251" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3252"><a href="#cb28-3252" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3253"><a href="#cb28-3253" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2xPred[1,1]"</span>,</span>
<span id="cb28-3254"><a href="#cb28-3254" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2xPred[2,1]"</span>,</span>
<span id="cb28-3255"><a href="#cb28-3255" aria-hidden="true" tabindex="-1"></a>                <span class="st">".draw"</span>,<span class="st">".iteration"</span>,<span class="st">".chain"</span>))]</span>
<span id="cb28-3256"><a href="#cb28-3256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3257"><a href="#cb28-3257" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-3258"><a href="#cb28-3258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3259"><a href="#cb28-3259" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwxPred[, c, r], S1xPred[, m, c, r], S2xPred[m, ]) <span class="sc">%&gt;%</span></span>
<span id="cb28-3260"><a href="#cb28-3260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(r<span class="sc">&lt;=</span>R[idx_analyte]<span class="sc">+</span><span class="dv">1</span>)  <span class="sc">%&gt;%</span></span>
<span id="cb28-3261"><a href="#cb28-3261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">foo =</span> (logkwxPred<span class="dv">-1</span>)<span class="sc">/</span>S1xPred<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>S2xPred)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3262"><a href="#cb28-3262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fix =</span> foo<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>S2xPred<span class="sc">*</span>foo)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3263"><a href="#cb28-3263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fix, <span class="at">color =</span> <span class="fu">as.factor</span>(c), <span class="at">fill =</span> <span class="fu">as.factor</span>(c))) <span class="sc">+</span></span>
<span id="cb28-3264"><a href="#cb28-3264" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb28-3265"><a href="#cb28-3265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb28-3266"><a href="#cb28-3266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(m<span class="sc">~</span>r, <span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">m=</span>mod.labs,<span class="at">r=</span>diss.labs))<span class="sc">+</span></span>
<span id="cb28-3267"><a href="#cb28-3267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]),<span class="at">color=</span> <span class="st">" "</span>,<span class="at">fill=</span> <span class="st">" "</span>, <span class="at">x =</span> <span class="st">"\u03C6 leading to logk=1 (population)"</span>)<span class="sc">+</span></span>
<span id="cb28-3268"><a href="#cb28-3268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)) <span class="sc">+</span></span>
<span id="cb28-3269"><a href="#cb28-3269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>))<span class="sc">+</span></span>
<span id="cb28-3270"><a href="#cb28-3270" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(m<span class="sc">~</span>r, <span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">m=</span>mod.labs,<span class="at">r=</span>diss.labs))</span>
<span id="cb28-3271"><a href="#cb28-3271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3272"><a href="#cb28-3272" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">izoparam</span><span class="sc">\\</span><span class="st">filogk1</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".population"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3273"><a href="#cb28-3273" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb28-3274"><a href="#cb28-3274" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-3275"><a href="#cb28-3275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3276"><a href="#cb28-3276" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3277"><a href="#cb28-3277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3278"><a href="#cb28-3278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3279"><a href="#cb28-3279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3280"><a href="#cb28-3280" aria-hidden="true" tabindex="-1"></a><span class="fu"># Effect of logP</span></span>
<span id="cb28-3281"><a href="#cb28-3281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3282"><a href="#cb28-3282" aria-hidden="true" tabindex="-1"></a>The following plot show the effect of log P on isocratic retention times (population predictions) for typical neutral, basic and acidic analyte. The uncertainties are large. They are not shown to improve visibility.</span>
<span id="cb28-3283"><a href="#cb28-3283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3284"><a href="#cb28-3284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logPgq, eval = FALSE}</span></span>
<span id="cb28-3285"><a href="#cb28-3285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3286"><a href="#cb28-3286" aria-hidden="true" tabindex="-1"></a>model_logP <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-logP.stan"</span>)</span>
<span id="cb28-3287"><a href="#cb28-3287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3288"><a href="#cb28-3288" aria-hidden="true" tabindex="-1"></a>fit_logP  <span class="ot">&lt;-</span> model_logP<span class="sc">$</span><span class="fu">generate_quantities</span>(fitsim,</span>
<span id="cb28-3289"><a href="#cb28-3289" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data =</span> datastruct,</span>
<span id="cb28-3290"><a href="#cb28-3290" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb28-3291"><a href="#cb28-3291" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-3292"><a href="#cb28-3292" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>)</span>
<span id="cb28-3293"><a href="#cb28-3293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3294"><a href="#cb28-3294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3295"><a href="#cb28-3295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-logP}</span></span>
<span id="cb28-3296"><a href="#cb28-3296" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">read_cmdstan_csv</span>(<span class="fu">c</span>(</span>
<span id="cb28-3297"><a href="#cb28-3297" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-logP-202308240954-1-6e86d7.csv'</span></span>
<span id="cb28-3298"><a href="#cb28-3298" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-3299"><a href="#cb28-3299" aria-hidden="true" tabindex="-1"></a>draws_logP_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span>generated_quantities)</span>
<span id="cb28-3300"><a href="#cb28-3300" aria-hidden="true" tabindex="-1"></a><span class="co"># draws_epred_df &lt;- fit_epred$draws(format = "df")</span></span>
<span id="cb28-3301"><a href="#cb28-3301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3302"><a href="#cb28-3302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3303"><a href="#cb28-3303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3304"><a href="#cb28-3304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-logP-effects}</span></span>
<span id="cb28-3305"><a href="#cb28-3305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3306"><a href="#cb28-3306" aria-hidden="true" tabindex="-1"></a>logPsim <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>,<span class="dv">3</span>,<span class="fl">4.5</span>,<span class="dv">6</span>)</span>
<span id="cb28-3307"><a href="#cb28-3307" aria-hidden="true" tabindex="-1"></a>col.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)</span>
<span id="cb28-3308"><a href="#cb28-3308" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(col.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'3'</span>,<span class="st">'4'</span>,<span class="st">'5'</span>)</span>
<span id="cb28-3309"><a href="#cb28-3309" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb28-3310"><a href="#cb28-3310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3311"><a href="#cb28-3311" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb28-3312"><a href="#cb28-3312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3313"><a href="#cb28-3313" aria-hidden="true" tabindex="-1"></a>idx_analyte <span class="ot">=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)[i]</span>
<span id="cb28-3314"><a href="#cb28-3314" aria-hidden="true" tabindex="-1"></a>mydata[[i]]<span class="ot">&lt;-</span> draws_logP_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_logP_df) <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb28-3315"><a href="#cb28-3315" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3316"><a href="#cb28-3316" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3317"><a href="#cb28-3317" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3318"><a href="#cb28-3318" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3319"><a href="#cb28-3319" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3320"><a href="#cb28-3320" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3321"><a href="#cb28-3321" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3322"><a href="#cb28-3322" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3323"><a href="#cb28-3323" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3324"><a href="#cb28-3324" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3325"><a href="#cb28-3325" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3326"><a href="#cb28-3326" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3327"><a href="#cb28-3327" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3328"><a href="#cb28-3328" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3329"><a href="#cb28-3329" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"logkwxPred[%s,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3330"><a href="#cb28-3330" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3331"><a href="#cb28-3331" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3332"><a href="#cb28-3332" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3333"><a href="#cb28-3333" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,1]"</span>,idx_analyte),</span>
<span id="cb28-3334"><a href="#cb28-3334" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,2]"</span>,idx_analyte),</span>
<span id="cb28-3335"><a href="#cb28-3335" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,1,3]"</span>,idx_analyte),</span>
<span id="cb28-3336"><a href="#cb28-3336" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3337"><a href="#cb28-3337" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3338"><a href="#cb28-3338" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3339"><a href="#cb28-3339" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,1]"</span>,idx_analyte),</span>
<span id="cb28-3340"><a href="#cb28-3340" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,2]"</span>,idx_analyte),</span>
<span id="cb28-3341"><a href="#cb28-3341" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,2,3]"</span>,idx_analyte),</span>
<span id="cb28-3342"><a href="#cb28-3342" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3343"><a href="#cb28-3343" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3344"><a href="#cb28-3344" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3345"><a href="#cb28-3345" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,1]"</span>,idx_analyte),</span>
<span id="cb28-3346"><a href="#cb28-3346" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,2]"</span>,idx_analyte),</span>
<span id="cb28-3347"><a href="#cb28-3347" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,3,3]"</span>,idx_analyte),</span>
<span id="cb28-3348"><a href="#cb28-3348" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3349"><a href="#cb28-3349" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3350"><a href="#cb28-3350" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3351"><a href="#cb28-3351" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,1]"</span>,idx_analyte),</span>
<span id="cb28-3352"><a href="#cb28-3352" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,2]"</span>,idx_analyte),</span>
<span id="cb28-3353"><a href="#cb28-3353" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,4,3]"</span>,idx_analyte),</span>
<span id="cb28-3354"><a href="#cb28-3354" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3355"><a href="#cb28-3355" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3356"><a href="#cb28-3356" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,1,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3357"><a href="#cb28-3357" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,1]"</span>,idx_analyte),</span>
<span id="cb28-3358"><a href="#cb28-3358" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,2]"</span>,idx_analyte),</span>
<span id="cb28-3359"><a href="#cb28-3359" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sprintf</span>(<span class="st">"S1xPred[%s,2,5,3]"</span>,idx_analyte),</span>
<span id="cb28-3360"><a href="#cb28-3360" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2xPred[1,1]"</span>,</span>
<span id="cb28-3361"><a href="#cb28-3361" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2xPred[2,1]"</span>,</span>
<span id="cb28-3362"><a href="#cb28-3362" aria-hidden="true" tabindex="-1"></a>                <span class="st">".draw"</span>,<span class="st">".iteration"</span>,<span class="st">".chain"</span>))]</span>
<span id="cb28-3363"><a href="#cb28-3363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3364"><a href="#cb28-3364" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3365"><a href="#cb28-3365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3366"><a href="#cb28-3366" aria-hidden="true" tabindex="-1"></a>draws_df_subset<span class="ot">&lt;-</span><span class="fu">cbind</span>(mydata[[<span class="dv">1</span>]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">45</span>],mydata[[<span class="dv">2</span>]][,<span class="dv">1</span><span class="sc">:</span><span class="dv">45</span>],mydata[[<span class="dv">3</span>]])</span>
<span id="cb28-3367"><a href="#cb28-3367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3368"><a href="#cb28-3368" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span>draws_df_subset <span class="sc">%&gt;%</span></span>
<span id="cb28-3369"><a href="#cb28-3369" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3370"><a href="#cb28-3370" aria-hidden="true" tabindex="-1"></a>  tidybayes<span class="sc">::</span><span class="fu">spread_draws</span>(logkwxPred[p, c, r], S1xPred[p, m, c, r], S2xPred[m, ]) <span class="sc">%&gt;%</span></span>
<span id="cb28-3371"><a href="#cb28-3371" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">fi =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3372"><a href="#cb28-3372" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">logkPred =</span> logkwxPred<span class="sc">-</span>S1xPred<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>S2xPred)<span class="sc">*</span>fi<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>S2xPred<span class="sc">*</span>fi)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3373"><a href="#cb28-3373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-3374"><a href="#cb28-3374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(p,m,c,r,fi) <span class="sc">%&gt;%</span></span>
<span id="cb28-3375"><a href="#cb28-3375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mlogkPred=</span><span class="fu">median</span>(logkPred)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3376"><a href="#cb28-3376" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fi, <span class="at">y =</span> mlogkPred, <span class="at">color =</span> <span class="fu">as.factor</span>(r), <span class="at">fill =</span> <span class="fu">as.factor</span>(r), <span class="at">linetype =</span> <span class="fu">as.factor</span>(p))) <span class="sc">+</span></span>
<span id="cb28-3377"><a href="#cb28-3377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb28-3378"><a href="#cb28-3378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(c<span class="sc">~</span>m,<span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">c=</span>col.labs, <span class="at">m=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3379"><a href="#cb28-3379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span> <span class="st">"Type"</span>, <span class="at">linetype=</span> <span class="st">"logP"</span>, <span class="at">y=</span><span class="st">"typical logk"</span>,<span class="at">x=</span><span class="st">"\u03C6"</span>)<span class="sc">+</span></span>
<span id="cb28-3380"><a href="#cb28-3380" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"N"</span>, <span class="st">"A"</span>)) <span class="sc">+</span></span>
<span id="cb28-3381"><a href="#cb28-3381" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"N"</span>, <span class="st">"A"</span>))<span class="sc">+</span></span>
<span id="cb28-3382"><a href="#cb28-3382" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"N"</span>,<span class="st">"A"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#619CFF"</span>, <span class="st">"black"</span>,<span class="st">"#F8766D"</span>))<span class="sc">+</span></span>
<span id="cb28-3383"><a href="#cb28-3383" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"0"</span>, <span class="st">"3"</span>, <span class="st">"6"</span>), <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"dotted"</span>,<span class="st">"solid"</span>, <span class="st">"dashed"</span>)) <span class="sc">+</span></span>
<span id="cb28-3384"><a href="#cb28-3384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>),<span class="at">strip.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">6</span>))<span class="sc">+</span></span>
<span id="cb28-3385"><a href="#cb28-3385" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb28-3386"><a href="#cb28-3386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3387"><a href="#cb28-3387" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-3388"><a href="#cb28-3388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3389"><a href="#cb28-3389" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">logPeffects</span><span class="sc">\\</span><span class="st">logPjoined"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3390"><a href="#cb28-3390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3391"><a href="#cb28-3391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3392"><a href="#cb28-3392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3393"><a href="#cb28-3393" aria-hidden="true" tabindex="-1"></a><span class="fu"># Goodness of fit plots</span></span>
<span id="cb28-3394"><a href="#cb28-3394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3395"><a href="#cb28-3395" aria-hidden="true" tabindex="-1"></a>Several goodness of fit plots were used to describe how well the model fits our set of observations.</span>
<span id="cb28-3396"><a href="#cb28-3396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3397"><a href="#cb28-3397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r residualsqq, eval = FALSE}</span></span>
<span id="cb28-3398"><a href="#cb28-3398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3399"><a href="#cb28-3399" aria-hidden="true" tabindex="-1"></a>model_restr <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-residuals.stan"</span>)</span>
<span id="cb28-3400"><a href="#cb28-3400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3401"><a href="#cb28-3401" aria-hidden="true" tabindex="-1"></a>fit_restr  <span class="ot">&lt;-</span> model_restr<span class="sc">$</span><span class="fu">generate_quantities</span>(fitsim,</span>
<span id="cb28-3402"><a href="#cb28-3402" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data =</span> datastruct,</span>
<span id="cb28-3403"><a href="#cb28-3403" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb28-3404"><a href="#cb28-3404" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-3405"><a href="#cb28-3405" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>)</span>
<span id="cb28-3406"><a href="#cb28-3406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3407"><a href="#cb28-3407" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3408"><a href="#cb28-3408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3409"><a href="#cb28-3409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r residuals-load}</span></span>
<span id="cb28-3410"><a href="#cb28-3410" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">read_cmdstan_csv</span>(<span class="fu">c</span>(</span>
<span id="cb28-3411"><a href="#cb28-3411" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-residuals-202308240959-1-8d8bd3.csv'</span></span>
<span id="cb28-3412"><a href="#cb28-3412" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-3413"><a href="#cb28-3413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3414"><a href="#cb28-3414" aria-hidden="true" tabindex="-1"></a>draws_restr_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span>generated_quantities)</span>
<span id="cb28-3415"><a href="#cb28-3415" aria-hidden="true" tabindex="-1"></a><span class="co"># draws_restr_df &lt;- fit_restr$draws(format = "df")</span></span>
<span id="cb28-3416"><a href="#cb28-3416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3417"><a href="#cb28-3417" aria-hidden="true" tabindex="-1"></a>trCond <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_restr_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_restr_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^trHatCond"</span>, <span class="fu">names</span>(draws_restr_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-3418"><a href="#cb28-3418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3419"><a href="#cb28-3419" aria-hidden="true" tabindex="-1"></a>trPred <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_restr_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_restr_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^trHatPred"</span>, <span class="fu">names</span>(draws_restr_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-3420"><a href="#cb28-3420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3421"><a href="#cb28-3421" aria-hidden="true" tabindex="-1"></a>restrCond <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_restr_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_restr_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^restrCond"</span>, <span class="fu">names</span>(draws_restr_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-3422"><a href="#cb28-3422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3423"><a href="#cb28-3423" aria-hidden="true" tabindex="-1"></a>restrPred <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_restr_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_restr_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^restrPred"</span>, <span class="fu">names</span>(draws_restr_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-3424"><a href="#cb28-3424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3425"><a href="#cb28-3425" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>trCond <span class="ot">=</span> trCond</span>
<span id="cb28-3426"><a href="#cb28-3426" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>trPred <span class="ot">=</span> trPred</span>
<span id="cb28-3427"><a href="#cb28-3427" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>restrCond <span class="ot">=</span> restrCond</span>
<span id="cb28-3428"><a href="#cb28-3428" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>restrPred <span class="ot">=</span> restrPred</span>
<span id="cb28-3429"><a href="#cb28-3429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3430"><a href="#cb28-3430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3431"><a href="#cb28-3431" aria-hidden="true" tabindex="-1"></a>Residuals:</span>
<span id="cb28-3432"><a href="#cb28-3432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3433"><a href="#cb28-3433" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-residuals}</span></span>
<span id="cb28-3434"><a href="#cb28-3434" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3435"><a href="#cb28-3435" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_jitter</span>(<span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> restrCond, <span class="at">color =</span> <span class="fu">as.factor</span>(tg), <span class="at">shape=</span><span class="fu">as.factor</span>(ColumnName)),<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">height =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb28-3436"><a href="#cb28-3436" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3437"><a href="#cb28-3437" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>, <span class="at">y =</span> <span class="st">"Individual residuals, min"</span>, <span class="at">color =</span> <span class="st">"Gradient time, min"</span>, <span class="at">shape =</span> <span class="st">'Column'</span>)<span class="sc">+</span></span>
<span id="cb28-3438"><a href="#cb28-3438" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>)</span>
<span id="cb28-3439"><a href="#cb28-3439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3440"><a href="#cb28-3440" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">concordanceplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"residuals"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3441"><a href="#cb28-3441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3442"><a href="#cb28-3442" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-3443"><a href="#cb28-3443" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3444"><a href="#cb28-3444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3445"><a href="#cb28-3445" aria-hidden="true" tabindex="-1"></a>Observed vs. population and individual predictions:</span>
<span id="cb28-3446"><a href="#cb28-3446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3447"><a href="#cb28-3447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-dv-vs-pred}</span></span>
<span id="cb28-3448"><a href="#cb28-3448" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3449"><a href="#cb28-3449" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x =</span> trCond, <span class="at">y =</span> RT, <span class="at">color =</span> <span class="fu">as.factor</span>(tg), <span class="at">shape=</span><span class="fu">as.factor</span>(ColumnName)))<span class="sc">+</span></span>
<span id="cb28-3450"><a href="#cb28-3450" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3451"><a href="#cb28-3451" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">y =</span><span class="st">"Observed Retention Time, min"</span>,</span>
<span id="cb28-3452"><a href="#cb28-3452" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Individual predicted retention time, min"</span>,</span>
<span id="cb28-3453"><a href="#cb28-3453" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-3454"><a href="#cb28-3454" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="st">'Column'</span>)<span class="sc">+</span></span>
<span id="cb28-3455"><a href="#cb28-3455" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">300</span>) <span class="sc">+</span></span>
<span id="cb28-3456"><a href="#cb28-3456" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">300</span>) <span class="sc">+</span></span>
<span id="cb28-3457"><a href="#cb28-3457" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>)</span>
<span id="cb28-3458"><a href="#cb28-3458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3459"><a href="#cb28-3459" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3460"><a href="#cb28-3460" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">data=</span>data, <span class="fu">aes</span>(<span class="at">x =</span> trPred, <span class="at">y =</span> RT, <span class="at">color =</span> <span class="fu">as.factor</span>(tg), <span class="at">shape=</span><span class="fu">as.factor</span>(ColumnName)))<span class="sc">+</span></span>
<span id="cb28-3461"><a href="#cb28-3461" aria-hidden="true" tabindex="-1"></a>      <span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3462"><a href="#cb28-3462" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">y =</span><span class="st">"Observed retention time, min"</span>,</span>
<span id="cb28-3463"><a href="#cb28-3463" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="st">"Population predicted retention time, min"</span>,</span>
<span id="cb28-3464"><a href="#cb28-3464" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-3465"><a href="#cb28-3465" aria-hidden="true" tabindex="-1"></a>           <span class="at">shape =</span> <span class="st">'Column'</span>)<span class="sc">+</span></span>
<span id="cb28-3466"><a href="#cb28-3466" aria-hidden="true" tabindex="-1"></a>      <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">300</span>) <span class="sc">+</span></span>
<span id="cb28-3467"><a href="#cb28-3467" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">300</span>) <span class="sc">+</span></span>
<span id="cb28-3468"><a href="#cb28-3468" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>)</span>
<span id="cb28-3469"><a href="#cb28-3469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3470"><a href="#cb28-3470" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">concordanceplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"individual"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3471"><a href="#cb28-3471" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">concordanceplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"population"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p2, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3472"><a href="#cb28-3472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3473"><a href="#cb28-3473" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-3474"><a href="#cb28-3474" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb28-3475"><a href="#cb28-3475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3476"><a href="#cb28-3476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3477"><a href="#cb28-3477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3478"><a href="#cb28-3478" aria-hidden="true" tabindex="-1"></a><span class="fu"># Predictions and decision making. Case Study 1</span></span>
<span id="cb28-3479"><a href="#cb28-3479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3480"><a href="#cb28-3480" aria-hidden="true" tabindex="-1"></a>Here we want to show applicability of the model to predicting the best chromatogram using all the available data.</span>
<span id="cb28-3481"><a href="#cb28-3481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3482"><a href="#cb28-3482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy1-fitdata, eval = FALSE}</span></span>
<span id="cb28-3483"><a href="#cb28-3483" aria-hidden="true" tabindex="-1"></a>fit_red1<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">as_cmdstan_fit</span>(<span class="fu">c</span>(</span>
<span id="cb28-3484"><a href="#cb28-3484" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># 'stanfiles/output_1.csv',</span></span>
<span id="cb28-3485"><a href="#cb28-3485" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># 'stanfiles/output_2.csv',</span></span>
<span id="cb28-3486"><a href="#cb28-3486" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># 'stanfiles/output_3.csv',</span></span>
<span id="cb28-3487"><a href="#cb28-3487" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># 'stanfiles/output_4.csv',</span></span>
<span id="cb28-3488"><a href="#cb28-3488" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_5.csv'</span>,</span>
<span id="cb28-3489"><a href="#cb28-3489" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_6.csv'</span>,</span>
<span id="cb28-3490"><a href="#cb28-3490" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_7.csv'</span>,</span>
<span id="cb28-3491"><a href="#cb28-3491" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/output_8.csv'</span></span>
<span id="cb28-3492"><a href="#cb28-3492" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-3493"><a href="#cb28-3493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3494"><a href="#cb28-3494" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3495"><a href="#cb28-3495" aria-hidden="true" tabindex="-1"></a><span class="fu">## Utility maps</span></span>
<span id="cb28-3496"><a href="#cb28-3496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3497"><a href="#cb28-3497" aria-hidden="true" tabindex="-1"></a>Let's find the best chromatogram that maximize utility using the set of experiments used to build the model.</span>
<span id="cb28-3498"><a href="#cb28-3498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3499"><a href="#cb28-3499" aria-hidden="true" tabindex="-1"></a>The utility function is based on lowest retention time, highest retention time and the difference of retention times between the critical pair of analytes. This utility is zero if at least one of the analyte has retention higher that 40, less than 2 min or the difference in retention time is less than 2. Otherwise, it favors shorter runs. (.) denotes design variables.</span>
<span id="cb28-3500"><a href="#cb28-3500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3501"><a href="#cb28-3501" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-3502"><a href="#cb28-3502" aria-hidden="true" tabindex="-1"></a>U(.)= I((mintr(.)&gt;2) \ <span class="sc">\&amp;</span> \ (res(.)&gt;2)) \cdot (40-maxtr(.)) \cdot I(maxtr(.)&lt;40)</span>
<span id="cb28-3503"><a href="#cb28-3503" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-3504"><a href="#cb28-3504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3505"><a href="#cb28-3505" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-3506"><a href="#cb28-3506" aria-hidden="true" tabindex="-1"></a> I(x) = 1 \ if \ condition \ x  \ is \ true <span class="sc">\\</span></span>
<span id="cb28-3507"><a href="#cb28-3507" aria-hidden="true" tabindex="-1"></a> I(x) = 0 \ if \ condition \ x  \ is \ false</span>
<span id="cb28-3508"><a href="#cb28-3508" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb28-3509"><a href="#cb28-3509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3510"><a href="#cb28-3510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy1-preparedatasim}</span></span>
<span id="cb28-3511"><a href="#cb28-3511" aria-hidden="true" tabindex="-1"></a>upH <span class="ot">&lt;-</span> datasim <span class="sc">%&gt;%</span></span>
<span id="cb28-3512"><a href="#cb28-3512" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3513"><a href="#cb28-3513" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Temp,Mod, pHo, alpha1, alpha2) <span class="sc">%&gt;%</span></span>
<span id="cb28-3514"><a href="#cb28-3514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Temp,Mod) <span class="sc">%&gt;%</span></span>
<span id="cb28-3515"><a href="#cb28-3515" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">complete</span>(<span class="at">pHo =</span> <span class="fu">seq</span>(<span class="fu">min</span>(pHo), <span class="fu">max</span>(pHo), <span class="at">len =</span> <span class="dv">17</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3516"><a href="#cb28-3516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Temp,Mod,pHo) <span class="sc">%&gt;%</span></span>
<span id="cb28-3517"><a href="#cb28-3517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha1 =</span> zoo<span class="sc">::</span><span class="fu">na.approx</span>(alpha1,pHo)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3518"><a href="#cb28-3518" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha2 =</span> zoo<span class="sc">::</span><span class="fu">na.approx</span>(alpha2,pHo)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3519"><a href="#cb28-3519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Temp,Mod) <span class="sc">%&gt;%</span></span>
<span id="cb28-3520"><a href="#cb28-3520" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pHid =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-3521"><a href="#cb28-3521" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pHid)  <span class="sc">%&gt;%</span></span>
<span id="cb28-3522"><a href="#cb28-3522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pHs =</span> <span class="fu">round</span>(<span class="fu">mean</span>(pHo),<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-3523"><a href="#cb28-3523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb28-3524"><a href="#cb28-3524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3525"><a href="#cb28-3525" aria-hidden="true" tabindex="-1"></a>datasim2 <span class="ot">&lt;-</span> datasim <span class="sc">%&gt;%</span></span>
<span id="cb28-3526"><a href="#cb28-3526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3527"><a href="#cb28-3527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tg<span class="sc">==</span><span class="dv">30</span>, Temp<span class="sc">==</span><span class="dv">25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3528"><a href="#cb28-3528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>tg, <span class="sc">-</span>fio, <span class="sc">-</span>expid, <span class="sc">-</span>pHs, <span class="sc">-</span>pHo, <span class="sc">-</span>alpha1, <span class="sc">-</span>alpha2, <span class="sc">-</span>pH) <span class="sc">%&gt;%</span></span>
<span id="cb28-3529"><a href="#cb28-3529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-3530"><a href="#cb28-3530" aria-hidden="true" tabindex="-1"></a> tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">fio =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.2</span>,<span class="fl">0.05</span>),<span class="at">tg =</span> <span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">260</span>,<span class="dv">20</span>), <span class="at">pHs=</span><span class="fu">unique</span>(upH<span class="sc">$</span>pHs))<span class="sc">%&gt;%</span></span>
<span id="cb28-3531"><a href="#cb28-3531" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(upH, <span class="at">by =</span> <span class="fu">join_by</span>(pHs, Mod, Temp), <span class="at">relationship =</span> <span class="st">"many-to-one"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-3532"><a href="#cb28-3532" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tg, fio, Mod, Column, pHs) <span class="sc">%&gt;%</span></span>
<span id="cb28-3533"><a href="#cb28-3533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">expid =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-3534"><a href="#cb28-3534" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb28-3535"><a href="#cb28-3535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3536"><a href="#cb28-3536" aria-hidden="true" tabindex="-1"></a>datastructsim2 <span class="ot">&lt;-</span>datastruct</span>
<span id="cb28-3537"><a href="#cb28-3537" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>nObs<span class="ot">=</span><span class="fu">length</span>(datasim2<span class="sc">$</span>METID)</span>
<span id="cb28-3538"><a href="#cb28-3538" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>analyte<span class="ot">=</span><span class="fu">match</span>(datasim2<span class="sc">$</span>METID, <span class="fu">unique</span>(datasim2<span class="sc">$</span>METID))</span>
<span id="cb28-3539"><a href="#cb28-3539" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>modifier<span class="ot">=</span><span class="fu">match</span>(datasim2<span class="sc">$</span>Mod2, <span class="fu">sort</span>(<span class="fu">unique</span>(datasim2<span class="sc">$</span>Mod2)))</span>
<span id="cb28-3540"><a href="#cb28-3540" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>steps<span class="ot">=</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">-</span>datasim2<span class="sc">$</span>Mod2) <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>(datasim2<span class="sc">$</span>Mod2<span class="dv">-1</span>)</span>
<span id="cb28-3541"><a href="#cb28-3541" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>column<span class="ot">=</span><span class="fu">match</span>(datasim2<span class="sc">$</span>Column, <span class="fu">unique</span>(datasim2<span class="sc">$</span>Column))</span>
<span id="cb28-3542"><a href="#cb28-3542" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>hplcparam<span class="ot">=</span><span class="fu">cbind</span>(datasim2<span class="sc">$</span>tg,datasim2<span class="sc">$</span>td,datasim2<span class="sc">$</span>to,datasim2<span class="sc">$</span>te,</span>
<span id="cb28-3543"><a href="#cb28-3543" aria-hidden="true" tabindex="-1"></a>                              datasim2<span class="sc">$</span>fio,datasim2<span class="sc">$</span>fik,datasim2<span class="sc">$</span>Mod2<span class="dv">-1</span>,datasim2<span class="sc">$</span>pHo,</span>
<span id="cb28-3544"><a href="#cb28-3544" aria-hidden="true" tabindex="-1"></a>                              datasim2<span class="sc">$</span>alpha1,datasim2<span class="sc">$</span>alpha2,(datasim2<span class="sc">$</span>Temp<span class="dv">-25</span>)<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb28-3545"><a href="#cb28-3545" aria-hidden="true" tabindex="-1"></a>                              datasim2<span class="sc">$</span>Column<span class="dv">-1</span>)</span>
<span id="cb28-3546"><a href="#cb28-3546" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,datastructsim2<span class="sc">$</span>nObs)</span>
<span id="cb28-3547"><a href="#cb28-3547" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">=</span>  <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-3548"><a href="#cb28-3548" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim2<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample)</span>
<span id="cb28-3549"><a href="#cb28-3549" aria-hidden="true" tabindex="-1"></a>datasim_red <span class="ot">=</span> datasim2[idx,]</span>
<span id="cb28-3550"><a href="#cb28-3550" aria-hidden="true" tabindex="-1"></a>datastructsim_red <span class="ot">&lt;-</span>datastructsim2</span>
<span id="cb28-3551"><a href="#cb28-3551" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nObs<span class="ot">=</span><span class="fu">length</span>(datastructsim_red<span class="sc">$</span>analyte[idx])</span>
<span id="cb28-3552"><a href="#cb28-3552" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>analyte<span class="ot">=</span>datastructsim_red<span class="sc">$</span>analyte[idx]</span>
<span id="cb28-3553"><a href="#cb28-3553" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>modifier<span class="ot">=</span>datastructsim_red<span class="sc">$</span>modifier[idx]</span>
<span id="cb28-3554"><a href="#cb28-3554" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>steps<span class="ot">=</span>datastructsim_red<span class="sc">$</span>steps[idx]</span>
<span id="cb28-3555"><a href="#cb28-3555" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>column<span class="ot">=</span>datastructsim_red<span class="sc">$</span>column[idx]</span>
<span id="cb28-3556"><a href="#cb28-3556" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>hplcparam<span class="ot">=</span>datastructsim_red<span class="sc">$</span>hplcparam[idx,]</span>
<span id="cb28-3557"><a href="#cb28-3557" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,datastructsim_red<span class="sc">$</span>nObs)</span>
<span id="cb28-3558"><a href="#cb28-3558" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nexpid<span class="ot">=</span><span class="fu">length</span>(<span class="fu">unique</span>(datasim_red<span class="sc">$</span>expid))</span>
<span id="cb28-3559"><a href="#cb28-3559" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>expid<span class="ot">=</span><span class="fu">match</span>(datasim_red<span class="sc">$</span>expid, <span class="fu">unique</span>(datasim_red<span class="sc">$</span>expid))</span>
<span id="cb28-3560"><a href="#cb28-3560" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nAnalytessim<span class="ot">=</span><span class="fu">length</span>(<span class="fu">unique</span>(datastructsim_red<span class="sc">$</span>analyte))</span>
<span id="cb28-3561"><a href="#cb28-3561" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>analytesim<span class="ot">=</span><span class="fu">match</span>(datastructsim_red<span class="sc">$</span>analyte, <span class="fu">unique</span>(datastructsim_red<span class="sc">$</span>analyte))</span>
<span id="cb28-3562"><a href="#cb28-3562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3563"><a href="#cb28-3563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3564"><a href="#cb28-3564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3565"><a href="#cb28-3565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy1-simgg, eval = FALSE}</span></span>
<span id="cb28-3566"><a href="#cb28-3566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3567"><a href="#cb28-3567" aria-hidden="true" tabindex="-1"></a>model_sim_red <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-fixed-sim.stan"</span>)</span>
<span id="cb28-3568"><a href="#cb28-3568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3569"><a href="#cb28-3569" aria-hidden="true" tabindex="-1"></a>fit_sim_red1  <span class="ot">&lt;-</span> model_sim_red<span class="sc">$</span><span class="fu">generate_quantities</span>(fit_red1,</span>
<span id="cb28-3570"><a href="#cb28-3570" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data =</span> datastructsim_red,</span>
<span id="cb28-3571"><a href="#cb28-3571" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb28-3572"><a href="#cb28-3572" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-3573"><a href="#cb28-3573" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>)</span>
<span id="cb28-3574"><a href="#cb28-3574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3575"><a href="#cb28-3575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3576"><a href="#cb28-3576" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy1-loaddata}</span></span>
<span id="cb28-3577"><a href="#cb28-3577" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">read_cmdstan_csv</span>(<span class="fu">c</span>(</span>
<span id="cb28-3578"><a href="#cb28-3578" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-sim-202308241032-1-261ea0.csv'</span></span>
<span id="cb28-3579"><a href="#cb28-3579" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-3580"><a href="#cb28-3580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3581"><a href="#cb28-3581" aria-hidden="true" tabindex="-1"></a>draws_sim_red_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span>generated_quantities)</span>
<span id="cb28-3582"><a href="#cb28-3582" aria-hidden="true" tabindex="-1"></a><span class="co">#draws_sim_red_df &lt;- fit_sim_red$draws(format = "df")</span></span>
<span id="cb28-3583"><a href="#cb28-3583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3584"><a href="#cb28-3584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3585"><a href="#cb28-3585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy1-utylitymaps-alldata}</span></span>
<span id="cb28-3586"><a href="#cb28-3586" aria-hidden="true" tabindex="-1"></a>foo<span class="ot">&lt;-</span>datasim_red[<span class="sc">!</span><span class="fu">duplicated</span>(datasim_red<span class="sc">$</span>expid),]</span>
<span id="cb28-3587"><a href="#cb28-3587" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^mindifftr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-3588"><a href="#cb28-3588" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^maxtr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-3589"><a href="#cb28-3589" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^mintr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-3590"><a href="#cb28-3590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3591"><a href="#cb28-3591" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span>x;</span>
<span id="cb28-3592"><a href="#cb28-3592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3593"><a href="#cb28-3593" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)){u[,i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x[,i]<span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span> z[,i] <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">40</span><span class="sc">-</span>y[,i]) <span class="sc">*</span> <span class="fu">as.numeric</span>(y[,i]<span class="sc">&lt;</span><span class="dv">40</span>)}</span>
<span id="cb28-3594"><a href="#cb28-3594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3595"><a href="#cb28-3595" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">apply</span>(u, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-3596"><a href="#cb28-3596" aria-hidden="true" tabindex="-1"></a>pr<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(pr)</span>
<span id="cb28-3597"><a href="#cb28-3597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3598"><a href="#cb28-3598" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>EUtility<span class="ot">=</span>pr<span class="sc">$</span>pr</span>
<span id="cb28-3599"><a href="#cb28-3599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3600"><a href="#cb28-3600" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-3601"><a href="#cb28-3601" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(x))</span>
<span id="cb28-3602"><a href="#cb28-3602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3603"><a href="#cb28-3603" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_l<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-3604"><a href="#cb28-3604" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_m<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-3605"><a href="#cb28-3605" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_h<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-3606"><a href="#cb28-3606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3607"><a href="#cb28-3607" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(y, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-3608"><a href="#cb28-3608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3609"><a href="#cb28-3609" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(y))</span>
<span id="cb28-3610"><a href="#cb28-3610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3611"><a href="#cb28-3611" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_l<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-3612"><a href="#cb28-3612" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_m<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-3613"><a href="#cb28-3613" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_h<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-3614"><a href="#cb28-3614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3615"><a href="#cb28-3615" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3616"><a href="#cb28-3616" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-3617"><a href="#cb28-3617" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3618"><a href="#cb28-3618" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-3619"><a href="#cb28-3619" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-3620"><a href="#cb28-3620" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-3621"><a href="#cb28-3621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3622"><a href="#cb28-3622" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3623"><a href="#cb28-3623" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">2</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-3624"><a href="#cb28-3624" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3625"><a href="#cb28-3625" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-3626"><a href="#cb28-3626" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-3627"><a href="#cb28-3627" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-3628"><a href="#cb28-3628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3629"><a href="#cb28-3629" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3630"><a href="#cb28-3630" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">3</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-3631"><a href="#cb28-3631" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3632"><a href="#cb28-3632" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-3633"><a href="#cb28-3633" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-3634"><a href="#cb28-3634" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-3635"><a href="#cb28-3635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3636"><a href="#cb28-3636" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3637"><a href="#cb28-3637" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">4</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-3638"><a href="#cb28-3638" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3639"><a href="#cb28-3639" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-3640"><a href="#cb28-3640" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-3641"><a href="#cb28-3641" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-3642"><a href="#cb28-3642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3643"><a href="#cb28-3643" aria-hidden="true" tabindex="-1"></a>p15 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-3644"><a href="#cb28-3644" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">5</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-3645"><a href="#cb28-3645" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-3646"><a href="#cb28-3646" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-3647"><a href="#cb28-3647" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-3648"><a href="#cb28-3648" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-3649"><a href="#cb28-3649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3650"><a href="#cb28-3650" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy1</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap1"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p11, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3651"><a href="#cb28-3651" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy1</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap2"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p12, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3652"><a href="#cb28-3652" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy1</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap3"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p13, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3653"><a href="#cb28-3653" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy1</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap4"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p14, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3654"><a href="#cb28-3654" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy1</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap5"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p15, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3655"><a href="#cb28-3655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3656"><a href="#cb28-3656" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p11)</span>
<span id="cb28-3657"><a href="#cb28-3657" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p12)</span>
<span id="cb28-3658"><a href="#cb28-3658" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p13)</span>
<span id="cb28-3659"><a href="#cb28-3659" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p14)</span>
<span id="cb28-3660"><a href="#cb28-3660" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p15)</span>
<span id="cb28-3661"><a href="#cb28-3661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3662"><a href="#cb28-3662" aria-hidden="true" tabindex="-1"></a> <span class="co"># The best for XBridge Shield RP18</span></span>
<span id="cb28-3663"><a href="#cb28-3663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3664"><a href="#cb28-3664" aria-hidden="true" tabindex="-1"></a> foo1<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> foo<span class="sc">$</span>pHo<span class="sc">&lt;</span><span class="dv">7</span>,];</span>
<span id="cb28-3665"><a href="#cb28-3665" aria-hidden="true" tabindex="-1"></a> foo1[<span class="fu">which</span>(foo1<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo1<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-3666"><a href="#cb28-3666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3667"><a href="#cb28-3667" aria-hidden="true" tabindex="-1"></a> <span class="co"># The best choice for XTerra MS C18</span></span>
<span id="cb28-3668"><a href="#cb28-3668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3669"><a href="#cb28-3669" aria-hidden="true" tabindex="-1"></a> foo2<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">2</span><span class="sc">&amp;</span> foo<span class="sc">$</span>pHo<span class="sc">&lt;</span><span class="dv">7</span>,];</span>
<span id="cb28-3670"><a href="#cb28-3670" aria-hidden="true" tabindex="-1"></a> foo2[<span class="fu">which</span>(foo2<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo2<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-3671"><a href="#cb28-3671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3672"><a href="#cb28-3672" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The best choice for XBridge Phenyl</span></span>
<span id="cb28-3673"><a href="#cb28-3673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3674"><a href="#cb28-3674" aria-hidden="true" tabindex="-1"></a> foo3<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">3</span><span class="sc">&amp;</span> foo<span class="sc">$</span>pHo<span class="sc">&lt;</span><span class="dv">7</span>,];</span>
<span id="cb28-3675"><a href="#cb28-3675" aria-hidden="true" tabindex="-1"></a> foo3[<span class="fu">which</span>(foo3<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo3<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-3676"><a href="#cb28-3676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3677"><a href="#cb28-3677" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The best choice for XBridge C8</span></span>
<span id="cb28-3678"><a href="#cb28-3678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3679"><a href="#cb28-3679" aria-hidden="true" tabindex="-1"></a> foo4<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">4</span><span class="sc">&amp;</span> foo<span class="sc">$</span>pHo<span class="sc">&lt;</span><span class="dv">7</span>,];</span>
<span id="cb28-3680"><a href="#cb28-3680" aria-hidden="true" tabindex="-1"></a> foo4[<span class="fu">which</span>(foo4<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo4<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-3681"><a href="#cb28-3681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3682"><a href="#cb28-3682" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The best choice for Xterra MS C8</span></span>
<span id="cb28-3683"><a href="#cb28-3683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3684"><a href="#cb28-3684" aria-hidden="true" tabindex="-1"></a> foo5<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">5</span><span class="sc">&amp;</span> foo<span class="sc">$</span>pHo<span class="sc">&lt;</span><span class="dv">7</span>,];</span>
<span id="cb28-3685"><a href="#cb28-3685" aria-hidden="true" tabindex="-1"></a> foo5[<span class="fu">which</span>(foo5<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo5<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-3686"><a href="#cb28-3686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3687"><a href="#cb28-3687" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3688"><a href="#cb28-3688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3689"><a href="#cb28-3689" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uncertainity chromatogram</span></span>
<span id="cb28-3690"><a href="#cb28-3690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3691"><a href="#cb28-3691" aria-hidden="true" tabindex="-1"></a>Let's visualize chromatograms with the highest expected utility</span>
<span id="cb28-3692"><a href="#cb28-3692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3693"><a href="#cb28-3693" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy1-uncertainity-chrom}</span></span>
<span id="cb28-3694"><a href="#cb28-3694" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-3695"><a href="#cb28-3695" aria-hidden="true" tabindex="-1"></a>col.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)</span>
<span id="cb28-3696"><a href="#cb28-3696" aria-hidden="true" tabindex="-1"></a>datasim_red<span class="sc">$</span>fio <span class="ot">=</span> <span class="fu">as.factor</span>(datasim_red<span class="sc">$</span>fio)</span>
<span id="cb28-3697"><a href="#cb28-3697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3698"><a href="#cb28-3698" aria-hidden="true" tabindex="-1"></a>wpCond<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb28-3699"><a href="#cb28-3699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3700"><a href="#cb28-3700" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb28-3701"><a href="#cb28-3701" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-3702"><a href="#cb28-3702" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">60</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-3703"><a href="#cb28-3703" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-3704"><a href="#cb28-3704" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.05</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-3705"><a href="#cb28-3705" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-3706"><a href="#cb28-3706" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-3707"><a href="#cb28-3707" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-3708"><a href="#cb28-3708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3709"><a href="#cb28-3709" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">3</span>){</span>
<span id="cb28-3710"><a href="#cb28-3710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3711"><a href="#cb28-3711" aria-hidden="true" tabindex="-1"></a> idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-3712"><a href="#cb28-3712" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">60</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-3713"><a href="#cb28-3713" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-3714"><a href="#cb28-3714" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.1</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-3715"><a href="#cb28-3715" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-3716"><a href="#cb28-3716" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-3717"><a href="#cb28-3717" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-3718"><a href="#cb28-3718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3719"><a href="#cb28-3719" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3720"><a href="#cb28-3720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3721"><a href="#cb28-3721" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">4</span>){</span>
<span id="cb28-3722"><a href="#cb28-3722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3723"><a href="#cb28-3723" aria-hidden="true" tabindex="-1"></a> idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-3724"><a href="#cb28-3724" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">80</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-3725"><a href="#cb28-3725" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-3726"><a href="#cb28-3726" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.05</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-3727"><a href="#cb28-3727" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-3728"><a href="#cb28-3728" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-3729"><a href="#cb28-3729" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-3730"><a href="#cb28-3730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3731"><a href="#cb28-3731" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3732"><a href="#cb28-3732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3733"><a href="#cb28-3733" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">5</span>){</span>
<span id="cb28-3734"><a href="#cb28-3734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3735"><a href="#cb28-3735" aria-hidden="true" tabindex="-1"></a> idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-3736"><a href="#cb28-3736" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">80</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-3737"><a href="#cb28-3737" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-3738"><a href="#cb28-3738" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.1</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-3739"><a href="#cb28-3739" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-3740"><a href="#cb28-3740" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-3741"><a href="#cb28-3741" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-3742"><a href="#cb28-3742" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3743"><a href="#cb28-3743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3744"><a href="#cb28-3744" aria-hidden="true" tabindex="-1"></a>data_to_plot <span class="ot">&lt;-</span> draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"trHatCond["</span>,idx,<span class="st">"]"</span>))]</span>
<span id="cb28-3745"><a href="#cb28-3745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3746"><a href="#cb28-3746" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample])</span>
<span id="cb28-3747"><a href="#cb28-3747" aria-hidden="true" tabindex="-1"></a>wpCond1 <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_to_plot)</span>
<span id="cb28-3748"><a href="#cb28-3748" aria-hidden="true" tabindex="-1"></a>wpCond1<span class="sc">$</span>Column <span class="ot">&lt;-</span> <span class="fu">unname</span>(col.labs[i])</span>
<span id="cb28-3749"><a href="#cb28-3749" aria-hidden="true" tabindex="-1"></a>wpCond<span class="ot">=</span> <span class="fu">rbind</span>(wpCond,wpCond1)</span>
<span id="cb28-3750"><a href="#cb28-3750" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3751"><a href="#cb28-3751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3752"><a href="#cb28-3752" aria-hidden="true" tabindex="-1"></a>wpCond<span class="sc">$</span>Column<span class="ot">=</span><span class="fu">as.factor</span>(wpCond<span class="sc">$</span>Column)</span>
<span id="cb28-3753"><a href="#cb28-3753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3754"><a href="#cb28-3754" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wpCond)<span class="sc">+</span></span>
<span id="cb28-3755"><a href="#cb28-3755" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">colour=</span>variable)) <span class="sc">+</span></span>
<span id="cb28-3756"><a href="#cb28-3756" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"uncertainty chromatogram (individual predictions)"</span>,</span>
<span id="cb28-3757"><a href="#cb28-3757" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span><span class="st">"Retention time, min"</span>,</span>
<span id="cb28-3758"><a href="#cb28-3758" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"pdf"</span>,</span>
<span id="cb28-3759"><a href="#cb28-3759" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"Analyte"</span></span>
<span id="cb28-3760"><a href="#cb28-3760" aria-hidden="true" tabindex="-1"></a>          )<span class="sc">+</span></span>
<span id="cb28-3761"><a href="#cb28-3761" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb28-3762"><a href="#cb28-3762" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Column, <span class="at">nrow=</span><span class="dv">3</span>,<span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb28-3763"><a href="#cb28-3763" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb28-3764"><a href="#cb28-3764" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb28-3765"><a href="#cb28-3765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3766"><a href="#cb28-3766" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-3767"><a href="#cb28-3767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3768"><a href="#cb28-3768" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy1</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"chromatogram"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-3769"><a href="#cb28-3769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3770"><a href="#cb28-3770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3771"><a href="#cb28-3771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3772"><a href="#cb28-3772" aria-hidden="true" tabindex="-1"></a><span class="fu"># Predictions and decision making. Case 2</span></span>
<span id="cb28-3773"><a href="#cb28-3773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3774"><a href="#cb28-3774" aria-hidden="true" tabindex="-1"></a>The proposed model can be used for decision making having access to limiet data. Here we want to ilustrate this by predicting XTerra MS C18, XBridge Phenyl, XBridge C8, Xterra MS C8 retention times based on XBridge Shield RP18 data.</span>
<span id="cb28-3775"><a href="#cb28-3775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3776"><a href="#cb28-3776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-standata}</span></span>
<span id="cb28-3777"><a href="#cb28-3777" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-3778"><a href="#cb28-3778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3779"><a href="#cb28-3779" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(data<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-3780"><a href="#cb28-3780" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>tg <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">90</span>, <span class="dv">270</span>) <span class="sc">&amp;</span></span>
<span id="cb28-3781"><a href="#cb28-3781" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>pH <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">&amp;</span></span>
<span id="cb28-3782"><a href="#cb28-3782" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>Column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>) <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-3783"><a href="#cb28-3783" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>Mod2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">&amp;</span></span>
<span id="cb28-3784"><a href="#cb28-3784" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>Temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">35</span>))</span>
<span id="cb28-3785"><a href="#cb28-3785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3786"><a href="#cb28-3786" aria-hidden="true" tabindex="-1"></a>datastruct_red <span class="ot">=</span> datastruct;</span>
<span id="cb28-3787"><a href="#cb28-3787" aria-hidden="true" tabindex="-1"></a>datastruct_red<span class="sc">$</span>idx <span class="ot">=</span> idx</span>
<span id="cb28-3788"><a href="#cb28-3788" aria-hidden="true" tabindex="-1"></a>datastruct_red<span class="sc">$</span>nObs2 <span class="ot">=</span> <span class="fu">length</span>(datastruct_red<span class="sc">$</span>idx)</span>
<span id="cb28-3789"><a href="#cb28-3789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3790"><a href="#cb28-3790" aria-hidden="true" tabindex="-1"></a>init_red <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb28-3791"><a href="#cb28-3791" aria-hidden="true" tabindex="-1"></a><span class="fu">list</span>(<span class="at">logkwHat=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">3.60</span>,<span class="fl">0.0793</span>),</span>
<span id="cb28-3792"><a href="#cb28-3792" aria-hidden="true" tabindex="-1"></a><span class="at">S1mHat=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">4.96</span>,<span class="fl">0.0832</span>),</span>
<span id="cb28-3793"><a href="#cb28-3793" aria-hidden="true" tabindex="-1"></a><span class="at">dS1Hat=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.612</span>,<span class="fl">0.0512</span>),</span>
<span id="cb28-3794"><a href="#cb28-3794" aria-hidden="true" tabindex="-1"></a><span class="at">dlogkwHat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.786</span>,<span class="fl">0.0718</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.970</span>,<span class="fl">0.0503</span>)),</span>
<span id="cb28-3795"><a href="#cb28-3795" aria-hidden="true" tabindex="-1"></a><span class="at">dS1mHat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.176</span>,<span class="fl">0.121</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.110</span>,<span class="fl">0.0744</span>)),</span>
<span id="cb28-3796"><a href="#cb28-3796" aria-hidden="true" tabindex="-1"></a><span class="at">ddS1Hat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.279</span>,<span class="fl">0.0865</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.651</span>,<span class="fl">0.0564</span>)),</span>
<span id="cb28-3797"><a href="#cb28-3797" aria-hidden="true" tabindex="-1"></a><span class="at">logS2mHat=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.308</span>,<span class="fl">0.0143</span>),</span>
<span id="cb28-3798"><a href="#cb28-3798" aria-hidden="true" tabindex="-1"></a><span class="at">dlogS2Hat=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.420</span>,<span class="fl">0.00760</span>),</span>
<span id="cb28-3799"><a href="#cb28-3799" aria-hidden="true" tabindex="-1"></a><span class="at">beta=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.831</span>,<span class="fl">0.0407</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.483</span>,<span class="fl">0.0449</span>)),</span>
<span id="cb28-3800"><a href="#cb28-3800" aria-hidden="true" tabindex="-1"></a><span class="at">alphamHat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">2.23</span>,<span class="fl">0.155</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">1.36</span>,<span class="fl">0.102</span>)),</span>
<span id="cb28-3801"><a href="#cb28-3801" aria-hidden="true" tabindex="-1"></a><span class="at">dalphaHat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.212</span>,<span class="fl">0.0981</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.188</span>,<span class="fl">0.0744</span>)),</span>
<span id="cb28-3802"><a href="#cb28-3802" aria-hidden="true" tabindex="-1"></a><span class="at">dlogkTHat=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0898</span>,<span class="fl">0.00292</span>),</span>
<span id="cb28-3803"><a href="#cb28-3803" aria-hidden="true" tabindex="-1"></a><span class="at">apH=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0275</span>,<span class="fl">0.00118</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0806</span>,<span class="fl">0.000800</span>)),</span>
<span id="cb28-3804"><a href="#cb28-3804" aria-hidden="true" tabindex="-1"></a><span class="at">omega=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.925</span>,<span class="fl">0.0549</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.941</span>,<span class="fl">0.0590</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.565</span>,<span class="fl">0.0343</span>)),</span>
<span id="cb28-3805"><a href="#cb28-3805" aria-hidden="true" tabindex="-1"></a><span class="at">omegaT=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0337</span>,<span class="fl">0.00212</span>),</span>
<span id="cb28-3806"><a href="#cb28-3806" aria-hidden="true" tabindex="-1"></a><span class="at">kappa=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.584</span>,<span class="fl">0.0350</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.694</span>,<span class="fl">0.0475</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.57</span>,<span class="fl">0.0378</span>)),</span>
<span id="cb28-3807"><a href="#cb28-3807" aria-hidden="true" tabindex="-1"></a><span class="at">msigma=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.386</span>,<span class="fl">0.0263</span>),</span>
<span id="cb28-3808"><a href="#cb28-3808" aria-hidden="true" tabindex="-1"></a><span class="at">ssigma=</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.813</span>,<span class="fl">0.0496</span>),</span>
<span id="cb28-3809"><a href="#cb28-3809" aria-hidden="true" tabindex="-1"></a><span class="at">tau=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.882</span>,<span class="fl">0.0494</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.958</span>,<span class="fl">0.0584</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.793</span>,<span class="fl">0.0506</span>)),</span>
<span id="cb28-3810"><a href="#cb28-3810" aria-hidden="true" tabindex="-1"></a><span class="at">rho =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.864</span>, <span class="fl">0.864</span>, <span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>),</span>
<span id="cb28-3811"><a href="#cb28-3811" aria-hidden="true" tabindex="-1"></a><span class="at">clogkwHat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.424</span>,<span class="fl">0.0115</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.173</span>,<span class="fl">0.0132</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.105</span>,<span class="fl">0.0118</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.166</span>,<span class="fl">0.0101</span>)),</span>
<span id="cb28-3812"><a href="#cb28-3812" aria-hidden="true" tabindex="-1"></a><span class="at">cS1mHat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.588</span>,<span class="fl">0.0198</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.122</span>,<span class="fl">0.0218</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.362</span>,<span class="fl">0.0180</span>), <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.479</span>,<span class="fl">0.0167</span>)),</span>
<span id="cb28-3813"><a href="#cb28-3813" aria-hidden="true" tabindex="-1"></a><span class="at">cdS1Hat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.151</span>,<span class="fl">0.0134</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.828</span>,<span class="fl">0.0278</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.552</span>,<span class="fl">0.0535</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0308</span>,<span class="fl">0.0157</span>)),</span>
<span id="cb28-3814"><a href="#cb28-3814" aria-hidden="true" tabindex="-1"></a><span class="at">cdlogkTHat=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.00595</span>,<span class="fl">0.00125</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0208</span>,<span class="fl">0.00160</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.00605</span>,<span class="fl">0.00105</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.00302</span>,<span class="fl">0.00104</span>)),</span>
<span id="cb28-3815"><a href="#cb28-3815" aria-hidden="true" tabindex="-1"></a><span class="at">cdlogkwHat =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0412</span>,<span class="fl">0.0154</span>),</span>
<span id="cb28-3816"><a href="#cb28-3816" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0515</span>,<span class="fl">0.0208</span>),</span>
<span id="cb28-3817"><a href="#cb28-3817" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0321</span>,<span class="fl">0.0167</span>),</span>
<span id="cb28-3818"><a href="#cb28-3818" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0426</span>,<span class="fl">0.0164</span>),</span>
<span id="cb28-3819"><a href="#cb28-3819" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.00532</span>,<span class="fl">0.0135</span>),</span>
<span id="cb28-3820"><a href="#cb28-3820" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0312</span>,<span class="fl">0.0154</span>),</span>
<span id="cb28-3821"><a href="#cb28-3821" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0578</span>,<span class="fl">0.0127</span>),</span>
<span id="cb28-3822"><a href="#cb28-3822" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0205</span>,<span class="fl">0.0137</span>)),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-3823"><a href="#cb28-3823" aria-hidden="true" tabindex="-1"></a><span class="at">cdS1mHat=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0240</span>,<span class="fl">0.0454</span>),</span>
<span id="cb28-3824"><a href="#cb28-3824" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.202</span>,<span class="fl">0.0633</span>),</span>
<span id="cb28-3825"><a href="#cb28-3825" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.501</span>,<span class="fl">0.0471</span>),</span>
<span id="cb28-3826"><a href="#cb28-3826" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.218</span>,<span class="fl">0.0439</span>),</span>
<span id="cb28-3827"><a href="#cb28-3827" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.375</span>,<span class="fl">0.0352</span>),</span>
<span id="cb28-3828"><a href="#cb28-3828" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.394</span>,<span class="fl">0.0392</span>),</span>
<span id="cb28-3829"><a href="#cb28-3829" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0862</span>,<span class="fl">0.0304</span>),</span>
<span id="cb28-3830"><a href="#cb28-3830" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.313</span>,<span class="fl">0.0333</span>)),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-3831"><a href="#cb28-3831" aria-hidden="true" tabindex="-1"></a><span class="at">cddS1Hat=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0505</span>,<span class="fl">0.0269</span>),</span>
<span id="cb28-3832"><a href="#cb28-3832" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.134</span>,<span class="fl">0.0531</span>),</span>
<span id="cb28-3833"><a href="#cb28-3833" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.457</span>,<span class="fl">0.111</span>),</span>
<span id="cb28-3834"><a href="#cb28-3834" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.00183</span>,<span class="fl">0.0252</span>),</span>
<span id="cb28-3835"><a href="#cb28-3835" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.170</span>,<span class="fl">0.0154</span>),</span>
<span id="cb28-3836"><a href="#cb28-3836" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.573</span>,<span class="fl">0.033</span>),</span>
<span id="cb28-3837"><a href="#cb28-3837" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.504</span>,<span class="fl">0.0743</span>),</span>
<span id="cb28-3838"><a href="#cb28-3838" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0301</span>,<span class="fl">0.0157</span>)),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-3839"><a href="#cb28-3839" aria-hidden="true" tabindex="-1"></a><span class="at">cbeta=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.00719</span>,<span class="fl">0.0064</span>),</span>
<span id="cb28-3840"><a href="#cb28-3840" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.00576</span>,<span class="fl">0.00755</span>),</span>
<span id="cb28-3841"><a href="#cb28-3841" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0241</span>,<span class="fl">0.00768</span>),</span>
<span id="cb28-3842"><a href="#cb28-3842" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0102</span>,<span class="fl">0.00588</span>),</span>
<span id="cb28-3843"><a href="#cb28-3843" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0664</span>,<span class="fl">0.0109</span>),</span>
<span id="cb28-3844"><a href="#cb28-3844" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.113</span>,<span class="fl">0.0126</span>),</span>
<span id="cb28-3845"><a href="#cb28-3845" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0198</span>,<span class="fl">0.0111</span>),</span>
<span id="cb28-3846"><a href="#cb28-3846" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.00871</span>,<span class="fl">0.00984</span>)),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-3847"><a href="#cb28-3847" aria-hidden="true" tabindex="-1"></a><span class="at">capH=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0149</span>,<span class="fl">0.00157</span>),</span>
<span id="cb28-3848"><a href="#cb28-3848" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0219</span>,<span class="fl">0.00169</span>),</span>
<span id="cb28-3849"><a href="#cb28-3849" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.00482</span>,<span class="fl">0.00148</span>),</span>
<span id="cb28-3850"><a href="#cb28-3850" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0226</span>,<span class="fl">0.00146</span>),</span>
<span id="cb28-3851"><a href="#cb28-3851" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0336</span>,<span class="fl">0.00118</span>),</span>
<span id="cb28-3852"><a href="#cb28-3852" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0440</span>,<span class="fl">0.00106</span>),</span>
<span id="cb28-3853"><a href="#cb28-3853" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0506</span>,<span class="fl">0.000901</span>),</span>
<span id="cb28-3854"><a href="#cb28-3854" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0130</span>,<span class="fl">0.00103</span>)),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>)),</span>
<span id="cb28-3855"><a href="#cb28-3855" aria-hidden="true" tabindex="-1"></a><span class="at">comega=</span> <span class="fu">abs</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.107</span>,<span class="fl">0.00778</span>),</span>
<span id="cb28-3856"><a href="#cb28-3856" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.129</span>,<span class="fl">0.00891</span>),</span>
<span id="cb28-3857"><a href="#cb28-3857" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.114</span>,<span class="fl">0.00751</span>),</span>
<span id="cb28-3858"><a href="#cb28-3858" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0966</span>,<span class="fl">0.00638</span>),</span>
<span id="cb28-3859"><a href="#cb28-3859" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0971</span>,<span class="fl">0.0196</span>),</span>
<span id="cb28-3860"><a href="#cb28-3860" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.146</span>,<span class="fl">0.017</span>),</span>
<span id="cb28-3861"><a href="#cb28-3861" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0901</span>,<span class="fl">0.0156</span>),</span>
<span id="cb28-3862"><a href="#cb28-3862" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0713</span>,<span class="fl">0.0189</span>),</span>
<span id="cb28-3863"><a href="#cb28-3863" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.141</span>,<span class="fl">0.011</span>),</span>
<span id="cb28-3864"><a href="#cb28-3864" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.309</span>,<span class="fl">0.0205</span>),</span>
<span id="cb28-3865"><a href="#cb28-3865" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.608</span>,<span class="fl">0.0403</span>),</span>
<span id="cb28-3866"><a href="#cb28-3866" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.172</span>,<span class="fl">0.0123</span>)),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>))),</span>
<span id="cb28-3867"><a href="#cb28-3867" aria-hidden="true" tabindex="-1"></a><span class="at">ckappa=</span> <span class="fu">abs</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0688</span>,<span class="fl">0.00622</span>),</span>
<span id="cb28-3868"><a href="#cb28-3868" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.116</span>,<span class="fl">0.00872</span>),</span>
<span id="cb28-3869"><a href="#cb28-3869" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0855</span>,<span class="fl">0.00668</span>),</span>
<span id="cb28-3870"><a href="#cb28-3870" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0873</span>,<span class="fl">0.00625</span>),</span>
<span id="cb28-3871"><a href="#cb28-3871" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0714</span>,<span class="fl">0.0362</span>),</span>
<span id="cb28-3872"><a href="#cb28-3872" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.199</span>,<span class="fl">0.0311</span>),</span>
<span id="cb28-3873"><a href="#cb28-3873" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0932</span>,<span class="fl">0.0322</span>),</span>
<span id="cb28-3874"><a href="#cb28-3874" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0334</span>,<span class="fl">0.0252</span>),</span>
<span id="cb28-3875"><a href="#cb28-3875" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0738</span>,<span class="fl">0.0197</span>),</span>
<span id="cb28-3876"><a href="#cb28-3876" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.277</span>,<span class="fl">0.0253</span>),</span>
<span id="cb28-3877"><a href="#cb28-3877" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.717</span>,<span class="fl">0.0502</span>),</span>
<span id="cb28-3878"><a href="#cb28-3878" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0861</span>,<span class="fl">0.0164</span>)),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>))),</span>
<span id="cb28-3879"><a href="#cb28-3879" aria-hidden="true" tabindex="-1"></a><span class="at">corr_L =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.568</span>,<span class="fl">0.781</span>,<span class="fl">0.719</span>,<span class="dv">0</span>,<span class="fl">0.819</span>,<span class="fl">0.129</span>,<span class="fl">0.176</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.604</span>,<span class="fl">0.541</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.384</span>), <span class="at">nrow=</span><span class="dv">4</span>),</span>
<span id="cb28-3880"><a href="#cb28-3880" aria-hidden="true" tabindex="-1"></a><span class="at">comegaT=</span><span class="fu">abs</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.00230</span>,<span class="fl">0.00159</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0115</span>,<span class="fl">0.00123</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.00179</span>,<span class="fl">0.00116</span>),<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.00114</span>,<span class="fl">0.000878</span>))),</span>
<span id="cb28-3881"><a href="#cb28-3881" aria-hidden="true" tabindex="-1"></a>          <span class="at">paramN =</span>  <span class="fu">cbind</span>(<span class="dv">2</span><span class="fl">+0.75</span><span class="sc">*</span>(logPobs<span class="fl">-2.2</span>), <span class="dv">4</span><span class="sc">*</span><span class="fu">matrix</span>(<span class="dv">1</span>,nAnalytes,<span class="dv">1</span>)<span class="sc">+</span><span class="fl">0.5</span><span class="sc">*</span>(logPobs<span class="fl">-2.2</span>)),</span>
<span id="cb28-3882"><a href="#cb28-3882" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1N   =</span>  <span class="fu">matrix</span>(<span class="dv">0</span>,nAnalytes,<span class="dv">1</span>),</span>
<span id="cb28-3883"><a href="#cb28-3883" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogkT =</span> <span class="fu">rnorm</span>(nAnalytes,<span class="sc">-</span><span class="fl">0.0868</span>,<span class="fl">0.0217</span>),</span>
<span id="cb28-3884"><a href="#cb28-3884" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogkwA =</span> <span class="fu">matrix</span>(<span class="sc">-</span><span class="dv">1</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-3885"><a href="#cb28-3885" aria-hidden="true" tabindex="-1"></a>          <span class="at">dlogkwB =</span> <span class="fu">matrix</span>(<span class="sc">-</span><span class="dv">1</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-3886"><a href="#cb28-3886" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1mA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-3887"><a href="#cb28-3887" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1mB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-3888"><a href="#cb28-3888" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1A =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-3889"><a href="#cb28-3889" aria-hidden="true" tabindex="-1"></a>          <span class="at">dS1B =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-3890"><a href="#cb28-3890" aria-hidden="true" tabindex="-1"></a>          <span class="at">clogkwN =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nAnalytes),</span>
<span id="cb28-3891"><a href="#cb28-3891" aria-hidden="true" tabindex="-1"></a>          <span class="at">cS1mN =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nAnalytes),</span>
<span id="cb28-3892"><a href="#cb28-3892" aria-hidden="true" tabindex="-1"></a>          <span class="at">cdS1N =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nAnalytes),</span>
<span id="cb28-3893"><a href="#cb28-3893" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdlogkT =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nAnalytes),</span>
<span id="cb28-3894"><a href="#cb28-3894" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdlogkwA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsA),</span>
<span id="cb28-3895"><a href="#cb28-3895" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdlogkwB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsB),</span>
<span id="cb28-3896"><a href="#cb28-3896" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1mA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsA),</span>
<span id="cb28-3897"><a href="#cb28-3897" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1mB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsB),</span>
<span id="cb28-3898"><a href="#cb28-3898" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1A =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>,nGroupsA),</span>
<span id="cb28-3899"><a href="#cb28-3899" aria-hidden="true" tabindex="-1"></a>          <span class="at">etacdS1B =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nColumns<span class="dv">-1</span>, nGroupsB),</span>
<span id="cb28-3900"><a href="#cb28-3900" aria-hidden="true" tabindex="-1"></a>          <span class="at">pKawA =</span> pKaslitA,</span>
<span id="cb28-3901"><a href="#cb28-3901" aria-hidden="true" tabindex="-1"></a>          <span class="at">pKawB =</span> pKaslitB,</span>
<span id="cb28-3902"><a href="#cb28-3902" aria-hidden="true" tabindex="-1"></a>          <span class="at">etaalphamA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-3903"><a href="#cb28-3903" aria-hidden="true" tabindex="-1"></a>          <span class="at">etaalphamB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-3904"><a href="#cb28-3904" aria-hidden="true" tabindex="-1"></a>          <span class="at">etadalphaA =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsA,<span class="dv">1</span>),</span>
<span id="cb28-3905"><a href="#cb28-3905" aria-hidden="true" tabindex="-1"></a>          <span class="at">etadalphaB =</span> <span class="fu">matrix</span>(<span class="dv">0</span>,nGroupsB,<span class="dv">1</span>),</span>
<span id="cb28-3906"><a href="#cb28-3906" aria-hidden="true" tabindex="-1"></a><span class="at">logsigma   =</span> <span class="fu">rnorm</span>(nAnalytes,<span class="fu">log</span>(<span class="fl">0.386</span>),<span class="fl">0.813</span>),</span>
<span id="cb28-3907"><a href="#cb28-3907" aria-hidden="true" tabindex="-1"></a><span class="at">clogmsigma=</span><span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.0170</span>),</span>
<span id="cb28-3908"><a href="#cb28-3908" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.0170</span>,<span class="fl">0.0207</span>),</span>
<span id="cb28-3909"><a href="#cb28-3909" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.260</span>,<span class="fl">0.0205</span>),</span>
<span id="cb28-3910"><a href="#cb28-3910" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.100</span>,<span class="fl">0.0170</span>)),</span>
<span id="cb28-3911"><a href="#cb28-3911" aria-hidden="true" tabindex="-1"></a><span class="at">cssigma=</span><span class="fu">abs</span>(<span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0927</span>,<span class="fl">0.0236</span>),</span>
<span id="cb28-3912"><a href="#cb28-3912" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.169</span>,<span class="fl">0.0200</span>),</span>
<span id="cb28-3913"><a href="#cb28-3913" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.161</span>,<span class="fl">0.019</span>),</span>
<span id="cb28-3914"><a href="#cb28-3914" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="fl">0.0854</span>,<span class="fl">0.0245</span>))),</span>
<span id="cb28-3915"><a href="#cb28-3915" aria-hidden="true" tabindex="-1"></a><span class="at">etaclogsigma   =</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(nAnalytes<span class="sc">*</span>(nColumns<span class="dv">-1</span>),<span class="dv">0</span>,<span class="fl">0.125</span>),<span class="at">nrow=</span>(nColumns<span class="dv">-1</span>))</span>
<span id="cb28-3916"><a href="#cb28-3916" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-3917"><a href="#cb28-3917" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-3918"><a href="#cb28-3918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3919"><a href="#cb28-3919" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3920"><a href="#cb28-3920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3921"><a href="#cb28-3921" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-sampling, eval = FALSE}</span></span>
<span id="cb28-3922"><a href="#cb28-3922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3923"><a href="#cb28-3923" aria-hidden="true" tabindex="-1"></a>mod_fixed <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-fixed.stan"</span>,</span>
<span id="cb28-3924"><a href="#cb28-3924" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stanc_options =</span> <span class="fu">list</span>(<span class="st">"O1"</span>))</span>
<span id="cb28-3925"><a href="#cb28-3925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3926"><a href="#cb28-3926" aria-hidden="true" tabindex="-1"></a>fit_red <span class="ot">&lt;-</span> mod_fixed<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb28-3927"><a href="#cb28-3927" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> datastruct_red,</span>
<span id="cb28-3928"><a href="#cb28-3928" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>,</span>
<span id="cb28-3929"><a href="#cb28-3929" aria-hidden="true" tabindex="-1"></a>  <span class="at">init =</span> init_red,</span>
<span id="cb28-3930"><a href="#cb28-3930" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb28-3931"><a href="#cb28-3931" aria-hidden="true" tabindex="-1"></a>  <span class="at">iter_sampling =</span> <span class="dv">500</span>,</span>
<span id="cb28-3932"><a href="#cb28-3932" aria-hidden="true" tabindex="-1"></a>  <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-3933"><a href="#cb28-3933" aria-hidden="true" tabindex="-1"></a>  <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-3934"><a href="#cb28-3934" aria-hidden="true" tabindex="-1"></a>  <span class="at">refresh =</span> <span class="dv">100</span>,</span>
<span id="cb28-3935"><a href="#cb28-3935" aria-hidden="true" tabindex="-1"></a>  <span class="at">adapt_delta=</span><span class="fl">0.9</span></span>
<span id="cb28-3936"><a href="#cb28-3936" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-3937"><a href="#cb28-3937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3938"><a href="#cb28-3938" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3939"><a href="#cb28-3939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3940"><a href="#cb28-3940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-load-fitdata}</span></span>
<span id="cb28-3941"><a href="#cb28-3941" aria-hidden="true" tabindex="-1"></a>fit_red <span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">as_cmdstan_fit</span>(<span class="fu">c</span>(</span>
<span id="cb28-3942"><a href="#cb28-3942" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-202308241051-1-738454.csv'</span>,</span>
<span id="cb28-3943"><a href="#cb28-3943" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-202308241051-2-738454.csv'</span>,</span>
<span id="cb28-3944"><a href="#cb28-3944" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-202308241051-3-738454.csv'</span>,</span>
<span id="cb28-3945"><a href="#cb28-3945" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-202308241051-4-738454.csv'</span></span>
<span id="cb28-3946"><a href="#cb28-3946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3947"><a href="#cb28-3947" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-3948"><a href="#cb28-3948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3949"><a href="#cb28-3949" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3950"><a href="#cb28-3950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3951"><a href="#cb28-3951" aria-hidden="true" tabindex="-1"></a><span class="fu">## Summary of individual parameters</span></span>
<span id="cb28-3952"><a href="#cb28-3952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3953"><a href="#cb28-3953" aria-hidden="true" tabindex="-1"></a>Here shown for analyte 9 (<span class="in">`r dataNames$Name[9]`</span>)</span>
<span id="cb28-3954"><a href="#cb28-3954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3955"><a href="#cb28-3955" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-summary}</span></span>
<span id="cb28-3956"><a href="#cb28-3956" aria-hidden="true" tabindex="-1"></a><span class="co"># which(unique(data$METID)==9) - 3rd compound in stan</span></span>
<span id="cb28-3957"><a href="#cb28-3957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3958"><a href="#cb28-3958" aria-hidden="true" tabindex="-1"></a>fit_red<span class="sc">$</span><span class="fu">print</span>(<span class="fu">c</span>(<span class="st">"logkwx[3,1,1]"</span>, <span class="st">"logkwx[3,1,2]"</span>, <span class="st">"logkwx[3,1,3]"</span>,</span>
<span id="cb28-3959"><a href="#cb28-3959" aria-hidden="true" tabindex="-1"></a>                <span class="st">"logkwx[3,2,1]"</span>, <span class="st">"logkwx[3,2,2]"</span>, <span class="st">"logkwx[3,2,3]"</span>,</span>
<span id="cb28-3960"><a href="#cb28-3960" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S1x[3,1,1,1]"</span>, <span class="st">"S1x[3,1,1,2]"</span>, <span class="st">"S1x[3,1,1,3]"</span>,</span>
<span id="cb28-3961"><a href="#cb28-3961" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S1x[3,2,1,1]"</span>, <span class="st">"S1x[3,2,1,2]"</span>, <span class="st">"S1x[3,2,1,3]"</span>,</span>
<span id="cb28-3962"><a href="#cb28-3962" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S1x[3,1,2,1]"</span>, <span class="st">"S1x[3,1,2,2]"</span>, <span class="st">"S1x[3,1,2,3]"</span>,</span>
<span id="cb28-3963"><a href="#cb28-3963" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S1x[3,2,2,1]"</span>, <span class="st">"S1x[3,2,2,2]"</span>, <span class="st">"S1x[3,2,2,3]"</span>,</span>
<span id="cb28-3964"><a href="#cb28-3964" aria-hidden="true" tabindex="-1"></a>                <span class="st">"apHx[3,1,1]"</span>, <span class="st">"apHx[3,1,2]"</span>, <span class="st">"apHx[3,1,3]"</span>,</span>
<span id="cb28-3965"><a href="#cb28-3965" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pKawx[3,1]"</span>, <span class="st">"pKawx[3,2]"</span>,</span>
<span id="cb28-3966"><a href="#cb28-3966" aria-hidden="true" tabindex="-1"></a>                <span class="st">"alphax[3,1,1]"</span>, <span class="st">"alphax[3,1,2]"</span>,</span>
<span id="cb28-3967"><a href="#cb28-3967" aria-hidden="true" tabindex="-1"></a>                <span class="st">"alphax[3,2,1]"</span>, <span class="st">"alphax[3,2,2]"</span>,</span>
<span id="cb28-3968"><a href="#cb28-3968" aria-hidden="true" tabindex="-1"></a>                <span class="st">"S2x[1,1]"</span>, <span class="st">"S2x[2,1]"</span>,</span>
<span id="cb28-3969"><a href="#cb28-3969" aria-hidden="true" tabindex="-1"></a>                <span class="st">"sigmax[3,1]"</span>, <span class="st">"sigmax[3,2]"</span>), <span class="at">max_rows =</span> <span class="dv">31</span>)</span>
<span id="cb28-3970"><a href="#cb28-3970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3971"><a href="#cb28-3971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3972"><a href="#cb28-3972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3973"><a href="#cb28-3973" aria-hidden="true" tabindex="-1"></a><span class="fu">## Predicted retention times</span></span>
<span id="cb28-3974"><a href="#cb28-3974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3975"><a href="#cb28-3975" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  casestudy2-datasim}</span></span>
<span id="cb28-3976"><a href="#cb28-3976" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">=</span>  <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-3977"><a href="#cb28-3977" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample)</span>
<span id="cb28-3978"><a href="#cb28-3978" aria-hidden="true" tabindex="-1"></a>datasim_red <span class="ot">=</span> datasim[idx,<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb28-3979"><a href="#cb28-3979" aria-hidden="true" tabindex="-1"></a>datastructsim_red <span class="ot">&lt;-</span>datastructsim</span>
<span id="cb28-3980"><a href="#cb28-3980" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nObs<span class="ot">=</span><span class="fu">length</span>(datastructsim_red<span class="sc">$</span>analyte[idx])</span>
<span id="cb28-3981"><a href="#cb28-3981" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>analyte<span class="ot">=</span>datastructsim_red<span class="sc">$</span>analyte[idx]</span>
<span id="cb28-3982"><a href="#cb28-3982" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>modifier<span class="ot">=</span>datastructsim_red<span class="sc">$</span>modifier[idx]</span>
<span id="cb28-3983"><a href="#cb28-3983" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>steps<span class="ot">=</span>datastructsim_red<span class="sc">$</span>steps[idx]</span>
<span id="cb28-3984"><a href="#cb28-3984" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>column<span class="ot">=</span>datastructsim_red<span class="sc">$</span>column[idx]</span>
<span id="cb28-3985"><a href="#cb28-3985" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>hplcparam<span class="ot">=</span>datastructsim_red<span class="sc">$</span>hplcparam[idx,]</span>
<span id="cb28-3986"><a href="#cb28-3986" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,datastructsim_red<span class="sc">$</span>nObs)</span>
<span id="cb28-3987"><a href="#cb28-3987" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nexpid<span class="ot">=</span><span class="fu">length</span>(<span class="fu">unique</span>(datasim_red<span class="sc">$</span>expid))</span>
<span id="cb28-3988"><a href="#cb28-3988" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>expid<span class="ot">=</span><span class="fu">match</span>(datasim_red<span class="sc">$</span>expid, <span class="fu">unique</span>(datasim_red<span class="sc">$</span>expid))</span>
<span id="cb28-3989"><a href="#cb28-3989" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nAnalytessim<span class="ot">=</span><span class="fu">length</span>(<span class="fu">unique</span>(datastructsim_red<span class="sc">$</span>analyte))</span>
<span id="cb28-3990"><a href="#cb28-3990" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>analytesim<span class="ot">=</span><span class="fu">match</span>(datastructsim_red<span class="sc">$</span>analyte, <span class="fu">unique</span>(datastructsim_red<span class="sc">$</span>analyte))</span>
<span id="cb28-3991"><a href="#cb28-3991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3992"><a href="#cb28-3992" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-3993"><a href="#cb28-3993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3994"><a href="#cb28-3994" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-datasim-gq, eval = FALSE}</span></span>
<span id="cb28-3995"><a href="#cb28-3995" aria-hidden="true" tabindex="-1"></a>model_sim_red <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-fixed-sim.stan"</span>)</span>
<span id="cb28-3996"><a href="#cb28-3996" aria-hidden="true" tabindex="-1"></a>fit_sim_red  <span class="ot">&lt;-</span> model_sim_red<span class="sc">$</span><span class="fu">generate_quantities</span>(fit_red,</span>
<span id="cb28-3997"><a href="#cb28-3997" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data =</span> datastructsim_red,</span>
<span id="cb28-3998"><a href="#cb28-3998" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb28-3999"><a href="#cb28-3999" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-4000"><a href="#cb28-4000" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>)</span>
<span id="cb28-4001"><a href="#cb28-4001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4002"><a href="#cb28-4002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4003"><a href="#cb28-4003" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-datasim-dataload}</span></span>
<span id="cb28-4004"><a href="#cb28-4004" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">read_cmdstan_csv</span>(<span class="fu">c</span>(</span>
<span id="cb28-4005"><a href="#cb28-4005" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-sim-202308241208-1-66415a.csv'</span>,</span>
<span id="cb28-4006"><a href="#cb28-4006" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-sim-202308241208-2-66415a.csv'</span>,</span>
<span id="cb28-4007"><a href="#cb28-4007" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-sim-202308241208-3-66415a.csv'</span>,</span>
<span id="cb28-4008"><a href="#cb28-4008" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-sim-202308241208-4-66415a.csv'</span></span>
<span id="cb28-4009"><a href="#cb28-4009" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-4010"><a href="#cb28-4010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4011"><a href="#cb28-4011" aria-hidden="true" tabindex="-1"></a>draws_sim_red_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span>generated_quantities)</span>
<span id="cb28-4012"><a href="#cb28-4012" aria-hidden="true" tabindex="-1"></a><span class="co">#draws_sim_red_df &lt;- fit_sim_red$draws(format = "df")</span></span>
<span id="cb28-4013"><a href="#cb28-4013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4014"><a href="#cb28-4014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4015"><a href="#cb28-4015" aria-hidden="true" tabindex="-1"></a><span class="fu">### Plot the predicted vs. observed:</span></span>
<span id="cb28-4016"><a href="#cb28-4016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4017"><a href="#cb28-4017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-pred}</span></span>
<span id="cb28-4018"><a href="#cb28-4018" aria-hidden="true" tabindex="-1"></a>tr_sim_red_Cond <span class="ot">&lt;-</span> <span class="fu">apply</span>(draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^trCond"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))], <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-4019"><a href="#cb28-4019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4020"><a href="#cb28-4020" aria-hidden="true" tabindex="-1"></a>tr_sim_Cond<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(tr_sim_red_Cond))</span>
<span id="cb28-4021"><a href="#cb28-4021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4022"><a href="#cb28-4022" aria-hidden="true" tabindex="-1"></a>datasim_red<span class="sc">$</span>trCond_l<span class="ot">=</span>tr_sim_Cond<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-4023"><a href="#cb28-4023" aria-hidden="true" tabindex="-1"></a>datasim_red<span class="sc">$</span>trCond_m<span class="ot">=</span>tr_sim_Cond<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-4024"><a href="#cb28-4024" aria-hidden="true" tabindex="-1"></a>datasim_red<span class="sc">$</span>trCond_h<span class="ot">=</span>tr_sim_Cond<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-4025"><a href="#cb28-4025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4026"><a href="#cb28-4026" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(data<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-4027"><a href="#cb28-4027" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>tg <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">90</span>, <span class="dv">270</span>) <span class="sc">&amp;</span></span>
<span id="cb28-4028"><a href="#cb28-4028" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>pH <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">&amp;</span></span>
<span id="cb28-4029"><a href="#cb28-4029" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>Column <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>) <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-4030"><a href="#cb28-4030" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>Mod2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>) <span class="sc">&amp;</span></span>
<span id="cb28-4031"><a href="#cb28-4031" aria-hidden="true" tabindex="-1"></a>               data<span class="sc">$</span>Temp <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">35</span>))</span>
<span id="cb28-4032"><a href="#cb28-4032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4033"><a href="#cb28-4033" aria-hidden="true" tabindex="-1"></a>data_red <span class="ot">=</span> data[idx,]</span>
<span id="cb28-4034"><a href="#cb28-4034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4035"><a href="#cb28-4035" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(analyte_ID_sample)){</span>
<span id="cb28-4036"><a href="#cb28-4036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4037"><a href="#cb28-4037" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4038"><a href="#cb28-4038" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">data=</span>data[<span class="fu">which</span>(data<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),], <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> RT, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)), <span class="at">shape =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb28-4039"><a href="#cb28-4039" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">data=</span>data_red[<span class="fu">which</span>(data_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),], <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> RT, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-4040"><a href="#cb28-4040" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">data=</span>datasim_red[<span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),], <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> trCond_m, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-4041"><a href="#cb28-4041" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="at">data=</span>datasim_red[<span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample[i]),], <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">ymin =</span> trCond_l, <span class="at">ymax =</span> trCond_h, <span class="at">fill =</span> <span class="fu">as.factor</span>(tg)), <span class="at">alpha =</span> <span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb28-4042"><a href="#cb28-4042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">2</span>,<span class="dv">11</span>)<span class="sc">+</span></span>
<span id="cb28-4043"><a href="#cb28-4043" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4044"><a href="#cb28-4044" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="at">x =</span><span class="st">"pH"</span>, <span class="at">y =</span> <span class="st">"Retention time, min"</span>, <span class="at">color =</span> <span class="st">"tg, min"</span>, <span class="at">fill =</span> <span class="st">"tg, min"</span>)</span>
<span id="cb28-4045"><a href="#cb28-4045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4046"><a href="#cb28-4046" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">concordanceplots</span><span class="sc">\\</span><span class="st">"</span>, <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample[i]]), <span class="st">".png"</span>), <span class="at">plot=</span>pi, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4047"><a href="#cb28-4047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4048"><a href="#cb28-4048" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pi)</span>
<span id="cb28-4049"><a href="#cb28-4049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4050"><a href="#cb28-4050" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4051"><a href="#cb28-4051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4052"><a href="#cb28-4052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4053"><a href="#cb28-4053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4054"><a href="#cb28-4054" aria-hidden="true" tabindex="-1"></a><span class="fu">## Decision making</span></span>
<span id="cb28-4055"><a href="#cb28-4055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4056"><a href="#cb28-4056" aria-hidden="true" tabindex="-1"></a>The same utility function was used:</span>
<span id="cb28-4057"><a href="#cb28-4057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4058"><a href="#cb28-4058" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-utylitymaps}</span></span>
<span id="cb28-4059"><a href="#cb28-4059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4060"><a href="#cb28-4060" aria-hidden="true" tabindex="-1"></a>foo<span class="ot">&lt;-</span>datasim_red[<span class="sc">!</span><span class="fu">duplicated</span>(datasim_red<span class="sc">$</span>expid),]</span>
<span id="cb28-4061"><a href="#cb28-4061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4062"><a href="#cb28-4062" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^mindifftr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-4063"><a href="#cb28-4063" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^maxtr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-4064"><a href="#cb28-4064" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^mintr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-4065"><a href="#cb28-4065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4066"><a href="#cb28-4066" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span>x;</span>
<span id="cb28-4067"><a href="#cb28-4067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4068"><a href="#cb28-4068" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)){u[,i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x[,i]<span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span> z[,i] <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">40</span><span class="sc">-</span>y[,i]) <span class="sc">*</span> <span class="fu">as.numeric</span>(y[,i]<span class="sc">&lt;</span><span class="dv">40</span>)}</span>
<span id="cb28-4069"><a href="#cb28-4069" aria-hidden="true" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">apply</span>(u, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-4070"><a href="#cb28-4070" aria-hidden="true" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(u)</span>
<span id="cb28-4071"><a href="#cb28-4071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4072"><a href="#cb28-4072" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>EUtility<span class="ot">=</span>u<span class="sc">$</span>u</span>
<span id="cb28-4073"><a href="#cb28-4073" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-4074"><a href="#cb28-4074" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(x))</span>
<span id="cb28-4075"><a href="#cb28-4075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4076"><a href="#cb28-4076" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_l<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-4077"><a href="#cb28-4077" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_m<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-4078"><a href="#cb28-4078" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_h<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-4079"><a href="#cb28-4079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4080"><a href="#cb28-4080" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(y, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-4081"><a href="#cb28-4081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4082"><a href="#cb28-4082" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(y))</span>
<span id="cb28-4083"><a href="#cb28-4083" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_l<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-4084"><a href="#cb28-4084" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_m<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-4085"><a href="#cb28-4085" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_h<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-4086"><a href="#cb28-4086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4087"><a href="#cb28-4087" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4088"><a href="#cb28-4088" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">data=</span>foo, <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> EUtility, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-4089"><a href="#cb28-4089" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="dv">2</span>,<span class="dv">11</span>)<span class="sc">+</span></span>
<span id="cb28-4090"><a href="#cb28-4090" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4091"><a href="#cb28-4091" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-4092"><a href="#cb28-4092" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Expected Utility"</span>,</span>
<span id="cb28-4093"><a href="#cb28-4093" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"tg, min"</span>)</span>
<span id="cb28-4094"><a href="#cb28-4094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4095"><a href="#cb28-4095" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4096"><a href="#cb28-4096" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">data=</span>foo, <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> mindifftr_m, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-4097"><a href="#cb28-4097" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_ribbon</span>(<span class="at">data=</span>foo, <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">ymin =</span> mindifftr_l, <span class="at">ymax =</span> mindifftr_h, <span class="at">fill =</span> <span class="fu">as.factor</span>(tg)), <span class="at">alpha =</span> <span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb28-4098"><a href="#cb28-4098" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="dv">2</span>,<span class="dv">11</span>)<span class="sc">+</span></span>
<span id="cb28-4099"><a href="#cb28-4099" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4100"><a href="#cb28-4100" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-4101"><a href="#cb28-4101" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Resolution (difference), min"</span>,</span>
<span id="cb28-4102"><a href="#cb28-4102" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-4103"><a href="#cb28-4103" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"tg, min"</span>)</span>
<span id="cb28-4104"><a href="#cb28-4104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4105"><a href="#cb28-4105" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4106"><a href="#cb28-4106" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_line</span>(<span class="at">data=</span>foo, <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y =</span> maxtr_m, <span class="at">color =</span> <span class="fu">as.factor</span>(tg)))<span class="sc">+</span></span>
<span id="cb28-4107"><a href="#cb28-4107" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data=</span>foo, <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">ymin =</span> maxtr_l, <span class="at">ymax =</span> maxtr_h, <span class="at">fill =</span> <span class="fu">as.factor</span>(tg)), <span class="at">alpha =</span> <span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb28-4108"><a href="#cb28-4108" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="dv">2</span>,<span class="dv">11</span>)<span class="sc">+</span></span>
<span id="cb28-4109"><a href="#cb28-4109" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(ColumnName<span class="sc">~</span>Mod2<span class="sc">+</span>Temp, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Temp=</span>temp.labs,<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4110"><a href="#cb28-4110" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-4111"><a href="#cb28-4111" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"Maximal tR, min"</span>,</span>
<span id="cb28-4112"><a href="#cb28-4112" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-4113"><a href="#cb28-4113" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"tg, min"</span>)</span>
<span id="cb28-4114"><a href="#cb28-4114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4115"><a href="#cb28-4115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4116"><a href="#cb28-4116" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">decision</span><span class="sc">\\</span><span class="st">"</span>, <span class="st">"expectedutility"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p1, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4117"><a href="#cb28-4117" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">decision</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"resolution"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p2, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4118"><a href="#cb28-4118" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">decision</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"maxtr"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p3, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4119"><a href="#cb28-4119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4120"><a href="#cb28-4120" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p1)</span>
<span id="cb28-4121"><a href="#cb28-4121" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p2)</span>
<span id="cb28-4122"><a href="#cb28-4122" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p3)</span>
<span id="cb28-4123"><a href="#cb28-4123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4124"><a href="#cb28-4124" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"1. The best choice for XBridge Shield RP18"</span>)</span>
<span id="cb28-4125"><a href="#cb28-4125" aria-hidden="true" tabindex="-1"></a> foo1<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">1</span>,];</span>
<span id="cb28-4126"><a href="#cb28-4126" aria-hidden="true" tabindex="-1"></a> foo1[<span class="fu">which</span>(foo1<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo1<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pH'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4127"><a href="#cb28-4127" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"2. The best choice for XTerra MS C18"</span>)</span>
<span id="cb28-4128"><a href="#cb28-4128" aria-hidden="true" tabindex="-1"></a> foo2<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">2</span>,];</span>
<span id="cb28-4129"><a href="#cb28-4129" aria-hidden="true" tabindex="-1"></a> foo2[<span class="fu">which</span>(foo2<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo2<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pH'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4130"><a href="#cb28-4130" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"3. The best choice for XBridge Phenyl"</span>)</span>
<span id="cb28-4131"><a href="#cb28-4131" aria-hidden="true" tabindex="-1"></a> foo3<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">3</span>,];</span>
<span id="cb28-4132"><a href="#cb28-4132" aria-hidden="true" tabindex="-1"></a> foo3[<span class="fu">which</span>(foo3<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo3<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pH'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4133"><a href="#cb28-4133" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"4. The best choice for XBridge C8"</span>)</span>
<span id="cb28-4134"><a href="#cb28-4134" aria-hidden="true" tabindex="-1"></a> foo4<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">4</span>,];</span>
<span id="cb28-4135"><a href="#cb28-4135" aria-hidden="true" tabindex="-1"></a> foo4[<span class="fu">which</span>(foo4<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo4<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pH'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4136"><a href="#cb28-4136" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"5. The best choice for Xterra MS C8"</span>)</span>
<span id="cb28-4137"><a href="#cb28-4137" aria-hidden="true" tabindex="-1"></a> foo5<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">5</span>,];</span>
<span id="cb28-4138"><a href="#cb28-4138" aria-hidden="true" tabindex="-1"></a> foo5[<span class="fu">which</span>(foo5<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo5<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pH'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4139"><a href="#cb28-4139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4140"><a href="#cb28-4140" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb28-4141"><a href="#cb28-4141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4142"><a href="#cb28-4142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4143"><a href="#cb28-4143" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uncertainity chromatogram</span></span>
<span id="cb28-4144"><a href="#cb28-4144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4145"><a href="#cb28-4145" aria-hidden="true" tabindex="-1"></a>Below is the example of a chromatogram (along with uncertainty) expected for tg = 90 min, pH = 8.9, Temp = 25oC in ACN.</span>
<span id="cb28-4146"><a href="#cb28-4146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4147"><a href="#cb28-4147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r  casestudy2-uncertainity-chrom}</span></span>
<span id="cb28-4148"><a href="#cb28-4148" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-4149"><a href="#cb28-4149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4150"><a href="#cb28-4150" aria-hidden="true" tabindex="-1"></a>col.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)</span>
<span id="cb28-4151"><a href="#cb28-4151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4152"><a href="#cb28-4152" aria-hidden="true" tabindex="-1"></a>wpCond<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb28-4153"><a href="#cb28-4153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4154"><a href="#cb28-4154" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb28-4155"><a href="#cb28-4155" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-4156"><a href="#cb28-4156" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg<span class="sc">==</span><span class="dv">90</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-4157"><a href="#cb28-4157" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pH<span class="sc">==</span> <span class="dv">7</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-4158"><a href="#cb28-4158" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column<span class="sc">==</span>i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-4159"><a href="#cb28-4159" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2<span class="sc">==</span><span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-4160"><a href="#cb28-4160" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp<span class="sc">==</span><span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-4161"><a href="#cb28-4161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4162"><a href="#cb28-4162" aria-hidden="true" tabindex="-1"></a>data_to_plot <span class="ot">&lt;-</span> draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"trHatCond["</span>,idx,<span class="st">"]"</span>))]</span>
<span id="cb28-4163"><a href="#cb28-4163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4164"><a href="#cb28-4164" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(data_to_plot) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample])</span>
<span id="cb28-4165"><a href="#cb28-4165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4166"><a href="#cb28-4166" aria-hidden="true" tabindex="-1"></a>wpCond1 <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_to_plot)</span>
<span id="cb28-4167"><a href="#cb28-4167" aria-hidden="true" tabindex="-1"></a>wpCond1<span class="sc">$</span>Column <span class="ot">&lt;-</span> <span class="fu">unname</span>(col.labs[i])</span>
<span id="cb28-4168"><a href="#cb28-4168" aria-hidden="true" tabindex="-1"></a>wpCond<span class="ot">=</span> <span class="fu">rbind</span>(wpCond,wpCond1)</span>
<span id="cb28-4169"><a href="#cb28-4169" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4170"><a href="#cb28-4170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4171"><a href="#cb28-4171" aria-hidden="true" tabindex="-1"></a>wpCond<span class="sc">$</span>Column<span class="ot">=</span><span class="fu">as.factor</span>(wpCond<span class="sc">$</span>Column)</span>
<span id="cb28-4172"><a href="#cb28-4172" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wpCond)<span class="sc">+</span></span>
<span id="cb28-4173"><a href="#cb28-4173" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">colour=</span>variable)) <span class="sc">+</span></span>
<span id="cb28-4174"><a href="#cb28-4174" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"uncertainty chromatogram (limited data preditions)"</span>,</span>
<span id="cb28-4175"><a href="#cb28-4175" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span><span class="st">"Retention Time, min"</span>,</span>
<span id="cb28-4176"><a href="#cb28-4176" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"pdf"</span>,</span>
<span id="cb28-4177"><a href="#cb28-4177" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"Analyte"</span>)<span class="sc">+</span></span>
<span id="cb28-4178"><a href="#cb28-4178" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb28-4179"><a href="#cb28-4179" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Column, <span class="at">nrow=</span><span class="dv">3</span>,<span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb28-4180"><a href="#cb28-4180" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb28-4181"><a href="#cb28-4181" aria-hidden="true" tabindex="-1"></a>     <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb28-4182"><a href="#cb28-4182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4183"><a href="#cb28-4183" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">decision</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"Chromatogram"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4184"><a href="#cb28-4184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4185"><a href="#cb28-4185" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-4186"><a href="#cb28-4186" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4187"><a href="#cb28-4187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4188"><a href="#cb28-4188" aria-hidden="true" tabindex="-1"></a><span class="fu">## Utility maps</span></span>
<span id="cb28-4189"><a href="#cb28-4189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4190"><a href="#cb28-4190" aria-hidden="true" tabindex="-1"></a>We can also determine more detailed graph presenting relationship between the expected utility and design variables:</span>
<span id="cb28-4191"><a href="#cb28-4191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4192"><a href="#cb28-4192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-preparedata}</span></span>
<span id="cb28-4193"><a href="#cb28-4193" aria-hidden="true" tabindex="-1"></a>upH <span class="ot">&lt;-</span> datasim <span class="sc">%&gt;%</span></span>
<span id="cb28-4194"><a href="#cb28-4194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4195"><a href="#cb28-4195" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Temp,Mod, pHo, alpha1, alpha2) <span class="sc">%&gt;%</span></span>
<span id="cb28-4196"><a href="#cb28-4196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Temp,Mod) <span class="sc">%&gt;%</span></span>
<span id="cb28-4197"><a href="#cb28-4197" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">complete</span>(<span class="at">pHo =</span> <span class="fu">seq</span>(<span class="fu">min</span>(pHo), <span class="fu">max</span>(pHo), <span class="at">len =</span> <span class="dv">17</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-4198"><a href="#cb28-4198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(Temp,Mod,pHo) <span class="sc">%&gt;%</span></span>
<span id="cb28-4199"><a href="#cb28-4199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha1 =</span> zoo<span class="sc">::</span><span class="fu">na.approx</span>(alpha1,pHo)) <span class="sc">%&gt;%</span></span>
<span id="cb28-4200"><a href="#cb28-4200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha2 =</span> zoo<span class="sc">::</span><span class="fu">na.approx</span>(alpha2,pHo)) <span class="sc">%&gt;%</span></span>
<span id="cb28-4201"><a href="#cb28-4201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Temp,Mod) <span class="sc">%&gt;%</span></span>
<span id="cb28-4202"><a href="#cb28-4202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pHid =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-4203"><a href="#cb28-4203" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(pHid)  <span class="sc">%&gt;%</span></span>
<span id="cb28-4204"><a href="#cb28-4204" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pHs =</span> <span class="fu">round</span>(<span class="fu">mean</span>(pHo),<span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-4205"><a href="#cb28-4205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb28-4206"><a href="#cb28-4206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4207"><a href="#cb28-4207" aria-hidden="true" tabindex="-1"></a>datasim2 <span class="ot">&lt;-</span> datasim <span class="sc">%&gt;%</span></span>
<span id="cb28-4208"><a href="#cb28-4208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4209"><a href="#cb28-4209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(tg<span class="sc">==</span><span class="dv">30</span>, Temp<span class="sc">==</span><span class="dv">25</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4210"><a href="#cb28-4210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>tg, <span class="sc">-</span>fio, <span class="sc">-</span>expid, <span class="sc">-</span>pHs, <span class="sc">-</span>pHo, <span class="sc">-</span>alpha1, <span class="sc">-</span>alpha2, <span class="sc">-</span>pH) <span class="sc">%&gt;%</span></span>
<span id="cb28-4211"><a href="#cb28-4211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>() <span class="sc">%&gt;%</span></span>
<span id="cb28-4212"><a href="#cb28-4212" aria-hidden="true" tabindex="-1"></a> tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(<span class="at">fio =</span> <span class="fu">seq</span>(<span class="fl">0.05</span>,<span class="fl">0.2</span>,<span class="fl">0.05</span>),<span class="at">tg =</span> <span class="fu">seq</span>(<span class="dv">20</span>,<span class="dv">260</span>,<span class="dv">20</span>), <span class="at">pHs=</span><span class="fu">unique</span>(upH<span class="sc">$</span>pHs))<span class="sc">%&gt;%</span></span>
<span id="cb28-4213"><a href="#cb28-4213" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(upH, <span class="at">by =</span> <span class="fu">join_by</span>(pHs, Mod, Temp), <span class="at">relationship =</span> <span class="st">"many-to-one"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-4214"><a href="#cb28-4214" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tg, fio, Mod, Column, pHs) <span class="sc">%&gt;%</span></span>
<span id="cb28-4215"><a href="#cb28-4215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">expid =</span> <span class="fu">cur_group_id</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb28-4216"><a href="#cb28-4216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb28-4217"><a href="#cb28-4217" aria-hidden="true" tabindex="-1"></a>datastructsim2 <span class="ot">&lt;-</span>datastruct</span>
<span id="cb28-4218"><a href="#cb28-4218" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>nObs<span class="ot">=</span><span class="fu">length</span>(datasim2<span class="sc">$</span>METID)</span>
<span id="cb28-4219"><a href="#cb28-4219" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>analyte<span class="ot">=</span><span class="fu">match</span>(datasim2<span class="sc">$</span>METID, <span class="fu">unique</span>(datasim2<span class="sc">$</span>METID))</span>
<span id="cb28-4220"><a href="#cb28-4220" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>modifier<span class="ot">=</span><span class="fu">match</span>(datasim2<span class="sc">$</span>Mod2, <span class="fu">sort</span>(<span class="fu">unique</span>(datasim2<span class="sc">$</span>Mod2)))</span>
<span id="cb28-4221"><a href="#cb28-4221" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>steps<span class="ot">=</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">2</span><span class="sc">-</span>datasim2<span class="sc">$</span>Mod2) <span class="sc">+</span> <span class="dv">10</span><span class="sc">*</span>(datasim2<span class="sc">$</span>Mod2<span class="dv">-1</span>)</span>
<span id="cb28-4222"><a href="#cb28-4222" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>column<span class="ot">=</span><span class="fu">match</span>(datasim2<span class="sc">$</span>Column, <span class="fu">unique</span>(datasim2<span class="sc">$</span>Column))</span>
<span id="cb28-4223"><a href="#cb28-4223" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>hplcparam<span class="ot">=</span><span class="fu">cbind</span>(datasim2<span class="sc">$</span>tg,datasim2<span class="sc">$</span>td,datasim2<span class="sc">$</span>to,datasim2<span class="sc">$</span>te,</span>
<span id="cb28-4224"><a href="#cb28-4224" aria-hidden="true" tabindex="-1"></a>                              datasim2<span class="sc">$</span>fio,datasim2<span class="sc">$</span>fik,datasim2<span class="sc">$</span>Mod2<span class="dv">-1</span>,datasim2<span class="sc">$</span>pHo,</span>
<span id="cb28-4225"><a href="#cb28-4225" aria-hidden="true" tabindex="-1"></a>                              datasim2<span class="sc">$</span>alpha1,datasim2<span class="sc">$</span>alpha2,(datasim2<span class="sc">$</span>Temp<span class="dv">-25</span>)<span class="sc">/</span><span class="dv">10</span>,</span>
<span id="cb28-4226"><a href="#cb28-4226" aria-hidden="true" tabindex="-1"></a>                              datasim2<span class="sc">$</span>Column<span class="dv">-1</span>)</span>
<span id="cb28-4227"><a href="#cb28-4227" aria-hidden="true" tabindex="-1"></a>datastructsim2<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,datastructsim2<span class="sc">$</span>nObs)</span>
<span id="cb28-4228"><a href="#cb28-4228" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">=</span>  <span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-4229"><a href="#cb28-4229" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim2<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample)</span>
<span id="cb28-4230"><a href="#cb28-4230" aria-hidden="true" tabindex="-1"></a>datasim_red <span class="ot">=</span> datasim2[idx,]</span>
<span id="cb28-4231"><a href="#cb28-4231" aria-hidden="true" tabindex="-1"></a>datastructsim_red <span class="ot">&lt;-</span>datastructsim2</span>
<span id="cb28-4232"><a href="#cb28-4232" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nObs<span class="ot">=</span><span class="fu">length</span>(datastructsim_red<span class="sc">$</span>analyte[idx])</span>
<span id="cb28-4233"><a href="#cb28-4233" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>analyte<span class="ot">=</span>datastructsim_red<span class="sc">$</span>analyte[idx]</span>
<span id="cb28-4234"><a href="#cb28-4234" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>modifier<span class="ot">=</span>datastructsim_red<span class="sc">$</span>modifier[idx]</span>
<span id="cb28-4235"><a href="#cb28-4235" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>steps<span class="ot">=</span>datastructsim_red<span class="sc">$</span>steps[idx]</span>
<span id="cb28-4236"><a href="#cb28-4236" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>column<span class="ot">=</span>datastructsim_red<span class="sc">$</span>column[idx]</span>
<span id="cb28-4237"><a href="#cb28-4237" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>hplcparam<span class="ot">=</span>datastructsim_red<span class="sc">$</span>hplcparam[idx,]</span>
<span id="cb28-4238"><a href="#cb28-4238" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>trobs <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>,datastructsim_red<span class="sc">$</span>nObs)</span>
<span id="cb28-4239"><a href="#cb28-4239" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nexpid<span class="ot">=</span><span class="fu">length</span>(<span class="fu">unique</span>(datasim_red<span class="sc">$</span>expid))</span>
<span id="cb28-4240"><a href="#cb28-4240" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>expid<span class="ot">=</span><span class="fu">match</span>(datasim_red<span class="sc">$</span>expid, <span class="fu">unique</span>(datasim_red<span class="sc">$</span>expid))</span>
<span id="cb28-4241"><a href="#cb28-4241" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>nAnalytessim<span class="ot">=</span><span class="fu">length</span>(<span class="fu">unique</span>(datastructsim_red<span class="sc">$</span>analyte))</span>
<span id="cb28-4242"><a href="#cb28-4242" aria-hidden="true" tabindex="-1"></a>datastructsim_red<span class="sc">$</span>analytesim<span class="ot">=</span><span class="fu">match</span>(datastructsim_red<span class="sc">$</span>analyte, <span class="fu">unique</span>(datastructsim_red<span class="sc">$</span>analyte))</span>
<span id="cb28-4243"><a href="#cb28-4243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4244"><a href="#cb28-4244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4245"><a href="#cb28-4245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4246"><a href="#cb28-4246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-qq, eval = FALSE}</span></span>
<span id="cb28-4247"><a href="#cb28-4247" aria-hidden="true" tabindex="-1"></a>model_sim_red <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="st">"stan/hplc-gra-fivecolumns-fixed-sim.stan"</span>)</span>
<span id="cb28-4248"><a href="#cb28-4248" aria-hidden="true" tabindex="-1"></a>fit_sim_red  <span class="ot">&lt;-</span> model_sim_red<span class="sc">$</span><span class="fu">generate_quantities</span>(fit_red,</span>
<span id="cb28-4249"><a href="#cb28-4249" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">data =</span> datastructsim_red,</span>
<span id="cb28-4250"><a href="#cb28-4250" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb28-4251"><a href="#cb28-4251" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb28-4252"><a href="#cb28-4252" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">output_dir =</span> <span class="st">"stanfiles"</span>)</span>
<span id="cb28-4253"><a href="#cb28-4253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4254"><a href="#cb28-4254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4255"><a href="#cb28-4255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4256"><a href="#cb28-4256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-loaddata}</span></span>
<span id="cb28-4257"><a href="#cb28-4257" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span> cmdstanr<span class="sc">::</span><span class="fu">read_cmdstan_csv</span>(<span class="fu">c</span>(</span>
<span id="cb28-4258"><a href="#cb28-4258" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">'stanfiles/hplc-gra-fivecolumns-fixed-sim-202308241235-1-3ef502.csv'</span></span>
<span id="cb28-4259"><a href="#cb28-4259" aria-hidden="true" tabindex="-1"></a>                                ))</span>
<span id="cb28-4260"><a href="#cb28-4260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4261"><a href="#cb28-4261" aria-hidden="true" tabindex="-1"></a>draws_sim_red_df <span class="ot">&lt;-</span> <span class="fu">as_draws_df</span>(x<span class="sc">$</span>generated_quantities)</span>
<span id="cb28-4262"><a href="#cb28-4262" aria-hidden="true" tabindex="-1"></a><span class="co">#draws_sim_red_df &lt;- fit_sim_red$draws(format = "df")</span></span>
<span id="cb28-4263"><a href="#cb28-4263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4264"><a href="#cb28-4264" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4265"><a href="#cb28-4265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4266"><a href="#cb28-4266" aria-hidden="true" tabindex="-1"></a>The best chromatogram can be sought based on utility map:</span>
<span id="cb28-4267"><a href="#cb28-4267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4268"><a href="#cb28-4268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-utylitymaps-danse}</span></span>
<span id="cb28-4269"><a href="#cb28-4269" aria-hidden="true" tabindex="-1"></a>foo<span class="ot">&lt;-</span>datasim_red[<span class="sc">!</span><span class="fu">duplicated</span>(datasim_red<span class="sc">$</span>expid),]</span>
<span id="cb28-4270"><a href="#cb28-4270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4271"><a href="#cb28-4271" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^mindifftr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-4272"><a href="#cb28-4272" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^maxtr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-4273"><a href="#cb28-4273" aria-hidden="true" tabindex="-1"></a>z<span class="ot">&lt;-</span>draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">grep</span>(<span class="st">"^mintr"</span>, <span class="fu">names</span>(draws_sim_red_df), <span class="at">value =</span> <span class="cn">TRUE</span>))]</span>
<span id="cb28-4274"><a href="#cb28-4274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4275"><a href="#cb28-4275" aria-hidden="true" tabindex="-1"></a>u<span class="ot">=</span>x;</span>
<span id="cb28-4276"><a href="#cb28-4276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4277"><a href="#cb28-4277" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(x)){u[,i] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x[,i]<span class="sc">&gt;</span><span class="dv">2</span> <span class="sc">&amp;</span> z[,i] <span class="sc">&gt;</span> <span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">40</span><span class="sc">-</span>y[,i]) <span class="sc">*</span> <span class="fu">as.numeric</span>(y[,i]<span class="sc">&lt;</span><span class="dv">40</span>)}</span>
<span id="cb28-4278"><a href="#cb28-4278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4279"><a href="#cb28-4279" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">apply</span>(u, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> mean)</span>
<span id="cb28-4280"><a href="#cb28-4280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4281"><a href="#cb28-4281" aria-hidden="true" tabindex="-1"></a>pr<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(pr)</span>
<span id="cb28-4282"><a href="#cb28-4282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4283"><a href="#cb28-4283" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>EUtility<span class="ot">=</span>pr<span class="sc">$</span>pr</span>
<span id="cb28-4284"><a href="#cb28-4284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4285"><a href="#cb28-4285" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">apply</span>(x, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-4286"><a href="#cb28-4286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4287"><a href="#cb28-4287" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(x))</span>
<span id="cb28-4288"><a href="#cb28-4288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4289"><a href="#cb28-4289" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_l<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-4290"><a href="#cb28-4290" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_m<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-4291"><a href="#cb28-4291" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>mindifftr_h<span class="ot">=</span>x<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-4292"><a href="#cb28-4292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4293"><a href="#cb28-4293" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">apply</span>(y, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span>))</span>
<span id="cb28-4294"><a href="#cb28-4294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4295"><a href="#cb28-4295" aria-hidden="true" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(<span class="fu">t</span>(y))</span>
<span id="cb28-4296"><a href="#cb28-4296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4297"><a href="#cb28-4297" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_l<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">5%</span><span class="st">`</span></span>
<span id="cb28-4298"><a href="#cb28-4298" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_m<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">50%</span><span class="st">`</span></span>
<span id="cb28-4299"><a href="#cb28-4299" aria-hidden="true" tabindex="-1"></a>foo<span class="sc">$</span>maxtr_h<span class="ot">=</span>y<span class="sc">$</span><span class="st">`</span><span class="at">95%</span><span class="st">`</span></span>
<span id="cb28-4300"><a href="#cb28-4300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4301"><a href="#cb28-4301" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4302"><a href="#cb28-4302" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">1</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-4303"><a href="#cb28-4303" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4304"><a href="#cb28-4304" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-4305"><a href="#cb28-4305" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-4306"><a href="#cb28-4306" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-4307"><a href="#cb28-4307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4308"><a href="#cb28-4308" aria-hidden="true" tabindex="-1"></a>p12 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4309"><a href="#cb28-4309" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">2</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-4310"><a href="#cb28-4310" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4311"><a href="#cb28-4311" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-4312"><a href="#cb28-4312" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-4313"><a href="#cb28-4313" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-4314"><a href="#cb28-4314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4315"><a href="#cb28-4315" aria-hidden="true" tabindex="-1"></a>p13 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4316"><a href="#cb28-4316" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">3</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-4317"><a href="#cb28-4317" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4318"><a href="#cb28-4318" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-4319"><a href="#cb28-4319" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-4320"><a href="#cb28-4320" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-4321"><a href="#cb28-4321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4322"><a href="#cb28-4322" aria-hidden="true" tabindex="-1"></a>p14 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4323"><a href="#cb28-4323" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">4</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-4324"><a href="#cb28-4324" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4325"><a href="#cb28-4325" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-4326"><a href="#cb28-4326" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-4327"><a href="#cb28-4327" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-4328"><a href="#cb28-4328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4329"><a href="#cb28-4329" aria-hidden="true" tabindex="-1"></a>p15 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb28-4330"><a href="#cb28-4330" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_contour_filled</span>(<span class="at">data=</span><span class="fu">subset</span>(foo,Column<span class="sc">==</span><span class="dv">5</span>), <span class="fu">aes</span>(<span class="at">x =</span> pHs, <span class="at">y=</span>tg, <span class="at">z =</span> EUtility))<span class="sc">+</span></span>
<span id="cb28-4331"><a href="#cb28-4331" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_grid</span>(fio<span class="sc">~</span>Mod2<span class="sc">+</span>ColumnName, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Mod2=</span>mod.labs))<span class="sc">+</span></span>
<span id="cb28-4332"><a href="#cb28-4332" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">x =</span><span class="st">"pH"</span>,</span>
<span id="cb28-4333"><a href="#cb28-4333" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"tg, min"</span>,</span>
<span id="cb28-4334"><a href="#cb28-4334" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"Expected Utility"</span>)</span>
<span id="cb28-4335"><a href="#cb28-4335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4336"><a href="#cb28-4336" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap1"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p11, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4337"><a href="#cb28-4337" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap2"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p12, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4338"><a href="#cb28-4338" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap3"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p13, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4339"><a href="#cb28-4339" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap4"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p14, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4340"><a href="#cb28-4340" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"utilitymap5"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p15, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4341"><a href="#cb28-4341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4342"><a href="#cb28-4342" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p11)</span>
<span id="cb28-4343"><a href="#cb28-4343" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p12)</span>
<span id="cb28-4344"><a href="#cb28-4344" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p13)</span>
<span id="cb28-4345"><a href="#cb28-4345" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p14)</span>
<span id="cb28-4346"><a href="#cb28-4346" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p15)</span>
<span id="cb28-4347"><a href="#cb28-4347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4348"><a href="#cb28-4348" aria-hidden="true" tabindex="-1"></a> <span class="co"># The best for XBridge Shield RP18</span></span>
<span id="cb28-4349"><a href="#cb28-4349" aria-hidden="true" tabindex="-1"></a> foo1<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">1</span>,];</span>
<span id="cb28-4350"><a href="#cb28-4350" aria-hidden="true" tabindex="-1"></a> foo1[<span class="fu">which</span>(foo1<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo1<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4351"><a href="#cb28-4351" aria-hidden="true" tabindex="-1"></a> <span class="co"># The best choice for XTerra MS C18</span></span>
<span id="cb28-4352"><a href="#cb28-4352" aria-hidden="true" tabindex="-1"></a> foo2<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">2</span>,];</span>
<span id="cb28-4353"><a href="#cb28-4353" aria-hidden="true" tabindex="-1"></a> foo2[<span class="fu">which</span>(foo2<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo2<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4354"><a href="#cb28-4354" aria-hidden="true" tabindex="-1"></a> <span class="co"># The best choice for XBridge Phenyl</span></span>
<span id="cb28-4355"><a href="#cb28-4355" aria-hidden="true" tabindex="-1"></a> foo3<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">3</span>,];</span>
<span id="cb28-4356"><a href="#cb28-4356" aria-hidden="true" tabindex="-1"></a> foo3[<span class="fu">which</span>(foo3<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo3<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4357"><a href="#cb28-4357" aria-hidden="true" tabindex="-1"></a> <span class="co"># The best choice for XBridge C8</span></span>
<span id="cb28-4358"><a href="#cb28-4358" aria-hidden="true" tabindex="-1"></a> foo4<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">4</span>,];</span>
<span id="cb28-4359"><a href="#cb28-4359" aria-hidden="true" tabindex="-1"></a> foo4[<span class="fu">which</span>(foo4<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo4<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4360"><a href="#cb28-4360" aria-hidden="true" tabindex="-1"></a> <span class="co"># The best choice for Xterra MS C8</span></span>
<span id="cb28-4361"><a href="#cb28-4361" aria-hidden="true" tabindex="-1"></a> foo5<span class="ot">&lt;-</span>foo[foo<span class="sc">$</span>Column<span class="sc">==</span><span class="dv">5</span>,];</span>
<span id="cb28-4362"><a href="#cb28-4362" aria-hidden="true" tabindex="-1"></a> foo5[<span class="fu">which</span>(foo5<span class="sc">$</span>EUtility<span class="sc">==</span><span class="fu">max</span>(foo5<span class="sc">$</span>EUtility)),<span class="fu">c</span>(<span class="st">'tg'</span>,<span class="st">'fio'</span>, <span class="st">'fik'</span>,<span class="st">'Mod'</span>, <span class="st">'pHid'</span>,<span class="st">'pHo'</span>,<span class="st">'Temp'</span>,<span class="st">'ColumnName'</span>,<span class="st">'EUtility'</span>)]</span>
<span id="cb28-4363"><a href="#cb28-4363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4364"><a href="#cb28-4364" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4365"><a href="#cb28-4365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4366"><a href="#cb28-4366" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uncertainity chromatogram</span></span>
<span id="cb28-4367"><a href="#cb28-4367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4368"><a href="#cb28-4368" aria-hidden="true" tabindex="-1"></a>Let's visualize chromatograms with the highest expected utility given the experimental data.</span>
<span id="cb28-4369"><a href="#cb28-4369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4370"><a href="#cb28-4370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r casestudy2-chromatogram-dense}</span></span>
<span id="cb28-4371"><a href="#cb28-4371" aria-hidden="true" tabindex="-1"></a>analyte_ID_sample <span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">17</span>,<span class="dv">33</span>,<span class="dv">58</span>,<span class="dv">140</span>,<span class="dv">180</span>)</span>
<span id="cb28-4372"><a href="#cb28-4372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4373"><a href="#cb28-4373" aria-hidden="true" tabindex="-1"></a>col.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"XBridge Shield RP18"</span>,<span class="st">"XTerra MS C18"</span>, <span class="st">"XBridge Phenyl"</span>, <span class="st">"XBridge C8"</span>, <span class="st">"Xterra MS C8"</span>)</span>
<span id="cb28-4374"><a href="#cb28-4374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4375"><a href="#cb28-4375" aria-hidden="true" tabindex="-1"></a>datasim_red<span class="sc">$</span>fio <span class="ot">=</span> <span class="fu">as.factor</span>(datasim_red<span class="sc">$</span>fio)</span>
<span id="cb28-4376"><a href="#cb28-4376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4377"><a href="#cb28-4377" aria-hidden="true" tabindex="-1"></a>wpCond<span class="ot">=</span> <span class="fu">data.frame</span>()</span>
<span id="cb28-4378"><a href="#cb28-4378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4379"><a href="#cb28-4379" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb28-4380"><a href="#cb28-4380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4381"><a href="#cb28-4381" aria-hidden="true" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-4382"><a href="#cb28-4382" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">60</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-4383"><a href="#cb28-4383" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">10</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-4384"><a href="#cb28-4384" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.05</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-4385"><a href="#cb28-4385" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-4386"><a href="#cb28-4386" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-4387"><a href="#cb28-4387" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-4388"><a href="#cb28-4388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4389"><a href="#cb28-4389" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">2</span>){</span>
<span id="cb28-4390"><a href="#cb28-4390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4391"><a href="#cb28-4391" aria-hidden="true" tabindex="-1"></a> idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-4392"><a href="#cb28-4392" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">80</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-4393"><a href="#cb28-4393" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-4394"><a href="#cb28-4394" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.1</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-4395"><a href="#cb28-4395" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-4396"><a href="#cb28-4396" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-4397"><a href="#cb28-4397" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-4398"><a href="#cb28-4398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4399"><a href="#cb28-4399" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4400"><a href="#cb28-4400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4401"><a href="#cb28-4401" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">3</span>){</span>
<span id="cb28-4402"><a href="#cb28-4402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4403"><a href="#cb28-4403" aria-hidden="true" tabindex="-1"></a> idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-4404"><a href="#cb28-4404" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">120</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-4405"><a href="#cb28-4405" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-4406"><a href="#cb28-4406" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.1</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-4407"><a href="#cb28-4407" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-4408"><a href="#cb28-4408" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-4409"><a href="#cb28-4409" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-4410"><a href="#cb28-4410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4411"><a href="#cb28-4411" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4412"><a href="#cb28-4412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4413"><a href="#cb28-4413" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">4</span>){</span>
<span id="cb28-4414"><a href="#cb28-4414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4415"><a href="#cb28-4415" aria-hidden="true" tabindex="-1"></a> idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-4416"><a href="#cb28-4416" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">100</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-4417"><a href="#cb28-4417" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">5</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-4418"><a href="#cb28-4418" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.05</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-4419"><a href="#cb28-4419" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-4420"><a href="#cb28-4420" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-4421"><a href="#cb28-4421" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-4422"><a href="#cb28-4422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4423"><a href="#cb28-4423" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4424"><a href="#cb28-4424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4425"><a href="#cb28-4425" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (i<span class="sc">==</span><span class="dv">5</span>){</span>
<span id="cb28-4426"><a href="#cb28-4426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4427"><a href="#cb28-4427" aria-hidden="true" tabindex="-1"></a> idx <span class="ot">&lt;-</span> <span class="fu">which</span>(datasim_red<span class="sc">$</span>METID <span class="sc">%in%</span> analyte_ID_sample <span class="sc">&amp;</span></span>
<span id="cb28-4428"><a href="#cb28-4428" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>tg <span class="sc">==</span> <span class="dv">100</span> <span class="sc">&amp;</span> <span class="co"># c(30, 90, 270)</span></span>
<span id="cb28-4429"><a href="#cb28-4429" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>pHid <span class="sc">==</span> <span class="dv">6</span> <span class="sc">&amp;</span>   <span class="co"># c(1:9)</span></span>
<span id="cb28-4430"><a href="#cb28-4430" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>fio <span class="sc">==</span> <span class="fl">0.1</span> <span class="sc">&amp;</span>   <span class="co"># ...</span></span>
<span id="cb28-4431"><a href="#cb28-4431" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Column <span class="sc">==</span> i <span class="sc">&amp;</span>  <span class="co"># c(1, 2)</span></span>
<span id="cb28-4432"><a href="#cb28-4432" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Mod2 <span class="sc">==</span> <span class="dv">2</span> <span class="sc">&amp;</span> <span class="co"># c(1, 2)</span></span>
<span id="cb28-4433"><a href="#cb28-4433" aria-hidden="true" tabindex="-1"></a>               datasim_red<span class="sc">$</span>Temp <span class="sc">==</span> <span class="dv">25</span>) <span class="co"># c(25, 35)</span></span>
<span id="cb28-4434"><a href="#cb28-4434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4435"><a href="#cb28-4435" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4436"><a href="#cb28-4436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4437"><a href="#cb28-4437" aria-hidden="true" tabindex="-1"></a> data_to_plot <span class="ot">&lt;-</span> draws_sim_red_df[,<span class="fu">which</span>(<span class="fu">colnames</span>(draws_sim_red_df) <span class="sc">%in%</span> <span class="fu">paste0</span>(<span class="st">"trHatCond["</span>,idx,<span class="st">"]"</span>))]</span>
<span id="cb28-4438"><a href="#cb28-4438" aria-hidden="true" tabindex="-1"></a> <span class="fu">colnames</span>(data_to_plot) <span class="ot">&lt;-</span> <span class="fu">paste</span>(dataNames<span class="sc">$</span>Name[analyte_ID_sample])</span>
<span id="cb28-4439"><a href="#cb28-4439" aria-hidden="true" tabindex="-1"></a> wpCond1 <span class="ot">&lt;-</span> <span class="fu">melt</span>(data_to_plot)</span>
<span id="cb28-4440"><a href="#cb28-4440" aria-hidden="true" tabindex="-1"></a>wpCond1<span class="sc">$</span>Column <span class="ot">&lt;-</span> <span class="fu">unname</span>(col.labs[i])</span>
<span id="cb28-4441"><a href="#cb28-4441" aria-hidden="true" tabindex="-1"></a>wpCond<span class="ot">=</span> <span class="fu">rbind</span>(wpCond,wpCond1)</span>
<span id="cb28-4442"><a href="#cb28-4442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4443"><a href="#cb28-4443" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-4444"><a href="#cb28-4444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4445"><a href="#cb28-4445" aria-hidden="true" tabindex="-1"></a>wpCond<span class="sc">$</span>Column<span class="ot">=</span><span class="fu">as.factor</span>(wpCond<span class="sc">$</span>Column)</span>
<span id="cb28-4446"><a href="#cb28-4446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4447"><a href="#cb28-4447" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> wpCond)<span class="sc">+</span></span>
<span id="cb28-4448"><a href="#cb28-4448" aria-hidden="true" tabindex="-1"></a>     <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>value, <span class="at">colour=</span>variable)) <span class="sc">+</span></span>
<span id="cb28-4449"><a href="#cb28-4449" aria-hidden="true" tabindex="-1"></a>     <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"uncertainty chromatogram (individual predictions)"</span>,</span>
<span id="cb28-4450"><a href="#cb28-4450" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span><span class="st">"Retention Time, min"</span>,</span>
<span id="cb28-4451"><a href="#cb28-4451" aria-hidden="true" tabindex="-1"></a>          <span class="at">y =</span> <span class="st">"pdf"</span>,</span>
<span id="cb28-4452"><a href="#cb28-4452" aria-hidden="true" tabindex="-1"></a>          <span class="at">colour=</span><span class="st">"Analyte"</span>)<span class="sc">+</span></span>
<span id="cb28-4453"><a href="#cb28-4453" aria-hidden="true" tabindex="-1"></a>     <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>))<span class="sc">+</span></span>
<span id="cb28-4454"><a href="#cb28-4454" aria-hidden="true" tabindex="-1"></a>     <span class="fu">facet_wrap</span>(.<span class="sc">~</span>Column, <span class="at">nrow=</span><span class="dv">3</span>,<span class="at">scales =</span> <span class="st">"free"</span>)<span class="sc">+</span></span>
<span id="cb28-4455"><a href="#cb28-4455" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb28-4456"><a href="#cb28-4456" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</span>
<span id="cb28-4457"><a href="#cb28-4457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4458"><a href="#cb28-4458" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="fu">paste0</span>(<span class="st">"figures</span><span class="sc">\\</span><span class="st">casestudy2</span><span class="sc">\\</span><span class="st">utilitymap</span><span class="sc">\\</span><span class="st">"</span>,  <span class="st">"chromatogram"</span>, <span class="st">".png"</span>), <span class="at">plot=</span>p, <span class="at">width =</span> <span class="dv">20</span>, <span class="at">height =</span> <span class="dv">20</span>, <span class="at">units =</span> <span class="st">"cm"</span>)</span>
<span id="cb28-4459"><a href="#cb28-4459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4460"><a href="#cb28-4460" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p)</span>
<span id="cb28-4461"><a href="#cb28-4461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-4462"><a href="#cb28-4462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4463"><a href="#cb28-4463" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusions</span></span>
<span id="cb28-4464"><a href="#cb28-4464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4465"><a href="#cb28-4465" aria-hidden="true" tabindex="-1"></a>The large gradient retention time data and multilevel modeling allow to characterize separation of RP HPLC stationary phases.</span>
<span id="cb28-4466"><a href="#cb28-4466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4467"><a href="#cb28-4467" aria-hidden="true" tabindex="-1"></a><span class="fu"># References {.unnumbered}</span></span>
<span id="cb28-4468"><a href="#cb28-4468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4469"><a href="#cb28-4469" aria-hidden="true" tabindex="-1"></a>::: {#refs}</span>
<span id="cb28-4470"><a href="#cb28-4470" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-4471"><a href="#cb28-4471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4472"><a href="#cb28-4472" aria-hidden="true" tabindex="-1"></a><span class="fu"># Licenses {.unnumbered}</span></span>
<span id="cb28-4473"><a href="#cb28-4473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4474"><a href="#cb28-4474" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Code &amp; copy; 2023, Paweł Wiczling, licensed under BSD-3.</span>
<span id="cb28-4475"><a href="#cb28-4475" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Text &amp; copy; 2023, Paweł Wiczling, licensed under CC-BY-NC 4.0.</span>
<span id="cb28-4476"><a href="#cb28-4476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4477"><a href="#cb28-4477" aria-hidden="true" tabindex="-1"></a><span class="fu"># Original Computing Environment {.unnumbered}</span></span>
<span id="cb28-4478"><a href="#cb28-4478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4479"><a href="#cb28-4479" aria-hidden="true" tabindex="-1"></a><span class="in">```{r sessionInfo}</span></span>
<span id="cb28-4480"><a href="#cb28-4480" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span>
<span id="cb28-4481"><a href="#cb28-4481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>